%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.113065e+003; foe(n+1)=3.132958e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.605950e+003; foe(n+1)=2.599763e+003; krok(n+1)=3.348253e-004; ng(n+1)=1.964432e+003;
n=2; farx(n+1)=5.385433e+002; foe(n+1)=5.059605e+002; krok(n+1)=9.707132e-003; ng(n+1)=2.957859e+002;
n=3; farx(n+1)=5.159767e+002; foe(n+1)=5.017328e+002; krok(n+1)=7.432247e-005; ng(n+1)=6.313153e+002;
n=4; farx(n+1)=6.251608e+002; foe(n+1)=4.822395e+002; krok(n+1)=1.771666e-002; ng(n+1)=4.293676e+002;
n=5; farx(n+1)=6.209278e+002; foe(n+1)=4.817574e+002; krok(n+1)=2.734728e-004; ng(n+1)=3.203763e+002;
n=6; farx(n+1)=6.235981e+002; foe(n+1)=4.240413e+002; krok(n+1)=1.297775e-001; ng(n+1)=3.557451e+002;
n=7; farx(n+1)=6.155802e+002; foe(n+1)=4.236764e+002; krok(n+1)=1.539539e-002; ng(n+1)=4.946441e+002;
n=8; farx(n+1)=1.879152e+002; foe(n+1)=3.443131e+002; krok(n+1)=2.324046e+000; ng(n+1)=5.078643e+002;
n=9; farx(n+1)=1.250239e+002; foe(n+1)=3.357531e+002; krok(n+1)=1.511586e-001; ng(n+1)=5.851972e+002;
n=10; farx(n+1)=1.213978e+002; foe(n+1)=3.333106e+002; krok(n+1)=1.819302e-002; ng(n+1)=1.110038e+003;
n=11; farx(n+1)=1.193179e+002; foe(n+1)=3.020549e+002; krok(n+1)=6.744582e-001; ng(n+1)=1.106601e+003;
n=12; farx(n+1)=1.086715e+002; foe(n+1)=2.753143e+002; krok(n+1)=1.019720e+000; ng(n+1)=5.651398e+002;
n=13; farx(n+1)=9.124146e+001; foe(n+1)=2.545809e+002; krok(n+1)=3.903951e-001; ng(n+1)=5.313965e+002;
n=14; farx(n+1)=9.107145e+001; foe(n+1)=2.544510e+002; krok(n+1)=3.499183e-003; ng(n+1)=1.159312e+003;
n=15; farx(n+1)=8.453609e+001; foe(n+1)=2.431267e+002; krok(n+1)=4.821088e-002; ng(n+1)=7.976393e+002;
n=16; farx(n+1)=7.857096e+001; foe(n+1)=2.323946e+002; krok(n+1)=3.876686e-002; ng(n+1)=1.585165e+003;
n=17; farx(n+1)=5.641891e+001; foe(n+1)=2.118431e+002; krok(n+1)=8.713251e-002; ng(n+1)=3.974629e+003;
n=18; farx(n+1)=3.993720e+001; foe(n+1)=1.678418e+002; krok(n+1)=3.030146e-001; ng(n+1)=4.852830e+003;
n=19; farx(n+1)=3.494962e+001; foe(n+1)=1.566434e+002; krok(n+1)=5.507794e-002; ng(n+1)=5.192690e+003;
n=20; farx(n+1)=2.550993e+001; foe(n+1)=1.379197e+002; krok(n+1)=3.819012e-001; ng(n+1)=3.509584e+003;
n=21; farx(n+1)=1.902485e+001; foe(n+1)=1.045079e+002; krok(n+1)=3.202727e+000; ng(n+1)=2.315913e+003;
n=22; farx(n+1)=1.799463e+001; foe(n+1)=9.420303e+001; krok(n+1)=3.038513e-001; ng(n+1)=1.171827e+003;
n=23; farx(n+1)=1.227297e+001; foe(n+1)=8.157630e+001; krok(n+1)=6.744582e-001; ng(n+1)=9.807125e+002;
n=24; farx(n+1)=7.832612e+000; foe(n+1)=6.465087e+001; krok(n+1)=2.112649e+000; ng(n+1)=1.822241e+003;
n=25; farx(n+1)=6.521873e+000; foe(n+1)=5.987467e+001; krok(n+1)=7.310195e-001; ng(n+1)=1.018269e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=6.477462e+000; foe(n+1)=5.975151e+001; krok(n+1)=3.578487e-006; ng(n+1)=3.766808e+002;
n=27; farx(n+1)=6.618385e+000; foe(n+1)=5.962329e+001; krok(n+1)=4.334515e-005; ng(n+1)=1.282807e+002;
n=28; farx(n+1)=6.279081e+000; foe(n+1)=5.826563e+001; krok(n+1)=3.109358e-004; ng(n+1)=1.485831e+002;
n=29; farx(n+1)=6.697193e+000; foe(n+1)=5.518621e+001; krok(n+1)=2.563269e-004; ng(n+1)=2.817095e+002;
n=30; farx(n+1)=6.504068e+000; foe(n+1)=5.442367e+001; krok(n+1)=9.177573e-004; ng(n+1)=4.586532e+002;
n=31; farx(n+1)=6.333244e+000; foe(n+1)=5.350540e+001; krok(n+1)=1.116161e-003; ng(n+1)=4.564729e+002;
n=32; farx(n+1)=6.647569e+000; foe(n+1)=5.221984e+001; krok(n+1)=2.284436e-002; ng(n+1)=8.067219e+002;
n=33; farx(n+1)=7.222413e+000; foe(n+1)=5.023750e+001; krok(n+1)=1.905690e+000; ng(n+1)=4.690131e+002;
n=34; farx(n+1)=6.738733e+000; foe(n+1)=4.946893e+001; krok(n+1)=1.247840e+000; ng(n+1)=4.465021e+002;
n=35; farx(n+1)=6.392407e+000; foe(n+1)=4.917562e+001; krok(n+1)=7.926233e-001; ng(n+1)=2.835928e+002;
n=36; farx(n+1)=6.325988e+000; foe(n+1)=4.874238e+001; krok(n+1)=2.238597e+000; ng(n+1)=2.754348e+002;
n=37; farx(n+1)=6.461929e+000; foe(n+1)=4.858614e+001; krok(n+1)=9.490531e-001; ng(n+1)=2.357245e+002;
n=38; farx(n+1)=6.547997e+000; foe(n+1)=4.847788e+001; krok(n+1)=4.836593e-001; ng(n+1)=2.085425e+002;
n=39; farx(n+1)=6.366672e+000; foe(n+1)=4.836888e+001; krok(n+1)=1.078611e+000; ng(n+1)=2.065142e+002;
n=40; farx(n+1)=5.718843e+000; foe(n+1)=4.811764e+001; krok(n+1)=2.579791e+000; ng(n+1)=1.795892e+002;
n=41; farx(n+1)=5.856415e+000; foe(n+1)=4.794005e+001; krok(n+1)=1.048747e+000; ng(n+1)=2.721922e+002;
n=42; farx(n+1)=5.918352e+000; foe(n+1)=4.785334e+001; krok(n+1)=4.446475e-001; ng(n+1)=1.389865e+002;
n=43; farx(n+1)=5.368713e+000; foe(n+1)=4.774133e+001; krok(n+1)=9.205262e-001; ng(n+1)=1.940388e+002;
n=44; farx(n+1)=4.813505e+000; foe(n+1)=4.762155e+001; krok(n+1)=1.192577e+000; ng(n+1)=1.623725e+002;
n=45; farx(n+1)=4.871055e+000; foe(n+1)=4.758424e+001; krok(n+1)=1.180464e+000; ng(n+1)=2.405118e+002;
n=46; farx(n+1)=4.981045e+000; foe(n+1)=4.755173e+001; krok(n+1)=7.926233e-001; ng(n+1)=5.832629e+001;
n=47; farx(n+1)=4.897573e+000; foe(n+1)=4.753632e+001; krok(n+1)=9.282331e-001; ng(n+1)=1.479734e+002;
n=48; farx(n+1)=4.906470e+000; foe(n+1)=4.753588e+001; krok(n+1)=4.641165e-001; ng(n+1)=1.621629e+001;
n=49; farx(n+1)=4.915011e+000; foe(n+1)=4.753578e+001; krok(n+1)=5.642809e-001; ng(n+1)=1.088517e+001;
n=50; farx(n+1)=4.914321e+000; foe(n+1)=4.753578e+001; krok(n+1)=2.276182e+000; ng(n+1)=1.982690e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.914296e+000; foe(n+1)=4.753578e+001; krok(n+1)=1.203595e-006; ng(n+1)=7.447200e-001;
n=52; farx(n+1)=4.914269e+000; foe(n+1)=4.753578e+001; krok(n+1)=5.403553e-006; ng(n+1)=3.870758e-001;
n=53; farx(n+1)=4.914160e+000; foe(n+1)=4.753578e+001; krok(n+1)=2.441962e-005; ng(n+1)=1.653255e-001;
n=54; farx(n+1)=4.913017e+000; foe(n+1)=4.753577e+001; krok(n+1)=4.939569e-003; ng(n+1)=6.711004e-002;
n=55; farx(n+1)=4.912463e+000; foe(n+1)=4.753577e+001; krok(n+1)=3.870416e-003; ng(n+1)=7.432641e-002;
n=56; farx(n+1)=4.928255e+000; foe(n+1)=4.753574e+001; krok(n+1)=1.083782e-001; ng(n+1)=3.695683e-002;
n=57; farx(n+1)=4.935595e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.688951e-002; ng(n+1)=2.028592e-001;
n=58; farx(n+1)=4.935560e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.942122e-001; ng(n+1)=6.896535e-001;
n=59; farx(n+1)=4.935688e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.007999e+000; ng(n+1)=8.486835e-003;
n=60; farx(n+1)=4.935688e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.162884e-007; ng(n+1)=1.446217e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
