%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.106822e+003; foe(n+1)=3.070214e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.632382e+003; foe(n+1)=2.608755e+003; krok(n+1)=3.403614e-004; ng(n+1)=1.520478e+003;
n=2; farx(n+1)=6.942469e+002; foe(n+1)=6.839514e+002; krok(n+1)=4.388300e-002; ng(n+1)=1.910408e+002;
n=3; farx(n+1)=6.873092e+002; foe(n+1)=6.732026e+002; krok(n+1)=2.881152e-004; ng(n+1)=6.880628e+002;
n=4; farx(n+1)=7.115595e+002; foe(n+1)=6.167176e+002; krok(n+1)=1.165911e-002; ng(n+1)=5.828715e+002;
n=5; farx(n+1)=7.827524e+002; foe(n+1)=5.642341e+002; krok(n+1)=2.442288e-001; ng(n+1)=6.746437e+002;
n=6; farx(n+1)=8.420398e+002; foe(n+1)=5.484300e+002; krok(n+1)=1.875076e-002; ng(n+1)=5.894759e+002;
n=7; farx(n+1)=5.985134e+002; foe(n+1)=4.402871e+002; krok(n+1)=8.892157e-002; ng(n+1)=5.374658e+002;
n=8; farx(n+1)=6.582607e+002; foe(n+1)=4.212931e+002; krok(n+1)=1.174409e+000; ng(n+1)=1.707543e+002;
n=9; farx(n+1)=6.843996e+002; foe(n+1)=4.169568e+002; krok(n+1)=1.371445e+000; ng(n+1)=3.778012e+001;
n=10; farx(n+1)=6.828592e+002; foe(n+1)=4.160209e+002; krok(n+1)=2.524119e+000; ng(n+1)=2.750194e+001;
n=11; farx(n+1)=7.071471e+002; foe(n+1)=4.142737e+002; krok(n+1)=1.961613e+000; ng(n+1)=1.618472e+001;
n=12; farx(n+1)=6.415657e+002; foe(n+1)=4.076839e+002; krok(n+1)=1.625559e+000; ng(n+1)=3.359793e+001;
n=13; farx(n+1)=2.477240e+002; foe(n+1)=3.854495e+002; krok(n+1)=2.798225e-001; ng(n+1)=8.146720e+001;
n=14; farx(n+1)=2.366354e+002; foe(n+1)=3.853429e+002; krok(n+1)=1.784716e-004; ng(n+1)=9.985146e+002;
n=15; farx(n+1)=2.317076e+002; foe(n+1)=3.843381e+002; krok(n+1)=1.016482e-001; ng(n+1)=1.065936e+003;
n=16; farx(n+1)=1.357358e+002; foe(n+1)=3.683668e+002; krok(n+1)=3.874329e-001; ng(n+1)=1.022762e+003;
n=17; farx(n+1)=8.672622e+001; foe(n+1)=3.448868e+002; krok(n+1)=7.549232e-002; ng(n+1)=1.501771e+003;
n=18; farx(n+1)=8.338213e+001; foe(n+1)=3.386578e+002; krok(n+1)=2.606552e-002; ng(n+1)=3.028381e+003;
n=19; farx(n+1)=7.426006e+001; foe(n+1)=2.967037e+002; krok(n+1)=3.731753e-001; ng(n+1)=4.094977e+003;
n=20; farx(n+1)=4.442008e+001; foe(n+1)=2.518197e+002; krok(n+1)=2.295125e-001; ng(n+1)=2.529882e+003;
n=21; farx(n+1)=3.209677e+001; foe(n+1)=1.423244e+002; krok(n+1)=4.324046e-001; ng(n+1)=6.526234e+003;
n=22; farx(n+1)=2.804799e+001; foe(n+1)=1.242484e+002; krok(n+1)=1.420334e+000; ng(n+1)=1.664737e+003;
n=23; farx(n+1)=1.982300e+001; foe(n+1)=1.036831e+002; krok(n+1)=1.022846e+000; ng(n+1)=6.034414e+002;
n=24; farx(n+1)=1.529825e+001; foe(n+1)=9.175294e+001; krok(n+1)=6.674447e-001; ng(n+1)=2.239216e+003;
n=25; farx(n+1)=1.452774e+001; foe(n+1)=7.849701e+001; krok(n+1)=2.608586e-001; ng(n+1)=6.190471e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.326199e+001; foe(n+1)=7.731379e+001; krok(n+1)=6.375927e-005; ng(n+1)=3.371966e+002;
n=27; farx(n+1)=1.322192e+001; foe(n+1)=7.686723e+001; krok(n+1)=1.314101e-005; ng(n+1)=4.134115e+002;
n=28; farx(n+1)=1.159443e+001; foe(n+1)=7.364883e+001; krok(n+1)=9.677161e-005; ng(n+1)=3.365917e+002;
n=29; farx(n+1)=9.279891e+000; foe(n+1)=6.698394e+001; krok(n+1)=6.326141e-004; ng(n+1)=2.894929e+002;
n=30; farx(n+1)=9.537077e+000; foe(n+1)=6.471275e+001; krok(n+1)=2.176076e-003; ng(n+1)=1.025132e+003;
n=31; farx(n+1)=9.502470e+000; foe(n+1)=6.463998e+001; krok(n+1)=2.373838e-003; ng(n+1)=2.161093e+003;
n=32; farx(n+1)=8.271615e+000; foe(n+1)=6.149698e+001; krok(n+1)=3.635836e-001; ng(n+1)=2.109683e+003;
n=33; farx(n+1)=8.964056e+000; foe(n+1)=5.872703e+001; krok(n+1)=9.595947e-002; ng(n+1)=1.693042e+003;
n=34; farx(n+1)=7.791961e+000; foe(n+1)=5.388735e+001; krok(n+1)=1.217699e+000; ng(n+1)=7.402803e+002;
n=35; farx(n+1)=7.096466e+000; foe(n+1)=5.112128e+001; krok(n+1)=6.367965e-001; ng(n+1)=3.582366e+002;
n=36; farx(n+1)=6.579882e+000; foe(n+1)=5.039021e+001; krok(n+1)=4.714530e-001; ng(n+1)=9.732350e+002;
n=37; farx(n+1)=6.420465e+000; foe(n+1)=4.871329e+001; krok(n+1)=2.984733e+000; ng(n+1)=4.657014e+002;
n=38; farx(n+1)=6.416192e+000; foe(n+1)=4.842487e+001; krok(n+1)=2.990259e-001; ng(n+1)=2.876203e+002;
n=39; farx(n+1)=6.338818e+000; foe(n+1)=4.820160e+001; krok(n+1)=3.635836e-001; ng(n+1)=3.164716e+002;
n=40; farx(n+1)=6.186199e+000; foe(n+1)=4.811289e+001; krok(n+1)=9.282331e-001; ng(n+1)=1.399538e+002;
n=41; farx(n+1)=5.679721e+000; foe(n+1)=4.789620e+001; krok(n+1)=2.006399e+000; ng(n+1)=1.984253e+002;
n=42; farx(n+1)=6.072939e+000; foe(n+1)=4.778375e+001; krok(n+1)=8.006816e-001; ng(n+1)=5.635195e+001;
n=43; farx(n+1)=5.739427e+000; foe(n+1)=4.770305e+001; krok(n+1)=1.731795e+000; ng(n+1)=8.198316e+001;
n=44; farx(n+1)=5.555141e+000; foe(n+1)=4.766153e+001; krok(n+1)=7.491049e-001; ng(n+1)=1.815849e+002;
n=45; farx(n+1)=5.188827e+000; foe(n+1)=4.757164e+001; krok(n+1)=5.131430e-001; ng(n+1)=1.475956e+002;
n=46; farx(n+1)=5.050718e+000; foe(n+1)=4.754652e+001; krok(n+1)=9.607629e-001; ng(n+1)=8.120372e+001;
n=47; farx(n+1)=5.037769e+000; foe(n+1)=4.753934e+001; krok(n+1)=3.337224e-001; ng(n+1)=6.981863e+001;
n=48; farx(n+1)=4.940224e+000; foe(n+1)=4.753732e+001; krok(n+1)=1.096368e+000; ng(n+1)=3.470576e+001;
n=49; farx(n+1)=4.936135e+000; foe(n+1)=4.753682e+001; krok(n+1)=7.101669e-001; ng(n+1)=1.273026e+001;
n=50; farx(n+1)=4.958813e+000; foe(n+1)=4.753628e+001; krok(n+1)=1.569476e+000; ng(n+1)=2.813904e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.958342e+000; foe(n+1)=4.753625e+001; krok(n+1)=5.898207e-006; ng(n+1)=3.648962e+000;
n=52; farx(n+1)=4.956292e+000; foe(n+1)=4.753619e+001; krok(n+1)=3.779992e-006; ng(n+1)=7.964738e+000;
n=53; farx(n+1)=4.955772e+000; foe(n+1)=4.753618e+001; krok(n+1)=6.971762e-006; ng(n+1)=3.227087e+000;
n=54; farx(n+1)=4.959740e+000; foe(n+1)=4.753591e+001; krok(n+1)=1.274309e-003; ng(n+1)=9.500577e-001;
n=55; farx(n+1)=4.954239e+000; foe(n+1)=4.753574e+001; krok(n+1)=1.589439e-002; ng(n+1)=2.558147e-001;
n=56; farx(n+1)=4.949475e+000; foe(n+1)=4.753574e+001; krok(n+1)=1.381076e-002; ng(n+1)=9.610349e-002;
n=57; farx(n+1)=4.935829e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.928073e-001; ng(n+1)=8.370976e-002;
n=58; farx(n+1)=4.935749e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.006837e+000; ng(n+1)=5.384682e-001;
n=59; farx(n+1)=4.935749e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.046074e-005; ng(n+1)=1.548394e-003;
n=60; farx(n+1)=4.935749e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.182150e-006; ng(n+1)=1.548382e-003;
n=61; farx(n+1)=4.935749e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.399456e-011; ng(n+1)=1.548376e-003;
n=62; farx(n+1)=4.935749e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.435782e-007; ng(n+1)=1.548376e-003;
 % z造 kierunek w metodzie zm - odnowa 
n=63; farx(n+1)=4.935748e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.514078e-006; ng(n+1)=1.548392e-003;
n=64; farx(n+1)=4.935748e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.300043e-006; ng(n+1)=1.266941e-003;
n=65; farx(n+1)=4.935748e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.446963e-005; ng(n+1)=4.197754e-004;
n=66; farx(n+1)=4.935750e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.899499e-004; ng(n+1)=5.752743e-004;
n=67; farx(n+1)=4.935750e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.286793e-005; ng(n+1)=1.863687e-004;
n=68; farx(n+1)=4.935750e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.430061e-005; ng(n+1)=1.862635e-004;
n=69; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.004768e-002; ng(n+1)=1.862667e-004;
n=70; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.426241e-011; ng(n+1)=2.387161e-004;
n=71; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.452764e-006; ng(n+1)=2.387161e-004;
n=72; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.383480e-005; ng(n+1)=2.386853e-004;
n=73; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.119747e-005; ng(n+1)=2.387303e-004;
n=74; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.117215e-007; ng(n+1)=2.387212e-004;
n=75; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.364064e-006; ng(n+1)=2.387211e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.047303e-008; ng(n+1)=2.387205e-004;
n=77; farx(n+1)=4.935715e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.717642e-005; ng(n+1)=2.386065e-004;
n=78; farx(n+1)=4.935712e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.032861e-005; ng(n+1)=1.155144e-003;
n=79; farx(n+1)=4.935707e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.379833e-005; ng(n+1)=1.895305e-003;
n=80; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.957629e-003; ng(n+1)=7.204282e-004;
n=81; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.537675e-007; ng(n+1)=6.295144e-004;
n=82; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.878283e-007; ng(n+1)=6.295143e-004;
n=83; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.160917e-008; ng(n+1)=6.295137e-004;
n=84; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.429802e-009; ng(n+1)=6.295137e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=85; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.251536e-007; ng(n+1)=6.295137e-004;
n=86; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.211251e-006; ng(n+1)=4.902879e-004;
n=87; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.150304e-006; ng(n+1)=5.247027e-004;
n=88; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.982719e-009; ng(n+1)=5.228642e-004;
n=89; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.711903e-004; ng(n+1)=5.228642e-004;
n=90; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.358899e-008; ng(n+1)=5.227148e-004;
n=91; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.936978e-006; ng(n+1)=5.227147e-004;
n=92; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.035310e-010; ng(n+1)=5.227121e-004;
n=93; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.246973e-011; ng(n+1)=5.227121e-004;
n=94; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.939783e-011; ng(n+1)=5.227120e-004;
n=95; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.745680e-009; ng(n+1)=5.227121e-004;
n=96; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.035788e-010; ng(n+1)=5.227119e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=97; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.174083e-012; ng(n+1)=5.227119e-004;
n=98; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.089263e-011; ng(n+1)=5.227108e-004;
n=99; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.846706e-011; ng(n+1)=5.227108e-004;
n=100; farx(n+1)=4.935700e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.048886e-011; ng(n+1)=5.227105e-004;
%odnowa zmiennej metryki
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
