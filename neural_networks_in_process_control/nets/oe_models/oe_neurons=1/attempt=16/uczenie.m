%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.043756e+003; foe(n+1)=3.075070e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.590728e+003; foe(n+1)=2.609720e+003; krok(n+1)=3.395966e-004; ng(n+1)=1.641859e+003;
n=2; farx(n+1)=2.177373e+003; foe(n+1)=2.177222e+003; krok(n+1)=2.610641e-002; ng(n+1)=2.802607e+002;
n=3; farx(n+1)=1.253220e+003; foe(n+1)=1.250635e+003; krok(n+1)=2.361618e-004; ng(n+1)=2.511815e+003;
n=4; farx(n+1)=8.332914e+002; foe(n+1)=7.346659e+002; krok(n+1)=5.946552e-002; ng(n+1)=1.687909e+003;
n=5; farx(n+1)=6.191382e+002; foe(n+1)=6.636128e+002; krok(n+1)=8.153064e-002; ng(n+1)=7.936794e+002;
n=6; farx(n+1)=5.698977e+002; foe(n+1)=6.412894e+002; krok(n+1)=6.413507e-002; ng(n+1)=7.941960e+002;
n=7; farx(n+1)=5.702594e+002; foe(n+1)=6.370023e+002; krok(n+1)=7.445763e-002; ng(n+1)=9.112048e+002;
n=8; farx(n+1)=5.738236e+002; foe(n+1)=6.181551e+002; krok(n+1)=1.965206e+000; ng(n+1)=2.230152e+002;
n=9; farx(n+1)=5.740623e+002; foe(n+1)=6.179547e+002; krok(n+1)=2.667694e-002; ng(n+1)=1.875779e+002;
n=10; farx(n+1)=5.661914e+002; foe(n+1)=6.115055e+002; krok(n+1)=7.518293e-001; ng(n+1)=1.902495e+002;
n=11; farx(n+1)=5.661549e+002; foe(n+1)=6.114812e+002; krok(n+1)=4.260904e-003; ng(n+1)=2.064543e+002;
n=12; farx(n+1)=5.623831e+002; foe(n+1)=6.101714e+002; krok(n+1)=4.096582e-001; ng(n+1)=7.447109e+001;
n=13; farx(n+1)=5.618729e+002; foe(n+1)=6.100756e+002; krok(n+1)=3.465039e-001; ng(n+1)=1.630368e+002;
n=14; farx(n+1)=5.609429e+002; foe(n+1)=6.097882e+002; krok(n+1)=2.090614e+000; ng(n+1)=4.246920e+001;
n=15; farx(n+1)=5.609085e+002; foe(n+1)=6.097651e+002; krok(n+1)=1.778431e-001; ng(n+1)=4.355477e+001;
n=16; farx(n+1)=5.614282e+002; foe(n+1)=6.095145e+002; krok(n+1)=2.984621e+000; ng(n+1)=2.087971e+001;
n=17; farx(n+1)=5.613308e+002; foe(n+1)=6.093744e+002; krok(n+1)=3.886554e-001; ng(n+1)=3.776965e+002;
n=18; farx(n+1)=5.584974e+002; foe(n+1)=6.088370e+002; krok(n+1)=2.840668e+000; ng(n+1)=1.188265e+002;
n=19; farx(n+1)=5.539914e+002; foe(n+1)=6.076923e+002; krok(n+1)=2.845490e+000; ng(n+1)=1.110318e+002;
n=20; farx(n+1)=5.524754e+002; foe(n+1)=6.073826e+002; krok(n+1)=5.831568e-002; ng(n+1)=6.568222e+002;
n=21; farx(n+1)=5.511117e+002; foe(n+1)=6.069974e+002; krok(n+1)=6.024636e-002; ng(n+1)=1.370574e+003;
n=22; farx(n+1)=5.393910e+002; foe(n+1)=6.015215e+002; krok(n+1)=1.420334e+000; ng(n+1)=2.487962e+002;
n=23; farx(n+1)=5.340510e+002; foe(n+1)=6.003708e+002; krok(n+1)=9.365437e-002; ng(n+1)=3.603649e+003;
n=24; farx(n+1)=2.181226e+002; foe(n+1)=4.661027e+002; krok(n+1)=1.854055e+000; ng(n+1)=6.416078e+003;
n=25; farx(n+1)=2.195550e+002; foe(n+1)=4.652057e+002; krok(n+1)=2.983603e-003; ng(n+1)=1.673867e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.392288e+002; foe(n+1)=3.939834e+002; krok(n+1)=1.802468e-004; ng(n+1)=1.155001e+003;
n=27; farx(n+1)=2.075854e+002; foe(n+1)=3.653815e+002; krok(n+1)=4.448722e-004; ng(n+1)=5.247217e+002;
n=28; farx(n+1)=1.951767e+002; foe(n+1)=3.602541e+002; krok(n+1)=2.681467e-004; ng(n+1)=3.724339e+002;
n=29; farx(n+1)=1.692147e+002; foe(n+1)=3.367984e+002; krok(n+1)=2.371549e-003; ng(n+1)=2.450817e+002;
n=30; farx(n+1)=1.462466e+002; foe(n+1)=3.034840e+002; krok(n+1)=5.557598e-003; ng(n+1)=6.232516e+002;
n=31; farx(n+1)=1.420044e+002; foe(n+1)=3.016758e+002; krok(n+1)=4.800146e-004; ng(n+1)=1.752187e+003;
n=32; farx(n+1)=1.359941e+002; foe(n+1)=2.827404e+002; krok(n+1)=1.655202e-001; ng(n+1)=2.072389e+003;
n=33; farx(n+1)=1.117601e+002; foe(n+1)=2.547624e+002; krok(n+1)=3.556863e-001; ng(n+1)=2.091895e+003;
n=34; farx(n+1)=8.007242e+001; foe(n+1)=2.209034e+002; krok(n+1)=2.942678e-001; ng(n+1)=8.492863e+002;
n=35; farx(n+1)=7.634395e+001; foe(n+1)=2.043291e+002; krok(n+1)=8.256204e-001; ng(n+1)=7.098694e+002;
n=36; farx(n+1)=7.107516e+001; foe(n+1)=1.856863e+002; krok(n+1)=4.635137e-001; ng(n+1)=1.672957e+003;
n=37; farx(n+1)=5.932411e+001; foe(n+1)=1.568994e+002; krok(n+1)=1.068708e+000; ng(n+1)=7.733311e+002;
n=38; farx(n+1)=5.431183e+001; foe(n+1)=1.450982e+002; krok(n+1)=2.815910e-001; ng(n+1)=1.280482e+003;
n=39; farx(n+1)=4.908499e+001; foe(n+1)=1.253885e+002; krok(n+1)=4.641165e-001; ng(n+1)=7.492551e+002;
n=40; farx(n+1)=2.569743e+001; foe(n+1)=1.046944e+002; krok(n+1)=1.111619e-001; ng(n+1)=3.086975e+003;
n=41; farx(n+1)=1.903382e+001; foe(n+1)=9.942289e+001; krok(n+1)=1.407955e-001; ng(n+1)=4.306052e+003;
n=42; farx(n+1)=2.221701e+001; foe(n+1)=9.226018e+001; krok(n+1)=1.226847e-001; ng(n+1)=3.608670e+003;
n=43; farx(n+1)=1.290141e+001; foe(n+1)=6.970494e+001; krok(n+1)=6.224492e-001; ng(n+1)=1.610079e+003;
n=44; farx(n+1)=1.019574e+001; foe(n+1)=6.503786e+001; krok(n+1)=4.747686e-001; ng(n+1)=1.082793e+003;
n=45; farx(n+1)=8.763333e+000; foe(n+1)=6.257484e+001; krok(n+1)=2.042882e+000; ng(n+1)=2.148883e+002;
n=46; farx(n+1)=8.533464e+000; foe(n+1)=5.903639e+001; krok(n+1)=1.355274e+000; ng(n+1)=1.097197e+003;
n=47; farx(n+1)=7.853088e+000; foe(n+1)=5.357810e+001; krok(n+1)=1.522162e+000; ng(n+1)=1.937128e+003;
n=48; farx(n+1)=7.136924e+000; foe(n+1)=5.133743e+001; krok(n+1)=6.522451e-001; ng(n+1)=1.096810e+003;
n=49; farx(n+1)=6.305169e+000; foe(n+1)=5.082079e+001; krok(n+1)=5.115815e-001; ng(n+1)=7.306767e+002;
n=50; farx(n+1)=5.586307e+000; foe(n+1)=5.034050e+001; krok(n+1)=5.551463e-001; ng(n+1)=3.876467e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=5.546720e+000; foe(n+1)=5.020643e+001; krok(n+1)=1.856354e-006; ng(n+1)=6.586874e+002;
n=52; farx(n+1)=5.515256e+000; foe(n+1)=5.012352e+001; krok(n+1)=1.224850e-005; ng(n+1)=1.865819e+002;
n=53; farx(n+1)=5.630581e+000; foe(n+1)=5.001667e+001; krok(n+1)=4.933474e-005; ng(n+1)=1.092848e+002;
n=54; farx(n+1)=5.931088e+000; foe(n+1)=4.901054e+001; krok(n+1)=1.055362e-003; ng(n+1)=7.535993e+001;
n=55; farx(n+1)=6.334240e+000; foe(n+1)=4.809385e+001; krok(n+1)=6.273397e-003; ng(n+1)=1.497576e+002;
n=56; farx(n+1)=6.190894e+000; foe(n+1)=4.799376e+001; krok(n+1)=3.192743e-002; ng(n+1)=3.460018e+002;
n=57; farx(n+1)=6.015818e+000; foe(n+1)=4.798407e+001; krok(n+1)=5.793922e-002; ng(n+1)=2.118080e+002;
n=58; farx(n+1)=5.869330e+000; foe(n+1)=4.776826e+001; krok(n+1)=8.456470e-001; ng(n+1)=2.404925e+002;
n=59; farx(n+1)=5.738631e+000; foe(n+1)=4.765462e+001; krok(n+1)=1.065469e+000; ng(n+1)=3.818110e+002;
n=60; farx(n+1)=5.556252e+000; foe(n+1)=4.761402e+001; krok(n+1)=7.212814e-001; ng(n+1)=1.154585e+002;
n=61; farx(n+1)=5.350845e+000; foe(n+1)=4.758122e+001; krok(n+1)=1.157348e+000; ng(n+1)=9.834900e+001;
n=62; farx(n+1)=5.287850e+000; foe(n+1)=4.755959e+001; krok(n+1)=1.239464e+000; ng(n+1)=1.924549e+002;
n=63; farx(n+1)=5.149912e+000; foe(n+1)=4.754466e+001; krok(n+1)=8.008859e-001; ng(n+1)=4.191175e+001;
n=64; farx(n+1)=5.045706e+000; foe(n+1)=4.753981e+001; krok(n+1)=1.390988e+000; ng(n+1)=3.787754e+001;
n=65; farx(n+1)=5.033594e+000; foe(n+1)=4.753712e+001; krok(n+1)=9.110982e-001; ng(n+1)=6.737915e+001;
n=66; farx(n+1)=4.970634e+000; foe(n+1)=4.753594e+001; krok(n+1)=9.372047e-001; ng(n+1)=1.713477e+001;
n=67; farx(n+1)=4.939787e+000; foe(n+1)=4.753575e+001; krok(n+1)=1.205335e+000; ng(n+1)=8.228438e+000;
n=68; farx(n+1)=4.938073e+000; foe(n+1)=4.753572e+001; krok(n+1)=9.483842e-001; ng(n+1)=4.208580e+000;
n=69; farx(n+1)=4.936847e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.131462e+000; ng(n+1)=5.802523e-001;
n=70; farx(n+1)=4.934232e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.659005e+000; ng(n+1)=2.484258e+000;
n=71; farx(n+1)=4.935438e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.718491e-001; ng(n+1)=4.292584e-001;
n=72; farx(n+1)=4.935643e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.665126e-001; ng(n+1)=7.237126e-002;
n=73; farx(n+1)=4.935643e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.115447e-005; ng(n+1)=1.530805e-002;
n=74; farx(n+1)=4.935643e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.289751e-005; ng(n+1)=1.530772e-002;
n=75; farx(n+1)=4.935643e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.877391e-005; ng(n+1)=1.530708e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=4.935644e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.395270e-006; ng(n+1)=1.530664e-002;
n=77; farx(n+1)=4.935644e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.253359e-006; ng(n+1)=8.610073e-003;
n=78; farx(n+1)=4.935646e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.278902e-005; ng(n+1)=2.273566e-003;
n=79; farx(n+1)=4.935656e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.311517e-003; ng(n+1)=4.476452e-004;
n=80; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.621201e-003; ng(n+1)=6.157166e-004;
n=81; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.873148e-006; ng(n+1)=1.992856e-004;
n=82; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.410994e-006; ng(n+1)=1.992771e-004;
n=83; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.053211e-006; ng(n+1)=1.992752e-004;
n=84; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.750632e-010; ng(n+1)=1.992742e-004;
n=85; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.498801e-007; ng(n+1)=1.992742e-004;
n=86; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.130900e-006; ng(n+1)=1.992729e-004;
n=87; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.285467e-007; ng(n+1)=1.993197e-004;
n=88; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.938898e-009; ng(n+1)=1.993197e-004;
n=89; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.789061e-010; ng(n+1)=1.993197e-004;
n=90; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.481841e-011; ng(n+1)=1.993197e-004;
n=91; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.252622e-010; ng(n+1)=1.993197e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=92; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.679704e-008; ng(n+1)=1.993196e-004;
n=93; farx(n+1)=4.935680e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.434805e-005; ng(n+1)=1.964078e-004;
n=94; farx(n+1)=4.935679e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.346291e-005; ng(n+1)=1.995821e-004;
n=95; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.051395e-004; ng(n+1)=9.572105e-004;
n=96; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.085336e-010; ng(n+1)=6.220229e-004;
n=97; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.983720e-009; ng(n+1)=6.220229e-004;
n=98; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.376322e-010; ng(n+1)=6.220229e-004;
n=99; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.506457e-009; ng(n+1)=6.220229e-004;
n=100; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.619407e-010; ng(n+1)=6.220227e-004;
%odnowa zmiennej metryki
n=101; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.300043e-006; ng(n+1)=6.220227e-004;
n=102; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.136506e-006; ng(n+1)=5.805868e-004;
n=103; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.213196e-006; ng(n+1)=2.728399e-004;
n=104; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.630916e-005; ng(n+1)=2.539546e-004;
n=105; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.325749e-006; ng(n+1)=2.544280e-004;
n=106; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.735702e-006; ng(n+1)=2.544265e-004;
n=107; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.442444e-011; ng(n+1)=2.544245e-004;
n=108; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.587609e-011; ng(n+1)=2.544245e-004;
n=109; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.965520e-012; ng(n+1)=2.544244e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=110; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.049989e-006; ng(n+1)=2.544244e-004;
n=111; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.144988e-012; ng(n+1)=3.466597e-004;
n=112; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.378849e-006; ng(n+1)=3.466598e-004;
n=113; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.190752e-005; ng(n+1)=2.624460e-004;
n=114; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.041144e-005; ng(n+1)=3.449197e-004;
n=115; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.290637e-007; ng(n+1)=3.834960e-004;
n=116; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.103245e-006; ng(n+1)=3.834882e-004;
n=117; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.523765e-006; ng(n+1)=3.834243e-004;
n=118; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.174027e-006; ng(n+1)=3.834217e-004;
n=119; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.230894e-005; ng(n+1)=3.833476e-004;
n=120; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.209447e-005; ng(n+1)=3.833247e-004;
n=121; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.523410e-006; ng(n+1)=3.833116e-004;
n=122; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.906893e-009; ng(n+1)=3.833045e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=123; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.620268e-007; ng(n+1)=3.833045e-004;
n=124; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.137811e-006; ng(n+1)=3.239158e-004;
n=125; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.557602e-005; ng(n+1)=3.217218e-004;
%odnowa zmiennej metryki
n=126; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.888310e-006; ng(n+1)=3.729039e-004;
n=127; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.197003e-006; ng(n+1)=5.781959e-004;
n=128; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.639991e-005; ng(n+1)=3.828150e-004;
n=129; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.004836e-010; ng(n+1)=3.754073e-004;
n=130; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.487547e-010; ng(n+1)=3.754073e-004;
n=131; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.796566e-011; ng(n+1)=3.754073e-004;
 % z造 kierunek w metodzie zm - odnowa 
n=132; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.469987e-013; ng(n+1)=3.754072e-004;
n=133; farx(n+1)=4.935677e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.051110e-012; ng(n+1)=3.754070e-004;
 % z造 kierunek w metodzie zm - odnowa 
 % z造 kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
