%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.069798e+003; foe(n+1)=3.038859e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.642712e+003; foe(n+1)=2.554464e+003; krok(n+1)=3.522699e-004; ng(n+1)=1.580419e+003;
n=2; farx(n+1)=6.931395e+002; foe(n+1)=5.905807e+002; krok(n+1)=4.505183e-003; ng(n+1)=6.825135e+002;
n=3; farx(n+1)=6.568430e+002; foe(n+1)=5.067592e+002; krok(n+1)=3.909299e-004; ng(n+1)=1.294447e+003;
n=4; farx(n+1)=7.758344e+002; foe(n+1)=4.657699e+002; krok(n+1)=2.394037e-003; ng(n+1)=1.066876e+003;
n=5; farx(n+1)=6.720745e+002; foe(n+1)=4.593403e+002; krok(n+1)=3.683227e-003; ng(n+1)=2.697975e+002;
n=6; farx(n+1)=6.646756e+002; foe(n+1)=4.389136e+002; krok(n+1)=4.060145e-002; ng(n+1)=4.281897e+002;
n=7; farx(n+1)=6.399838e+002; foe(n+1)=4.293898e+002; krok(n+1)=8.662598e-002; ng(n+1)=4.056315e+002;
n=8; farx(n+1)=4.141597e+002; foe(n+1)=3.778003e+002; krok(n+1)=6.888628e-001; ng(n+1)=3.869367e+002;
n=9; farx(n+1)=2.556183e+002; foe(n+1)=3.463684e+002; krok(n+1)=2.002215e-001; ng(n+1)=3.966386e+002;
n=10; farx(n+1)=1.555717e+002; foe(n+1)=3.350515e+002; krok(n+1)=6.335709e-001; ng(n+1)=4.414356e+002;
n=11; farx(n+1)=1.455719e+002; foe(n+1)=3.314347e+002; krok(n+1)=6.259203e-002; ng(n+1)=8.593904e+002;
n=12; farx(n+1)=1.501216e+002; foe(n+1)=3.154072e+002; krok(n+1)=3.839848e-001; ng(n+1)=7.376455e+002;
n=13; farx(n+1)=9.171556e+001; foe(n+1)=2.686860e+002; krok(n+1)=6.101385e-001; ng(n+1)=3.139417e+002;
n=14; farx(n+1)=5.977409e+001; foe(n+1)=2.469702e+002; krok(n+1)=6.776371e-001; ng(n+1)=1.158301e+003;
n=15; farx(n+1)=5.546489e+001; foe(n+1)=2.231568e+002; krok(n+1)=3.519888e-002; ng(n+1)=3.071446e+003;
n=16; farx(n+1)=5.354372e+001; foe(n+1)=1.831027e+002; krok(n+1)=1.752988e-001; ng(n+1)=3.453886e+003;
n=17; farx(n+1)=5.255959e+001; foe(n+1)=1.610454e+002; krok(n+1)=2.889668e-001; ng(n+1)=2.124148e+003;
n=18; farx(n+1)=4.478942e+001; foe(n+1)=1.495767e+002; krok(n+1)=1.752988e-001; ng(n+1)=1.672239e+003;
n=19; farx(n+1)=3.744022e+001; foe(n+1)=1.312843e+002; krok(n+1)=3.923690e-001; ng(n+1)=2.395797e+003;
n=20; farx(n+1)=2.310468e+001; foe(n+1)=1.023330e+002; krok(n+1)=1.138091e+000; ng(n+1)=3.319649e+002;
n=21; farx(n+1)=2.114539e+001; foe(n+1)=8.266566e+001; krok(n+1)=2.722905e+000; ng(n+1)=1.525550e+003;
n=22; farx(n+1)=1.676859e+001; foe(n+1)=7.587799e+001; krok(n+1)=4.353621e-001; ng(n+1)=1.472959e+003;
n=23; farx(n+1)=9.216236e+000; foe(n+1)=6.165394e+001; krok(n+1)=5.436452e-001; ng(n+1)=4.005219e+002;
n=24; farx(n+1)=8.505895e+000; foe(n+1)=5.986391e+001; krok(n+1)=4.602673e-001; ng(n+1)=3.786637e+002;
n=25; farx(n+1)=9.546204e+000; foe(n+1)=5.579091e+001; krok(n+1)=8.858725e-001; ng(n+1)=1.498069e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=9.106973e+000; foe(n+1)=5.438007e+001; krok(n+1)=3.578487e-006; ng(n+1)=1.506005e+003;
n=27; farx(n+1)=8.913616e+000; foe(n+1)=5.377627e+001; krok(n+1)=1.476011e-005; ng(n+1)=4.298790e+002;
n=28; farx(n+1)=8.461415e+000; foe(n+1)=5.334232e+001; krok(n+1)=3.738062e-004; ng(n+1)=7.074826e+001;
n=29; farx(n+1)=8.164207e+000; foe(n+1)=5.207242e+001; krok(n+1)=3.636899e-004; ng(n+1)=1.509201e+002;
n=30; farx(n+1)=8.461946e+000; foe(n+1)=5.090668e+001; krok(n+1)=4.336062e-003; ng(n+1)=1.325370e+002;
n=31; farx(n+1)=7.714931e+000; foe(n+1)=5.045586e+001; krok(n+1)=1.121665e-002; ng(n+1)=9.256926e+002;
n=32; farx(n+1)=6.735282e+000; foe(n+1)=5.016372e+001; krok(n+1)=4.669156e-002; ng(n+1)=1.329042e+003;
n=33; farx(n+1)=6.722771e+000; foe(n+1)=4.918803e+001; krok(n+1)=8.377184e-001; ng(n+1)=1.250224e+003;
n=34; farx(n+1)=6.397997e+000; foe(n+1)=4.853994e+001; krok(n+1)=1.285312e+000; ng(n+1)=3.021303e+002;
n=35; farx(n+1)=6.263367e+000; foe(n+1)=4.812005e+001; krok(n+1)=5.344503e-001; ng(n+1)=2.141541e+002;
n=36; farx(n+1)=6.166920e+000; foe(n+1)=4.796083e+001; krok(n+1)=9.282331e-001; ng(n+1)=4.397155e+002;
n=37; farx(n+1)=6.013022e+000; foe(n+1)=4.781014e+001; krok(n+1)=1.289896e+000; ng(n+1)=2.752084e+002;
n=38; farx(n+1)=5.748286e+000; foe(n+1)=4.769390e+001; krok(n+1)=8.127796e-001; ng(n+1)=2.527626e+002;
n=39; farx(n+1)=5.539967e+000; foe(n+1)=4.765476e+001; krok(n+1)=9.574267e-001; ng(n+1)=1.540752e+002;
n=40; farx(n+1)=5.225988e+000; foe(n+1)=4.757224e+001; krok(n+1)=2.445328e+000; ng(n+1)=1.249392e+002;
n=41; farx(n+1)=5.262115e+000; foe(n+1)=4.755237e+001; krok(n+1)=6.893469e-001; ng(n+1)=8.017542e+001;
n=42; farx(n+1)=5.246647e+000; foe(n+1)=4.754782e+001; krok(n+1)=2.985161e-001; ng(n+1)=4.845285e+001;
n=43; farx(n+1)=5.093415e+000; foe(n+1)=4.754181e+001; krok(n+1)=5.571345e-001; ng(n+1)=1.057209e+001;
n=44; farx(n+1)=5.038068e+000; foe(n+1)=4.753821e+001; krok(n+1)=1.304490e+000; ng(n+1)=3.302917e+001;
n=45; farx(n+1)=4.999951e+000; foe(n+1)=4.753676e+001; krok(n+1)=6.710813e-001; ng(n+1)=2.787315e+001;
n=46; farx(n+1)=4.976241e+000; foe(n+1)=4.753618e+001; krok(n+1)=1.476581e+000; ng(n+1)=2.971419e+001;
n=47; farx(n+1)=4.948608e+000; foe(n+1)=4.753601e+001; krok(n+1)=8.252141e-001; ng(n+1)=6.468047e+000;
n=48; farx(n+1)=4.925296e+000; foe(n+1)=4.753580e+001; krok(n+1)=2.278251e+000; ng(n+1)=1.446420e+001;
n=49; farx(n+1)=4.934164e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.458994e+000; ng(n+1)=2.574990e+000;
n=50; farx(n+1)=4.934998e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.142810e+000; ng(n+1)=1.489035e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.935010e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.372676e-006; ng(n+1)=2.734494e-001;
n=52; farx(n+1)=4.935025e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.288329e-006; ng(n+1)=1.785369e-001;
n=53; farx(n+1)=4.935073e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.823411e-005; ng(n+1)=7.488639e-002;
n=54; farx(n+1)=4.935032e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.427772e-003; ng(n+1)=7.470288e-003;
n=55; farx(n+1)=4.935041e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.742176e-002; ng(n+1)=1.978034e-003;
n=56; farx(n+1)=4.935299e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.715458e-002; ng(n+1)=1.173550e-003;
n=57; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.061847e-002; ng(n+1)=1.654423e-003;
n=58; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.841122e-006; ng(n+1)=9.832906e-004;
n=59; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.824774e-006; ng(n+1)=9.832809e-004;
n=60; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.779522e-007; ng(n+1)=9.832752e-004;
n=61; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.365069e-008; ng(n+1)=9.832748e-004;
n=62; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.167891e-006; ng(n+1)=9.832747e-004;
n=63; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.972462e-008; ng(n+1)=9.832728e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=64; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.156771e-006; ng(n+1)=9.832728e-004;
n=65; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.608395e-006; ng(n+1)=9.105774e-004;
n=66; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.248864e-006; ng(n+1)=4.800755e-004;
n=67; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.453926e-005; ng(n+1)=4.814084e-004;
n=68; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.103214e-005; ng(n+1)=4.802294e-004;
n=69; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.129905e-007; ng(n+1)=4.802211e-004;
n=70; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.197415e-005; ng(n+1)=4.802210e-004;
n=71; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.141360e-007; ng(n+1)=4.802045e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
