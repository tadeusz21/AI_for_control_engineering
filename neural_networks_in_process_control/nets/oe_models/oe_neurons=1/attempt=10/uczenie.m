%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.063454e+003; foe(n+1)=3.072286e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.610755e+003; foe(n+1)=2.610840e+003; krok(n+1)=3.403614e-004; ng(n+1)=1.459717e+003;
n=2; farx(n+1)=2.622421e+003; foe(n+1)=2.397334e+003; krok(n+1)=9.513276e-003; ng(n+1)=1.668373e+002;
n=3; farx(n+1)=7.114694e+002; foe(n+1)=8.046440e+002; krok(n+1)=6.772877e-005; ng(n+1)=5.538300e+003;
n=4; farx(n+1)=6.162680e+002; foe(n+1)=7.543275e+002; krok(n+1)=2.148369e-006; ng(n+1)=8.072079e+003;
n=5; farx(n+1)=1.183603e+003; foe(n+1)=6.218508e+002; krok(n+1)=3.906606e-005; ng(n+1)=8.902764e+003;
n=6; farx(n+1)=1.477036e+003; foe(n+1)=5.488949e+002; krok(n+1)=4.267236e-004; ng(n+1)=2.266827e+003;
n=7; farx(n+1)=1.489938e+003; foe(n+1)=5.476413e+002; krok(n+1)=6.518015e-004; ng(n+1)=1.605857e+003;
n=8; farx(n+1)=1.431583e+003; foe(n+1)=5.442738e+002; krok(n+1)=1.340836e-001; ng(n+1)=1.568149e+003;
n=9; farx(n+1)=7.245126e+002; foe(n+1)=5.147857e+002; krok(n+1)=1.093143e-001; ng(n+1)=1.439136e+003;
n=10; farx(n+1)=1.061720e+002; foe(n+1)=3.818494e+002; krok(n+1)=2.208206e+000; ng(n+1)=3.626628e+003;
n=11; farx(n+1)=9.553304e+001; foe(n+1)=3.783310e+002; krok(n+1)=3.582758e-002; ng(n+1)=4.586016e+003;
n=12; farx(n+1)=9.444657e+001; foe(n+1)=3.438410e+002; krok(n+1)=5.725819e-001; ng(n+1)=6.082136e+003;
n=13; farx(n+1)=1.442154e+001; foe(n+1)=1.825265e+002; krok(n+1)=1.390988e+000; ng(n+1)=6.114679e+003;
n=14; farx(n+1)=1.046046e+001; foe(n+1)=1.634007e+002; krok(n+1)=6.954057e-002; ng(n+1)=2.044274e+004;
n=15; farx(n+1)=7.820837e+000; foe(n+1)=1.253885e+002; krok(n+1)=2.484264e-001; ng(n+1)=1.968905e+004;
n=16; farx(n+1)=8.927112e+000; foe(n+1)=1.186366e+002; krok(n+1)=5.779335e-001; ng(n+1)=2.955303e+003;
n=17; farx(n+1)=8.300800e+000; foe(n+1)=1.155211e+002; krok(n+1)=2.502884e-001; ng(n+1)=1.573493e+003;
n=18; farx(n+1)=7.553026e+000; foe(n+1)=1.081558e+002; krok(n+1)=2.002307e+000; ng(n+1)=2.213554e+003;
n=19; farx(n+1)=7.543440e+000; foe(n+1)=9.044373e+001; krok(n+1)=4.393315e+000; ng(n+1)=5.102296e+003;
n=20; farx(n+1)=7.480934e+000; foe(n+1)=8.556962e+001; krok(n+1)=7.560816e-001; ng(n+1)=7.837843e+003;
n=21; farx(n+1)=6.632633e+000; foe(n+1)=8.124146e+001; krok(n+1)=5.951867e-001; ng(n+1)=1.720921e+003;
n=22; farx(n+1)=6.197794e+000; foe(n+1)=7.923349e+001; krok(n+1)=1.535351e+000; ng(n+1)=1.892634e+003;
n=23; farx(n+1)=6.172039e+000; foe(n+1)=7.865964e+001; krok(n+1)=1.119298e+000; ng(n+1)=1.074939e+003;
n=24; farx(n+1)=6.139870e+000; foe(n+1)=7.560592e+001; krok(n+1)=5.563951e+000; ng(n+1)=4.934173e+002;
n=25; farx(n+1)=7.054749e+000; foe(n+1)=7.230200e+001; krok(n+1)=2.485026e+000; ng(n+1)=2.018747e+003;
%odnowa zmiennej metryki
n=26; farx(n+1)=7.049085e+000; foe(n+1)=7.050602e+001; krok(n+1)=6.107947e-007; ng(n+1)=3.764825e+003;
n=27; farx(n+1)=6.977907e+000; foe(n+1)=7.022731e+001; krok(n+1)=5.834398e-006; ng(n+1)=5.156971e+002;
n=28; farx(n+1)=6.640555e+000; foe(n+1)=6.988933e+001; krok(n+1)=1.109569e-005; ng(n+1)=3.564747e+002;
n=29; farx(n+1)=4.236065e+000; foe(n+1)=6.038230e+001; krok(n+1)=8.029022e-003; ng(n+1)=1.646251e+002;
n=30; farx(n+1)=2.671664e+000; foe(n+1)=5.573338e+001; krok(n+1)=3.470726e-003; ng(n+1)=4.170860e+003;
n=31; farx(n+1)=2.648001e+000; foe(n+1)=5.214132e+001; krok(n+1)=6.572826e-003; ng(n+1)=7.277411e+003;
n=32; farx(n+1)=2.410306e+000; foe(n+1)=5.197848e+001; krok(n+1)=1.891778e-003; ng(n+1)=3.540880e+003;
n=33; farx(n+1)=2.707169e+000; foe(n+1)=5.062904e+001; krok(n+1)=1.046893e-001; ng(n+1)=3.573861e+003;
n=34; farx(n+1)=2.231114e+000; foe(n+1)=4.901345e+001; krok(n+1)=2.485530e-001; ng(n+1)=2.817730e+003;
n=35; farx(n+1)=2.217035e+000; foe(n+1)=4.827032e+001; krok(n+1)=3.923690e-001; ng(n+1)=1.697957e+003;
n=36; farx(n+1)=2.187741e+000; foe(n+1)=4.823069e+001; krok(n+1)=3.493083e-001; ng(n+1)=1.393505e+002;
n=37; farx(n+1)=2.231228e+000; foe(n+1)=4.821910e+001; krok(n+1)=1.047159e+000; ng(n+1)=4.114038e+002;
n=38; farx(n+1)=2.231915e+000; foe(n+1)=4.821794e+001; krok(n+1)=1.047159e+000; ng(n+1)=1.011872e+002;
n=39; farx(n+1)=2.264800e+000; foe(n+1)=4.820431e+001; krok(n+1)=1.006009e+001; ng(n+1)=1.638793e+002;
n=40; farx(n+1)=2.360386e+000; foe(n+1)=4.816808e+001; krok(n+1)=2.845490e+000; ng(n+1)=2.347650e+002;
n=41; farx(n+1)=2.466244e+000; foe(n+1)=4.811241e+001; krok(n+1)=2.018136e+000; ng(n+1)=4.005692e+002;
n=42; farx(n+1)=2.548572e+000; foe(n+1)=4.808062e+001; krok(n+1)=4.572701e-001; ng(n+1)=4.730016e+002;
n=43; farx(n+1)=2.581330e+000; foe(n+1)=4.805602e+001; krok(n+1)=4.288049e-001; ng(n+1)=2.765498e+002;
n=44; farx(n+1)=2.678756e+000; foe(n+1)=4.801237e+001; krok(n+1)=2.547186e+000; ng(n+1)=4.084461e+002;
n=45; farx(n+1)=2.691454e+000; foe(n+1)=4.798839e+001; krok(n+1)=5.155493e-001; ng(n+1)=3.503753e+002;
n=46; farx(n+1)=2.827120e+000; foe(n+1)=4.794934e+001; krok(n+1)=1.138091e+000; ng(n+1)=1.052725e+002;
n=47; farx(n+1)=2.944706e+000; foe(n+1)=4.791600e+001; krok(n+1)=1.315598e+000; ng(n+1)=2.865988e+002;
n=48; farx(n+1)=2.998802e+000; foe(n+1)=4.788654e+001; krok(n+1)=1.062525e+000; ng(n+1)=5.493504e+002;
n=49; farx(n+1)=3.126608e+000; foe(n+1)=4.785661e+001; krok(n+1)=4.305446e-001; ng(n+1)=1.428645e+002;
n=50; farx(n+1)=3.225912e+000; foe(n+1)=4.783690e+001; krok(n+1)=1.105172e+000; ng(n+1)=1.363964e+002;
%odnowa zmiennej metryki
n=51; farx(n+1)=3.223120e+000; foe(n+1)=4.782089e+001; krok(n+1)=1.076280e-006; ng(n+1)=2.748287e+002;
n=52; farx(n+1)=3.224771e+000; foe(n+1)=4.781021e+001; krok(n+1)=8.586539e-007; ng(n+1)=2.162914e+002;
n=53; farx(n+1)=3.219907e+000; foe(n+1)=4.780957e+001; krok(n+1)=1.030147e-005; ng(n+1)=1.618857e+001;
n=54; farx(n+1)=3.224485e+000; foe(n+1)=4.780607e+001; krok(n+1)=1.651908e-003; ng(n+1)=3.172863e+000;
n=55; farx(n+1)=3.179462e+000; foe(n+1)=4.779747e+001; krok(n+1)=1.660195e-002; ng(n+1)=1.769828e+000;
n=56; farx(n+1)=3.381652e+000; foe(n+1)=4.776567e+001; krok(n+1)=2.556212e-002; ng(n+1)=1.785255e+001;
n=57; farx(n+1)=3.372762e+000; foe(n+1)=4.776512e+001; krok(n+1)=1.360047e-002; ng(n+1)=2.041279e+002;
n=58; farx(n+1)=3.700263e+000; foe(n+1)=4.772564e+001; krok(n+1)=1.535351e+000; ng(n+1)=2.161978e+002;
n=59; farx(n+1)=3.715069e+000; foe(n+1)=4.770782e+001; krok(n+1)=5.115815e-001; ng(n+1)=2.498920e+002;
n=60; farx(n+1)=3.853375e+000; foe(n+1)=4.766624e+001; krok(n+1)=1.707324e+000; ng(n+1)=9.669540e+001;
n=61; farx(n+1)=3.964502e+000; foe(n+1)=4.763513e+001; krok(n+1)=2.012248e+000; ng(n+1)=1.572342e+002;
n=62; farx(n+1)=3.976085e+000; foe(n+1)=4.762075e+001; krok(n+1)=5.039997e-001; ng(n+1)=2.241846e+002;
n=63; farx(n+1)=4.152331e+000; foe(n+1)=4.760071e+001; krok(n+1)=6.446279e-001; ng(n+1)=3.047253e+001;
n=64; farx(n+1)=4.348754e+000; foe(n+1)=4.758514e+001; krok(n+1)=1.083912e+000; ng(n+1)=8.710315e+001;
n=65; farx(n+1)=4.438034e+000; foe(n+1)=4.757072e+001; krok(n+1)=7.927530e-001; ng(n+1)=1.565589e+002;
n=66; farx(n+1)=4.630102e+000; foe(n+1)=4.755690e+001; krok(n+1)=1.585247e+000; ng(n+1)=9.122645e+001;
n=67; farx(n+1)=4.698849e+000; foe(n+1)=4.754418e+001; krok(n+1)=2.772031e+000; ng(n+1)=8.591415e+001;
n=68; farx(n+1)=4.784883e+000; foe(n+1)=4.753954e+001; krok(n+1)=3.923690e-001; ng(n+1)=9.407595e+001;
n=69; farx(n+1)=4.813344e+000; foe(n+1)=4.753770e+001; krok(n+1)=8.088973e-001; ng(n+1)=3.399166e+001;
n=70; farx(n+1)=4.920366e+000; foe(n+1)=4.753628e+001; krok(n+1)=2.285620e+000; ng(n+1)=5.134175e+001;
n=71; farx(n+1)=4.921823e+000; foe(n+1)=4.753597e+001; krok(n+1)=6.809733e-001; ng(n+1)=3.354355e+001;
n=72; farx(n+1)=4.939867e+000; foe(n+1)=4.753580e+001; krok(n+1)=1.970610e+000; ng(n+1)=9.749210e+000;
n=73; farx(n+1)=4.932354e+000; foe(n+1)=4.753575e+001; krok(n+1)=3.568867e+000; ng(n+1)=1.119097e+001;
n=74; farx(n+1)=4.934806e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.360240e+000; ng(n+1)=2.805705e+000;
n=75; farx(n+1)=4.935900e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.531110e+000; ng(n+1)=1.060012e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=4.935903e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.452269e-006; ng(n+1)=3.356649e-001;
n=77; farx(n+1)=4.935949e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.818511e-006; ng(n+1)=3.202276e-001;
n=78; farx(n+1)=4.936031e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.392684e-005; ng(n+1)=1.788693e-001;
n=79; farx(n+1)=4.935785e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.480489e-003; ng(n+1)=7.318405e-003;
n=80; farx(n+1)=4.935445e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.823736e-003; ng(n+1)=9.433638e-003;
n=81; farx(n+1)=4.935444e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.567713e-002; ng(n+1)=2.068488e-003;
n=82; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.379078e-001; ng(n+1)=1.257327e-003;
n=83; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.777617e-005; ng(n+1)=7.092229e-004;
n=84; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.139406e-008; ng(n+1)=7.091961e-004;
n=85; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.877941e-008; ng(n+1)=7.091961e-004;
n=86; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.433644e-006; ng(n+1)=7.091960e-004;
n=87; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.052908e-007; ng(n+1)=7.091917e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=88; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.937881e-007; ng(n+1)=7.091914e-004;
n=89; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=4.300043e-006; ng(n+1)=4.488041e-004;
n=90; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.416866e-005; ng(n+1)=3.160294e-004;
n=91; farx(n+1)=4.935687e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.518627e-010; ng(n+1)=3.396894e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
