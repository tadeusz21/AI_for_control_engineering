%uczenie predyktora oe
clear all;
n=0; farx(n+1)=3.053350e+003; foe(n+1)=3.057353e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.543712e+003; foe(n+1)=2.579494e+003; krok(n+1)=3.467612e-004; ng(n+1)=1.356402e+003;
n=2; farx(n+1)=4.533005e+002; foe(n+1)=5.652267e+002; krok(n+1)=5.060913e-003; ng(n+1)=4.904912e+002;
n=3; farx(n+1)=4.476948e+002; foe(n+1)=5.218294e+002; krok(n+1)=7.063894e-005; ng(n+1)=1.961819e+003;
n=4; farx(n+1)=6.260978e+002; foe(n+1)=4.875608e+002; krok(n+1)=7.557764e-004; ng(n+1)=2.134219e+003;
n=5; farx(n+1)=5.440495e+002; foe(n+1)=4.536079e+002; krok(n+1)=8.894860e-003; ng(n+1)=6.538386e+002;
n=6; farx(n+1)=5.512738e+002; foe(n+1)=4.487967e+002; krok(n+1)=2.121025e-003; ng(n+1)=9.565518e+002;
n=7; farx(n+1)=2.317936e+002; foe(n+1)=4.053285e+002; krok(n+1)=1.267169e-001; ng(n+1)=9.771617e+002;
n=8; farx(n+1)=1.430203e+002; foe(n+1)=3.844046e+002; krok(n+1)=1.626130e-002; ng(n+1)=3.818621e+003;
n=9; farx(n+1)=7.223220e+001; foe(n+1)=3.193118e+002; krok(n+1)=4.268310e-001; ng(n+1)=6.249436e+003;
n=10; farx(n+1)=7.946561e+001; foe(n+1)=2.539550e+002; krok(n+1)=2.161212e-001; ng(n+1)=7.929651e+003;
n=11; farx(n+1)=2.960581e+001; foe(n+1)=1.271341e+002; krok(n+1)=3.224739e-001; ng(n+1)=2.447890e+003;
n=12; farx(n+1)=3.010686e+001; foe(n+1)=1.179805e+002; krok(n+1)=2.193298e-001; ng(n+1)=1.282501e+003;
n=13; farx(n+1)=1.541514e+001; foe(n+1)=8.259517e+001; krok(n+1)=8.131859e-001; ng(n+1)=6.054061e+002;
n=14; farx(n+1)=1.426852e+001; foe(n+1)=8.065695e+001; krok(n+1)=1.434696e-001; ng(n+1)=5.358432e+002;
n=15; farx(n+1)=1.411822e+001; foe(n+1)=7.469338e+001; krok(n+1)=4.536903e-001; ng(n+1)=1.241014e+002;
n=16; farx(n+1)=1.048897e+001; foe(n+1)=6.578540e+001; krok(n+1)=1.027715e+000; ng(n+1)=8.827840e+002;
n=17; farx(n+1)=7.585216e+000; foe(n+1)=5.893018e+001; krok(n+1)=1.001154e+000; ng(n+1)=1.474858e+003;
n=18; farx(n+1)=7.059630e+000; foe(n+1)=5.485987e+001; krok(n+1)=1.295594e+000; ng(n+1)=6.169844e+002;
n=19; farx(n+1)=6.966855e+000; foe(n+1)=5.259367e+001; krok(n+1)=3.510640e-001; ng(n+1)=4.283928e+002;
n=20; farx(n+1)=7.232180e+000; foe(n+1)=5.141945e+001; krok(n+1)=6.888628e-001; ng(n+1)=9.415900e+002;
n=21; farx(n+1)=6.604260e+000; foe(n+1)=5.031803e+001; krok(n+1)=1.128562e+000; ng(n+1)=1.068950e+003;
n=22; farx(n+1)=6.124122e+000; foe(n+1)=4.926345e+001; krok(n+1)=1.447680e+000; ng(n+1)=3.671031e+002;
n=23; farx(n+1)=6.262474e+000; foe(n+1)=4.901174e+001; krok(n+1)=4.556164e-001; ng(n+1)=4.799768e+002;
n=24; farx(n+1)=6.586426e+000; foe(n+1)=4.861919e+001; krok(n+1)=8.031926e-001; ng(n+1)=1.046580e+002;
n=25; farx(n+1)=6.056075e+000; foe(n+1)=4.837257e+001; krok(n+1)=1.445753e+000; ng(n+1)=1.955253e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=6.063334e+000; foe(n+1)=4.830203e+001; krok(n+1)=2.400596e-006; ng(n+1)=3.251778e+002;
n=27; farx(n+1)=6.044775e+000; foe(n+1)=4.824910e+001; krok(n+1)=7.426417e-006; ng(n+1)=1.922399e+002;
n=28; farx(n+1)=5.992046e+000; foe(n+1)=4.819459e+001; krok(n+1)=5.276810e-004; ng(n+1)=2.055292e+001;
n=29; farx(n+1)=6.129843e+000; foe(n+1)=4.809953e+001; krok(n+1)=1.381179e-004; ng(n+1)=5.663262e+001;
n=30; farx(n+1)=5.741202e+000; foe(n+1)=4.788358e+001; krok(n+1)=3.201356e-002; ng(n+1)=5.144130e+000;
n=31; farx(n+1)=5.850307e+000; foe(n+1)=4.774064e+001; krok(n+1)=1.340015e-002; ng(n+1)=4.256176e+001;
n=32; farx(n+1)=5.726129e+000; foe(n+1)=4.773511e+001; krok(n+1)=4.674985e-002; ng(n+1)=1.578331e+002;
n=33; farx(n+1)=5.656713e+000; foe(n+1)=4.764336e+001; krok(n+1)=7.310195e-001; ng(n+1)=1.857316e+002;
n=34; farx(n+1)=5.508210e+000; foe(n+1)=4.759046e+001; krok(n+1)=1.127230e+000; ng(n+1)=2.561831e+002;
n=35; farx(n+1)=5.382591e+000; foe(n+1)=4.756962e+001; krok(n+1)=5.571345e-001; ng(n+1)=8.772021e+001;
n=36; farx(n+1)=5.196701e+000; foe(n+1)=4.755362e+001; krok(n+1)=1.017241e+000; ng(n+1)=6.702713e+001;
n=37; farx(n+1)=5.152795e+000; foe(n+1)=4.754512e+001; krok(n+1)=1.289896e+000; ng(n+1)=1.015378e+002;
n=38; farx(n+1)=5.032308e+000; foe(n+1)=4.753848e+001; krok(n+1)=9.576737e-001; ng(n+1)=2.747754e+001;
n=39; farx(n+1)=4.996361e+000; foe(n+1)=4.753664e+001; krok(n+1)=1.230345e+000; ng(n+1)=3.017611e+001;
n=40; farx(n+1)=4.965283e+000; foe(n+1)=4.753585e+001; krok(n+1)=1.208217e+000; ng(n+1)=1.546262e+001;
n=41; farx(n+1)=4.940984e+000; foe(n+1)=4.753572e+001; krok(n+1)=9.145602e-001; ng(n+1)=1.262430e+001;
n=42; farx(n+1)=4.937759e+000; foe(n+1)=4.753571e+001; krok(n+1)=8.674420e-001; ng(n+1)=2.413079e+000;
n=43; farx(n+1)=4.935778e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.900599e-001; ng(n+1)=1.847493e+000;
n=44; farx(n+1)=4.935974e+000; foe(n+1)=4.753571e+001; krok(n+1)=9.763190e-001; ng(n+1)=2.357209e-001;
n=45; farx(n+1)=4.935596e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.142810e+000; ng(n+1)=2.506445e-001;
n=46; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.062495e+000; ng(n+1)=1.171206e-001;
n=47; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.537796e-005; ng(n+1)=6.118920e-003;
n=48; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.253084e-005; ng(n+1)=6.118828e-003;
n=49; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.416371e-005; ng(n+1)=6.118690e-003;
n=50; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.195075e-011; ng(n+1)=6.118603e-003;
%odnowa zmiennej metryki
n=51; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.706192e-006; ng(n+1)=6.118603e-003;
n=52; farx(n+1)=4.935665e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.429186e-006; ng(n+1)=7.050767e-003;
n=53; farx(n+1)=4.935667e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.036045e-005; ng(n+1)=2.223246e-003;
n=54; farx(n+1)=4.935669e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.517461e-003; ng(n+1)=3.996556e-004;
n=55; farx(n+1)=4.935673e+000; foe(n+1)=4.753571e+001; krok(n+1)=1.155806e-002; ng(n+1)=1.619352e-004;
n=56; farx(n+1)=4.935673e+000; foe(n+1)=4.753571e+001; krok(n+1)=5.476879e-006; ng(n+1)=1.129254e-004;
n=57; farx(n+1)=4.935673e+000; foe(n+1)=4.753571e+001; krok(n+1)=7.083792e-006; ng(n+1)=1.129242e-004;
n=58; farx(n+1)=4.935673e+000; foe(n+1)=4.753571e+001; krok(n+1)=2.034310e-006; ng(n+1)=1.129226e-004;
n=59; farx(n+1)=4.935673e+000; foe(n+1)=4.753571e+001; krok(n+1)=6.227741e-010; ng(n+1)=1.129224e-004;
n=60; farx(n+1)=4.935673e+000; foe(n+1)=4.753571e+001; krok(n+1)=3.003883e-010; ng(n+1)=1.129224e-004;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora OE');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
