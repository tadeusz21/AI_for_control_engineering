%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.851244e+003; foe(n+1)=2.838968e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.325310e+003; foe(n+1)=2.576751e+003; krok(n+1)=4.532388e-004; ng(n+1)=2.911037e+003;
n=2; farx(n+1)=1.315163e+003; foe(n+1)=5.798822e+003; krok(n+1)=4.770094e-004; ng(n+1)=2.988111e+003;
n=3; farx(n+1)=8.339673e+002; foe(n+1)=9.882731e+003; krok(n+1)=5.780047e-004; ng(n+1)=4.379903e+003;
n=4; farx(n+1)=2.844061e+002; foe(n+1)=5.703456e+003; krok(n+1)=4.674043e-003; ng(n+1)=2.405461e+003;
n=5; farx(n+1)=2.582971e+002; foe(n+1)=6.114942e+003; krok(n+1)=2.145173e-003; ng(n+1)=6.117516e+002;
n=6; farx(n+1)=2.187822e+002; foe(n+1)=7.822125e+003; krok(n+1)=1.238677e-002; ng(n+1)=5.275647e+002;
n=7; farx(n+1)=1.946312e+002; foe(n+1)=7.513964e+003; krok(n+1)=5.557598e-003; ng(n+1)=1.456155e+003;
n=8; farx(n+1)=1.853262e+002; foe(n+1)=2.479724e+003; krok(n+1)=2.076180e-002; ng(n+1)=1.666614e+003;
n=9; farx(n+1)=1.582322e+002; foe(n+1)=6.848046e+002; krok(n+1)=5.997467e-003; ng(n+1)=1.754694e+003;
n=10; farx(n+1)=1.383049e+002; foe(n+1)=3.402280e+002; krok(n+1)=9.019770e-002; ng(n+1)=1.288016e+003;
n=11; farx(n+1)=9.453709e+001; foe(n+1)=8.783517e+003; krok(n+1)=2.538171e-001; ng(n+1)=1.012812e+003;
n=12; farx(n+1)=2.732298e+001; foe(n+1)=6.873482e+003; krok(n+1)=2.477256e-001; ng(n+1)=9.243044e+002;
n=13; farx(n+1)=2.407866e+001; foe(n+1)=3.391243e+002; krok(n+1)=5.174513e-001; ng(n+1)=2.647966e+002;
n=14; farx(n+1)=1.929399e+001; foe(n+1)=6.241678e+002; krok(n+1)=4.003122e-001; ng(n+1)=2.395804e+002;
n=15; farx(n+1)=1.256481e+001; foe(n+1)=4.390009e+003; krok(n+1)=3.501196e+000; ng(n+1)=2.312942e+002;
n=16; farx(n+1)=5.522664e+000; foe(n+1)=1.656258e+002; krok(n+1)=1.715220e+000; ng(n+1)=2.175415e+002;
n=17; farx(n+1)=3.242403e+000; foe(n+1)=1.116317e+002; krok(n+1)=1.153327e+000; ng(n+1)=1.697431e+002;
n=18; farx(n+1)=2.665938e+000; foe(n+1)=1.558170e+002; krok(n+1)=1.934940e+000; ng(n+1)=9.732168e+001;
n=19; farx(n+1)=2.388872e+000; foe(n+1)=1.874244e+002; krok(n+1)=1.827122e+000; ng(n+1)=3.600612e+001;
n=20; farx(n+1)=2.184870e+000; foe(n+1)=2.590886e+002; krok(n+1)=2.592175e+000; ng(n+1)=2.494469e+001;
n=21; farx(n+1)=1.761522e+000; foe(n+1)=1.297706e+002; krok(n+1)=2.050450e+000; ng(n+1)=5.464371e+001;
n=22; farx(n+1)=1.675452e+000; foe(n+1)=9.450753e+001; krok(n+1)=1.050152e+000; ng(n+1)=1.875716e+001;
n=23; farx(n+1)=1.653764e+000; foe(n+1)=7.559204e+001; krok(n+1)=2.464134e+000; ng(n+1)=1.131862e+001;
n=24; farx(n+1)=1.640208e+000; foe(n+1)=7.093908e+001; krok(n+1)=1.914853e+000; ng(n+1)=8.898728e+000;
n=25; farx(n+1)=1.625160e+000; foe(n+1)=6.787863e+001; krok(n+1)=1.924468e+000; ng(n+1)=7.724528e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.617412e+000; foe(n+1)=6.909507e+001; krok(n+1)=1.168734e-004; ng(n+1)=2.158190e+001;
n=27; farx(n+1)=1.614069e+000; foe(n+1)=7.081786e+001; krok(n+1)=3.011518e-004; ng(n+1)=1.026847e+001;
n=28; farx(n+1)=1.580934e+000; foe(n+1)=9.296249e+001; krok(n+1)=6.971205e-003; ng(n+1)=6.550800e+000;
n=29; farx(n+1)=1.489397e+000; foe(n+1)=1.059291e+002; krok(n+1)=8.003391e-003; ng(n+1)=1.083776e+001;
n=30; farx(n+1)=1.463767e+000; foe(n+1)=1.021226e+002; krok(n+1)=5.095665e-003; ng(n+1)=3.246665e+001;
n=31; farx(n+1)=1.348344e+000; foe(n+1)=8.749145e+001; krok(n+1)=3.955695e-002; ng(n+1)=4.284064e+001;
n=32; farx(n+1)=1.287072e+000; foe(n+1)=8.827755e+001; krok(n+1)=1.202721e-001; ng(n+1)=6.098820e+001;
n=33; farx(n+1)=1.226628e+000; foe(n+1)=7.687534e+001; krok(n+1)=9.528451e-001; ng(n+1)=3.789438e+001;
n=34; farx(n+1)=1.180859e+000; foe(n+1)=6.997388e+001; krok(n+1)=2.002215e-001; ng(n+1)=2.062393e+001;
n=35; farx(n+1)=1.092009e+000; foe(n+1)=5.871841e+001; krok(n+1)=1.355274e+000; ng(n+1)=1.608685e+001;
n=36; farx(n+1)=1.064948e+000; foe(n+1)=5.648044e+001; krok(n+1)=4.544515e-001; ng(n+1)=1.296800e+001;
n=37; farx(n+1)=1.029938e+000; foe(n+1)=5.345117e+001; krok(n+1)=7.310195e-001; ng(n+1)=4.230367e+001;
n=38; farx(n+1)=1.008993e+000; foe(n+1)=4.053345e+001; krok(n+1)=4.208968e-001; ng(n+1)=3.834042e+001;
n=39; farx(n+1)=9.815359e-001; foe(n+1)=3.417180e+001; krok(n+1)=1.285312e+000; ng(n+1)=1.875754e+001;
n=40; farx(n+1)=9.653812e-001; foe(n+1)=3.431148e+001; krok(n+1)=6.480438e-001; ng(n+1)=5.296630e+000;
n=41; farx(n+1)=9.539543e-001; foe(n+1)=3.997340e+001; krok(n+1)=7.011953e-001; ng(n+1)=2.228126e+001;
n=42; farx(n+1)=9.392014e-001; foe(n+1)=3.758528e+001; krok(n+1)=1.394120e+000; ng(n+1)=5.824667e+000;
n=43; farx(n+1)=9.327332e-001; foe(n+1)=3.633248e+001; krok(n+1)=6.144464e-001; ng(n+1)=2.032523e+001;
n=44; farx(n+1)=9.271295e-001; foe(n+1)=3.440924e+001; krok(n+1)=9.639418e-001; ng(n+1)=8.010295e+000;
n=45; farx(n+1)=9.232889e-001; foe(n+1)=3.450694e+001; krok(n+1)=8.256204e-001; ng(n+1)=8.711927e+000;
n=46; farx(n+1)=9.197947e-001; foe(n+1)=3.344252e+001; krok(n+1)=9.089030e-001; ng(n+1)=1.323895e+001;
n=47; farx(n+1)=9.178389e-001; foe(n+1)=3.260034e+001; krok(n+1)=8.551938e-001; ng(n+1)=1.758406e+000;
n=48; farx(n+1)=9.162078e-001; foe(n+1)=3.267312e+001; krok(n+1)=9.806012e-001; ng(n+1)=5.959215e+000;
n=49; farx(n+1)=9.150397e-001; foe(n+1)=3.200816e+001; krok(n+1)=1.220483e+000; ng(n+1)=4.340754e+000;
n=50; farx(n+1)=9.138031e-001; foe(n+1)=3.169368e+001; krok(n+1)=1.162023e+000; ng(n+1)=3.180411e+000;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.133658e-001; foe(n+1)=3.214802e+001; krok(n+1)=4.977699e-005; ng(n+1)=7.776025e+000;
n=52; farx(n+1)=9.132926e-001; foe(n+1)=3.271723e+001; krok(n+1)=1.898143e-003; ng(n+1)=5.637655e-001;
n=53; farx(n+1)=9.132844e-001; foe(n+1)=3.269591e+001; krok(n+1)=2.762358e-004; ng(n+1)=4.807959e-001;
n=54; farx(n+1)=9.124398e-001; foe(n+1)=3.140026e+001; krok(n+1)=8.277891e-002; ng(n+1)=2.830929e-001;
n=55; farx(n+1)=9.123564e-001; foe(n+1)=3.115255e+001; krok(n+1)=4.880194e-003; ng(n+1)=3.034135e-001;
n=56; farx(n+1)=9.111714e-001; foe(n+1)=3.148823e+001; krok(n+1)=2.893371e-001; ng(n+1)=2.817832e-001;
n=57; farx(n+1)=9.102803e-001; foe(n+1)=3.153772e+001; krok(n+1)=1.573255e-001; ng(n+1)=1.099783e+000;
n=58; farx(n+1)=9.093722e-001; foe(n+1)=3.110372e+001; krok(n+1)=1.310933e-001; ng(n+1)=2.681621e+000;
n=59; farx(n+1)=9.082921e-001; foe(n+1)=3.173785e+001; krok(n+1)=8.417937e-001; ng(n+1)=4.767599e+000;
n=60; farx(n+1)=9.070418e-001; foe(n+1)=3.084800e+001; krok(n+1)=1.171229e+000; ng(n+1)=1.067242e+000;
n=61; farx(n+1)=9.058856e-001; foe(n+1)=3.204301e+001; krok(n+1)=1.484568e+000; ng(n+1)=3.264475e+000;
n=62; farx(n+1)=9.052040e-001; foe(n+1)=3.226379e+001; krok(n+1)=8.375141e-001; ng(n+1)=4.904824e+000;
n=63; farx(n+1)=9.047040e-001; foe(n+1)=3.115823e+001; krok(n+1)=4.929770e-001; ng(n+1)=1.121763e+000;
n=64; farx(n+1)=9.042078e-001; foe(n+1)=3.111800e+001; krok(n+1)=1.114151e+000; ng(n+1)=3.737517e+000;
n=65; farx(n+1)=9.037981e-001; foe(n+1)=3.182589e+001; krok(n+1)=1.238762e+000; ng(n+1)=3.218567e+000;
n=66; farx(n+1)=9.032700e-001; foe(n+1)=3.105846e+001; krok(n+1)=1.104103e+000; ng(n+1)=3.370565e+000;
n=67; farx(n+1)=9.027563e-001; foe(n+1)=3.000740e+001; krok(n+1)=2.360240e+000; ng(n+1)=1.896280e+000;
n=68; farx(n+1)=9.023244e-001; foe(n+1)=3.126110e+001; krok(n+1)=1.289896e+000; ng(n+1)=1.317907e+000;
n=69; farx(n+1)=9.021194e-001; foe(n+1)=3.129460e+001; krok(n+1)=4.099104e-001; ng(n+1)=2.353263e+000;
n=70; farx(n+1)=9.019087e-001; foe(n+1)=3.099214e+001; krok(n+1)=9.282331e-001; ng(n+1)=2.826314e+000;
n=71; farx(n+1)=9.015259e-001; foe(n+1)=3.012292e+001; krok(n+1)=1.980712e+000; ng(n+1)=1.387871e+000;
n=72; farx(n+1)=9.014130e-001; foe(n+1)=3.024228e+001; krok(n+1)=1.104103e+000; ng(n+1)=6.404359e-001;
n=73; farx(n+1)=9.013105e-001; foe(n+1)=3.040129e+001; krok(n+1)=5.600723e-001; ng(n+1)=1.079925e+000;
n=74; farx(n+1)=9.012645e-001; foe(n+1)=3.057922e+001; krok(n+1)=2.498660e+000; ng(n+1)=5.808196e-001;
n=75; farx(n+1)=9.012276e-001; foe(n+1)=3.051436e+001; krok(n+1)=1.616601e+000; ng(n+1)=1.361407e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.012269e-001; foe(n+1)=3.053897e+001; krok(n+1)=1.231773e-004; ng(n+1)=1.632543e-001;
n=77; farx(n+1)=9.012268e-001; foe(n+1)=3.053823e+001; krok(n+1)=5.665485e-005; ng(n+1)=1.307965e-001;
n=78; farx(n+1)=9.012262e-001; foe(n+1)=3.050744e+001; krok(n+1)=6.113282e-003; ng(n+1)=2.800451e-002;
n=79; farx(n+1)=9.012260e-001; foe(n+1)=3.053464e+001; krok(n+1)=2.778799e-003; ng(n+1)=2.595304e-002;
n=80; farx(n+1)=9.012161e-001; foe(n+1)=3.044424e+001; krok(n+1)=1.567018e-001; ng(n+1)=2.040751e-002;
n=81; farx(n+1)=9.012072e-001; foe(n+1)=3.042585e+001; krok(n+1)=1.112054e-001; ng(n+1)=3.408173e-002;
n=82; farx(n+1)=9.011762e-001; foe(n+1)=3.055141e+001; krok(n+1)=3.214238e-001; ng(n+1)=6.602519e-002;
n=83; farx(n+1)=9.011563e-001; foe(n+1)=3.047230e+001; krok(n+1)=1.713887e-001; ng(n+1)=3.891257e-001;
n=84; farx(n+1)=9.011063e-001; foe(n+1)=3.050287e+001; krok(n+1)=1.026286e+000; ng(n+1)=7.287134e-001;
n=85; farx(n+1)=9.010714e-001; foe(n+1)=3.057291e+001; krok(n+1)=1.098329e+000; ng(n+1)=1.033422e+000;
n=86; farx(n+1)=9.010201e-001; foe(n+1)=3.044029e+001; krok(n+1)=1.380032e+000; ng(n+1)=3.611577e-001;
n=87; farx(n+1)=9.009850e-001; foe(n+1)=3.045804e+001; krok(n+1)=2.328707e+000; ng(n+1)=5.339734e-001;
n=88; farx(n+1)=9.009627e-001; foe(n+1)=3.039392e+001; krok(n+1)=1.201404e+000; ng(n+1)=3.527709e-001;
n=89; farx(n+1)=9.009358e-001; foe(n+1)=3.050449e+001; krok(n+1)=7.021280e-001; ng(n+1)=5.912201e-001;
n=90; farx(n+1)=9.009098e-001; foe(n+1)=3.046996e+001; krok(n+1)=1.546899e+000; ng(n+1)=2.307368e-001;
n=91; farx(n+1)=9.008874e-001; foe(n+1)=3.055227e+001; krok(n+1)=1.476581e+000; ng(n+1)=5.081240e-001;
n=92; farx(n+1)=9.008703e-001; foe(n+1)=3.044358e+001; krok(n+1)=1.231141e+000; ng(n+1)=3.074473e-001;
n=93; farx(n+1)=9.007903e-001; foe(n+1)=3.018409e+001; krok(n+1)=3.811380e+000; ng(n+1)=5.555463e-001;
n=94; farx(n+1)=9.007218e-001; foe(n+1)=3.031103e+001; krok(n+1)=1.191322e+000; ng(n+1)=9.087392e-001;
n=95; farx(n+1)=9.006812e-001; foe(n+1)=3.021569e+001; krok(n+1)=6.620810e-001; ng(n+1)=1.112262e+000;
n=96; farx(n+1)=9.006621e-001; foe(n+1)=3.027063e+001; krok(n+1)=1.245801e+000; ng(n+1)=6.586400e-001;
n=97; farx(n+1)=9.006533e-001; foe(n+1)=3.024010e+001; krok(n+1)=1.484568e+000; ng(n+1)=2.042548e-001;
n=98; farx(n+1)=9.006518e-001; foe(n+1)=3.028847e+001; krok(n+1)=7.113726e-001; ng(n+1)=1.438763e-001;
n=99; farx(n+1)=9.006507e-001; foe(n+1)=3.028431e+001; krok(n+1)=2.722905e+000; ng(n+1)=1.326723e-001;
n=100; farx(n+1)=9.006490e-001; foe(n+1)=3.027265e+001; krok(n+1)=3.302482e+000; ng(n+1)=1.140684e-001;
%odnowa zmiennej metryki
n=101; farx(n+1)=9.006484e-001; foe(n+1)=3.027942e+001; krok(n+1)=6.047987e-005; ng(n+1)=2.513894e-001;
n=102; farx(n+1)=9.006482e-001; foe(n+1)=3.026325e+001; krok(n+1)=1.340733e-004; ng(n+1)=9.854024e-002;
n=103; farx(n+1)=9.006481e-001; foe(n+1)=3.025698e+001; krok(n+1)=4.189449e-003; ng(n+1)=7.826171e-003;
n=104; farx(n+1)=9.006481e-001; foe(n+1)=3.026394e+001; krok(n+1)=2.334556e-003; ng(n+1)=5.948011e-003;
n=105; farx(n+1)=9.006480e-001; foe(n+1)=3.025011e+001; krok(n+1)=8.764941e-002; ng(n+1)=3.674526e-003;
n=106; farx(n+1)=9.006477e-001; foe(n+1)=3.023529e+001; krok(n+1)=2.538306e-001; ng(n+1)=2.871729e-003;
n=107; farx(n+1)=9.006465e-001; foe(n+1)=3.022816e+001; krok(n+1)=3.903951e-001; ng(n+1)=5.500783e-003;
n=108; farx(n+1)=9.006462e-001; foe(n+1)=3.023021e+001; krok(n+1)=2.688700e-001; ng(n+1)=1.855994e-002;
n=109; farx(n+1)=9.006451e-001; foe(n+1)=3.021612e+001; krok(n+1)=1.618997e+000; ng(n+1)=2.069510e-002;
n=110; farx(n+1)=9.006437e-001; foe(n+1)=3.022229e+001; krok(n+1)=1.822196e+000; ng(n+1)=1.472658e-002;
n=111; farx(n+1)=9.006436e-001; foe(n+1)=3.023329e+001; krok(n+1)=2.871495e+000; ng(n+1)=2.523347e-002;
n=112; farx(n+1)=9.006435e-001; foe(n+1)=3.022534e+001; krok(n+1)=2.045693e+000; ng(n+1)=4.580712e-002;
n=113; farx(n+1)=9.006435e-001; foe(n+1)=3.022814e+001; krok(n+1)=1.394120e+000; ng(n+1)=1.097702e-002;
n=114; farx(n+1)=9.006435e-001; foe(n+1)=3.023000e+001; krok(n+1)=5.992839e+000; ng(n+1)=1.114921e-002;
n=115; farx(n+1)=9.006435e-001; foe(n+1)=3.023001e+001; krok(n+1)=2.840668e+000; ng(n+1)=2.258669e-002;
n=116; farx(n+1)=9.006435e-001; foe(n+1)=3.023182e+001; krok(n+1)=3.568979e+000; ng(n+1)=7.039002e-004;
n=117; farx(n+1)=9.006433e-001; foe(n+1)=3.023367e+001; krok(n+1)=1.956263e+001; ng(n+1)=5.523268e-003;
n=118; farx(n+1)=9.006433e-001; foe(n+1)=3.023457e+001; krok(n+1)=1.000860e+000; ng(n+1)=1.824723e-003;
n=119; farx(n+1)=9.006433e-001; foe(n+1)=3.023457e+001; krok(n+1)=6.223032e-006; ng(n+1)=1.346174e-004;
n=120; farx(n+1)=9.006433e-001; foe(n+1)=3.023457e+001; krok(n+1)=6.808650e-009; ng(n+1)=1.346166e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=121; farx(n+1)=9.006433e-001; foe(n+1)=3.023454e+001; krok(n+1)=1.673718e-004; ng(n+1)=1.346166e-004;
n=122; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=4.646867e-005; ng(n+1)=3.923572e-005;
n=123; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=1.373458e-005; ng(n+1)=6.346693e-006;
n=124; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=3.575152e-006; ng(n+1)=6.296023e-006;
n=125; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=1.562247e-005; ng(n+1)=6.295900e-006;
%odnowa zmiennej metryki
n=126; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=1.430061e-005; ng(n+1)=6.295864e-006;
n=127; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=8.226987e-006; ng(n+1)=6.241424e-006;
n=128; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=1.069939e-005; ng(n+1)=6.163120e-006;
n=129; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=1.074419e-005; ng(n+1)=6.172115e-006;
n=130; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=2.260952e-005; ng(n+1)=6.171813e-006;
n=131; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=1.041614e-005; ng(n+1)=6.170824e-006;
n=132; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=2.840867e-006; ng(n+1)=6.170755e-006;
n=133; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=6.391721e-006; ng(n+1)=6.170670e-006;
n=134; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=5.124973e-007; ng(n+1)=6.170571e-006;
n=135; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=6.242040e-007; ng(n+1)=6.170565e-006;
n=136; farx(n+1)=9.006433e-001; foe(n+1)=3.023455e+001; krok(n+1)=4.607769e-010; ng(n+1)=6.170560e-006;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
