%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.799657e+003; foe(n+1)=2.793517e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.223152e+003; foe(n+1)=2.561754e+003; krok(n+1)=5.428245e-004; ng(n+1)=2.553221e+003;
n=2; farx(n+1)=1.441507e+003; foe(n+1)=5.630684e+003; krok(n+1)=3.259080e-004; ng(n+1)=4.093073e+003;
n=3; farx(n+1)=1.164509e+003; foe(n+1)=8.766980e+003; krok(n+1)=6.738436e-004; ng(n+1)=4.995143e+003;
n=4; farx(n+1)=1.102312e+002; foe(n+1)=6.650598e+003; krok(n+1)=6.912131e-003; ng(n+1)=3.287192e+003;
n=5; farx(n+1)=9.835074e+001; foe(n+1)=1.297444e+003; krok(n+1)=2.802141e-004; ng(n+1)=2.067438e+003;
n=6; farx(n+1)=7.888165e+001; foe(n+1)=1.676732e+004; krok(n+1)=1.757317e-003; ng(n+1)=2.272265e+003;
n=7; farx(n+1)=6.963786e+001; foe(n+1)=1.774016e+004; krok(n+1)=1.289397e-002; ng(n+1)=1.573131e+003;
n=8; farx(n+1)=3.565499e+001; foe(n+1)=1.873497e+003; krok(n+1)=3.535818e-002; ng(n+1)=1.452676e+003;
n=9; farx(n+1)=2.949705e+001; foe(n+1)=3.408340e+003; krok(n+1)=1.281894e-002; ng(n+1)=6.572231e+002;
n=10; farx(n+1)=1.813690e+001; foe(n+1)=7.859935e+002; krok(n+1)=8.662598e-002; ng(n+1)=9.278932e+002;
n=11; farx(n+1)=7.411978e+000; foe(n+1)=1.929662e+002; krok(n+1)=3.227510e-001; ng(n+1)=8.336284e+002;
n=12; farx(n+1)=6.563000e+000; foe(n+1)=2.727323e+002; krok(n+1)=8.662598e-002; ng(n+1)=1.710237e+002;
n=13; farx(n+1)=5.475632e+000; foe(n+1)=2.956465e+002; krok(n+1)=6.871474e-001; ng(n+1)=1.023087e+002;
n=14; farx(n+1)=4.391144e+000; foe(n+1)=1.202716e+002; krok(n+1)=1.514375e+000; ng(n+1)=3.740464e+001;
n=15; farx(n+1)=2.952761e+000; foe(n+1)=9.045961e+001; krok(n+1)=2.329831e+000; ng(n+1)=7.781739e+001;
n=16; farx(n+1)=2.434690e+000; foe(n+1)=9.299003e+001; krok(n+1)=6.888628e-001; ng(n+1)=3.479801e+001;
n=17; farx(n+1)=1.918414e+000; foe(n+1)=8.978886e+001; krok(n+1)=1.090364e+000; ng(n+1)=4.580747e+001;
n=18; farx(n+1)=1.589675e+000; foe(n+1)=1.496020e+002; krok(n+1)=1.626372e+000; ng(n+1)=3.706923e+001;
n=19; farx(n+1)=1.532085e+000; foe(n+1)=1.499444e+002; krok(n+1)=1.035784e+000; ng(n+1)=2.324041e+001;
n=20; farx(n+1)=1.494353e+000; foe(n+1)=1.380138e+002; krok(n+1)=1.640596e+000; ng(n+1)=3.106746e+001;
n=21; farx(n+1)=1.470204e+000; foe(n+1)=1.770259e+002; krok(n+1)=1.668193e+000; ng(n+1)=2.756858e+001;
n=22; farx(n+1)=1.418613e+000; foe(n+1)=1.776505e+002; krok(n+1)=2.278251e+000; ng(n+1)=2.351717e+001;
n=23; farx(n+1)=1.409959e+000; foe(n+1)=1.724315e+002; krok(n+1)=1.181571e+000; ng(n+1)=1.624156e+001;
n=24; farx(n+1)=1.399600e+000; foe(n+1)=1.358693e+002; krok(n+1)=2.062197e+000; ng(n+1)=7.926570e+000;
n=25; farx(n+1)=1.377356e+000; foe(n+1)=1.123359e+002; krok(n+1)=5.157023e+000; ng(n+1)=5.377094e+000;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.369133e+000; foe(n+1)=1.177191e+002; krok(n+1)=1.386777e-004; ng(n+1)=2.052252e+001;
n=27; farx(n+1)=1.365198e+000; foe(n+1)=1.213802e+002; krok(n+1)=1.065485e-004; ng(n+1)=1.637286e+001;
n=28; farx(n+1)=1.354325e+000; foe(n+1)=1.267573e+002; krok(n+1)=4.271237e-003; ng(n+1)=4.846036e+000;
n=29; farx(n+1)=1.318828e+000; foe(n+1)=1.506960e+002; krok(n+1)=1.750226e-002; ng(n+1)=4.346852e+000;
n=30; farx(n+1)=1.276565e+000; foe(n+1)=1.156579e+002; krok(n+1)=7.947193e-003; ng(n+1)=8.523741e+000;
n=31; farx(n+1)=1.254130e+000; foe(n+1)=1.043606e+002; krok(n+1)=3.413625e-002; ng(n+1)=2.485489e+001;
n=32; farx(n+1)=1.228030e+000; foe(n+1)=8.132045e+001; krok(n+1)=1.245141e-001; ng(n+1)=3.812318e+001;
n=33; farx(n+1)=1.173601e+000; foe(n+1)=6.946191e+001; krok(n+1)=1.335492e-001; ng(n+1)=3.846779e+001;
n=34; farx(n+1)=1.109438e+000; foe(n+1)=6.053258e+001; krok(n+1)=4.126070e-001; ng(n+1)=5.504938e+001;
n=35; farx(n+1)=1.071243e+000; foe(n+1)=5.558554e+001; krok(n+1)=3.213279e-001; ng(n+1)=5.599727e+001;
n=36; farx(n+1)=1.017626e+000; foe(n+1)=5.243878e+001; krok(n+1)=4.747686e-001; ng(n+1)=1.086766e+001;
n=37; farx(n+1)=9.830389e-001; foe(n+1)=3.515224e+001; krok(n+1)=1.600146e-001; ng(n+1)=3.631448e+001;
n=38; farx(n+1)=9.562823e-001; foe(n+1)=2.778095e+001; krok(n+1)=1.545805e-001; ng(n+1)=1.530806e+001;
n=39; farx(n+1)=9.438088e-001; foe(n+1)=3.108990e+001; krok(n+1)=4.406235e-001; ng(n+1)=1.009753e+001;
n=40; farx(n+1)=9.270802e-001; foe(n+1)=2.847946e+001; krok(n+1)=1.049915e+000; ng(n+1)=1.407351e+001;
n=41; farx(n+1)=9.196329e-001; foe(n+1)=2.928271e+001; krok(n+1)=1.031099e+000; ng(n+1)=6.742709e+000;
n=42; farx(n+1)=9.165496e-001; foe(n+1)=3.072362e+001; krok(n+1)=6.776371e-001; ng(n+1)=8.730505e+000;
n=43; farx(n+1)=9.152930e-001; foe(n+1)=2.955053e+001; krok(n+1)=7.610808e-001; ng(n+1)=3.223334e+000;
n=44; farx(n+1)=9.145781e-001; foe(n+1)=3.109555e+001; krok(n+1)=9.673187e-001; ng(n+1)=3.319033e+000;
n=45; farx(n+1)=9.120836e-001; foe(n+1)=3.098006e+001; krok(n+1)=2.360240e+000; ng(n+1)=2.602684e+000;
n=46; farx(n+1)=9.092725e-001; foe(n+1)=3.053558e+001; krok(n+1)=2.137801e+000; ng(n+1)=3.464628e+000;
n=47; farx(n+1)=9.087745e-001; foe(n+1)=3.095954e+001; krok(n+1)=1.128562e+000; ng(n+1)=2.009144e+000;
n=48; farx(n+1)=9.086837e-001; foe(n+1)=3.057311e+001; krok(n+1)=1.625559e+000; ng(n+1)=4.778621e-001;
n=49; farx(n+1)=9.083986e-001; foe(n+1)=3.106031e+001; krok(n+1)=4.821577e+000; ng(n+1)=1.393679e+000;
n=50; farx(n+1)=9.076689e-001; foe(n+1)=3.136606e+001; krok(n+1)=2.871462e+000; ng(n+1)=9.048766e-001;
%odnowa zmiennej metryki
n=51; farx(n+1)=9.074267e-001; foe(n+1)=3.148038e+001; krok(n+1)=1.711903e-004; ng(n+1)=3.803872e+000;
n=52; farx(n+1)=9.073642e-001; foe(n+1)=3.175759e+001; krok(n+1)=8.669030e-005; ng(n+1)=2.385220e+000;
n=53; farx(n+1)=9.071346e-001; foe(n+1)=3.106249e+001; krok(n+1)=3.503934e-003; ng(n+1)=6.459083e-001;
n=54; farx(n+1)=9.071195e-001; foe(n+1)=3.127116e+001; krok(n+1)=3.912002e-003; ng(n+1)=1.967933e-001;
n=55; farx(n+1)=9.068887e-001; foe(n+1)=3.067235e+001; krok(n+1)=8.892157e-002; ng(n+1)=1.492576e-001;
n=56; farx(n+1)=9.061679e-001; foe(n+1)=3.013998e+001; krok(n+1)=3.867248e-001; ng(n+1)=1.877922e-001;
n=57; farx(n+1)=9.060260e-001; foe(n+1)=3.033182e+001; krok(n+1)=1.041792e-001; ng(n+1)=2.681285e+000;
n=58; farx(n+1)=9.055582e-001; foe(n+1)=3.023250e+001; krok(n+1)=1.509022e+000; ng(n+1)=3.440368e+000;
n=59; farx(n+1)=9.051988e-001; foe(n+1)=3.064925e+001; krok(n+1)=1.431710e-001; ng(n+1)=1.037727e+000;
n=60; farx(n+1)=9.048454e-001; foe(n+1)=3.007317e+001; krok(n+1)=4.187571e-001; ng(n+1)=1.034556e+000;
n=61; farx(n+1)=9.043211e-001; foe(n+1)=2.986494e+001; krok(n+1)=1.138091e+000; ng(n+1)=2.208983e+000;
n=62; farx(n+1)=9.038502e-001; foe(n+1)=3.073037e+001; krok(n+1)=1.154449e+000; ng(n+1)=5.159494e+000;
n=63; farx(n+1)=9.033630e-001; foe(n+1)=3.023821e+001; krok(n+1)=6.310298e-001; ng(n+1)=1.123229e+000;
n=64; farx(n+1)=9.030326e-001; foe(n+1)=2.949565e+001; krok(n+1)=9.985387e-001; ng(n+1)=2.838165e+000;
n=65; farx(n+1)=9.027909e-001; foe(n+1)=3.015794e+001; krok(n+1)=9.372047e-001; ng(n+1)=2.097479e+000;
n=66; farx(n+1)=9.024674e-001; foe(n+1)=3.043274e+001; krok(n+1)=8.536620e-001; ng(n+1)=6.073628e-001;
n=67; farx(n+1)=9.023013e-001; foe(n+1)=3.037947e+001; krok(n+1)=1.514306e+000; ng(n+1)=2.518094e+000;
n=68; farx(n+1)=9.020293e-001; foe(n+1)=3.049187e+001; krok(n+1)=1.522431e+000; ng(n+1)=1.362405e+000;
n=69; farx(n+1)=9.018892e-001; foe(n+1)=3.029922e+001; krok(n+1)=4.836593e-001; ng(n+1)=2.343466e-001;
n=70; farx(n+1)=9.016932e-001; foe(n+1)=3.050542e+001; krok(n+1)=6.361450e-001; ng(n+1)=1.976022e+000;
n=71; farx(n+1)=9.015123e-001; foe(n+1)=3.035620e+001; krok(n+1)=1.585506e+000; ng(n+1)=1.942798e+000;
n=72; farx(n+1)=9.013853e-001; foe(n+1)=3.006061e+001; krok(n+1)=6.293018e-001; ng(n+1)=1.061941e+000;
n=73; farx(n+1)=9.012974e-001; foe(n+1)=3.025471e+001; krok(n+1)=7.807902e-001; ng(n+1)=1.684588e+000;
n=74; farx(n+1)=9.011463e-001; foe(n+1)=3.007029e+001; krok(n+1)=4.151449e+000; ng(n+1)=9.800496e-001;
n=75; farx(n+1)=9.010730e-001; foe(n+1)=3.023359e+001; krok(n+1)=1.280117e+000; ng(n+1)=1.505063e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=9.010550e-001; foe(n+1)=3.035409e+001; krok(n+1)=8.254679e-005; ng(n+1)=1.058090e+000;
n=77; farx(n+1)=9.010456e-001; foe(n+1)=3.039156e+001; krok(n+1)=1.085565e-004; ng(n+1)=7.576740e-001;
n=78; farx(n+1)=9.010422e-001; foe(n+1)=3.047441e+001; krok(n+1)=4.539152e-003; ng(n+1)=7.255099e-002;
n=79; farx(n+1)=9.010403e-001; foe(n+1)=3.040041e+001; krok(n+1)=3.941672e-003; ng(n+1)=6.367932e-002;
n=80; farx(n+1)=9.010175e-001; foe(n+1)=3.030595e+001; krok(n+1)=5.101860e-002; ng(n+1)=5.916731e-002;
n=81; farx(n+1)=9.010072e-001; foe(n+1)=3.027556e+001; krok(n+1)=1.001107e-001; ng(n+1)=2.709656e-002;
n=82; farx(n+1)=9.009540e-001; foe(n+1)=3.045540e+001; krok(n+1)=8.635342e-001; ng(n+1)=2.615673e-002;
n=83; farx(n+1)=9.008792e-001; foe(n+1)=3.018034e+001; krok(n+1)=2.063035e-001; ng(n+1)=1.516972e-001;
n=84; farx(n+1)=9.008084e-001; foe(n+1)=3.012319e+001; krok(n+1)=1.201404e+000; ng(n+1)=4.810658e-001;
n=85; farx(n+1)=9.007723e-001; foe(n+1)=3.017246e+001; krok(n+1)=1.086288e+000; ng(n+1)=8.831499e-001;
n=86; farx(n+1)=9.007582e-001; foe(n+1)=3.008913e+001; krok(n+1)=1.092255e+000; ng(n+1)=2.153287e-001;
n=87; farx(n+1)=9.007475e-001; foe(n+1)=3.013487e+001; krok(n+1)=3.781569e+000; ng(n+1)=2.706223e-001;
n=88; farx(n+1)=9.007350e-001; foe(n+1)=3.006282e+001; krok(n+1)=1.779515e+000; ng(n+1)=5.270779e-001;
n=89; farx(n+1)=9.007289e-001; foe(n+1)=3.009992e+001; krok(n+1)=1.145447e+000; ng(n+1)=1.561633e-001;
n=90; farx(n+1)=9.007213e-001; foe(n+1)=3.003624e+001; krok(n+1)=2.608981e+000; ng(n+1)=1.546850e-001;
n=91; farx(n+1)=9.006902e-001; foe(n+1)=3.031674e+001; krok(n+1)=5.681335e+000; ng(n+1)=1.521657e-001;
n=92; farx(n+1)=9.006647e-001; foe(n+1)=3.017999e+001; krok(n+1)=9.512526e-001; ng(n+1)=4.334108e-001;
n=93; farx(n+1)=9.006492e-001; foe(n+1)=3.019433e+001; krok(n+1)=1.000860e+000; ng(n+1)=3.649651e-001;
n=94; farx(n+1)=9.006471e-001; foe(n+1)=3.022209e+001; krok(n+1)=1.342163e+000; ng(n+1)=1.107880e-001;
n=95; farx(n+1)=9.006463e-001; foe(n+1)=3.024979e+001; krok(n+1)=1.239464e+000; ng(n+1)=7.900568e-002;
n=96; farx(n+1)=9.006456e-001; foe(n+1)=3.020579e+001; krok(n+1)=3.202727e+000; ng(n+1)=9.329349e-002;
n=97; farx(n+1)=9.006445e-001; foe(n+1)=3.021676e+001; krok(n+1)=2.722905e+000; ng(n+1)=1.099971e-001;
n=98; farx(n+1)=9.006436e-001; foe(n+1)=3.023144e+001; krok(n+1)=1.854055e+000; ng(n+1)=1.051409e-001;
n=99; farx(n+1)=9.006434e-001; foe(n+1)=3.023930e+001; krok(n+1)=1.784434e+000; ng(n+1)=4.601077e-002;
n=100; farx(n+1)=9.006433e-001; foe(n+1)=3.023248e+001; krok(n+1)=2.344435e+000; ng(n+1)=8.445285e-003;
%odnowa zmiennej metryki
n=101; farx(n+1)=9.006433e-001; foe(n+1)=3.023211e+001; krok(n+1)=5.843669e-005; ng(n+1)=1.216172e-002;
n=102; farx(n+1)=9.006433e-001; foe(n+1)=3.023322e+001; krok(n+1)=1.625215e-004; ng(n+1)=5.066976e-003;
n=103; farx(n+1)=9.006433e-001; foe(n+1)=3.023591e+001; krok(n+1)=2.620821e-003; ng(n+1)=2.798334e-003;
n=104; farx(n+1)=9.006433e-001; foe(n+1)=3.023486e+001; krok(n+1)=2.600344e-003; ng(n+1)=1.544216e-003;
n=105; farx(n+1)=9.006433e-001; foe(n+1)=3.023629e+001; krok(n+1)=7.167584e-002; ng(n+1)=5.062899e-004;
n=106; farx(n+1)=9.006433e-001; foe(n+1)=3.023635e+001; krok(n+1)=8.100548e-002; ng(n+1)=2.008123e-004;
n=107; farx(n+1)=9.006433e-001; foe(n+1)=3.023540e+001; krok(n+1)=3.287969e-001; ng(n+1)=1.675438e-004;
n=108; farx(n+1)=9.006433e-001; foe(n+1)=3.023491e+001; krok(n+1)=1.017241e+000; ng(n+1)=1.911589e-004;
n=109; farx(n+1)=9.006433e-001; foe(n+1)=3.023418e+001; krok(n+1)=1.561580e+000; ng(n+1)=1.781477e-004;
n=110; farx(n+1)=9.006433e-001; foe(n+1)=3.023444e+001; krok(n+1)=2.127187e+000; ng(n+1)=9.336090e-005;
n=111; farx(n+1)=9.006433e-001; foe(n+1)=3.023444e+001; krok(n+1)=4.931731e-006; ng(n+1)=1.394390e-004;
n=112; farx(n+1)=9.006433e-001; foe(n+1)=3.023444e+001; krok(n+1)=7.150304e-006; ng(n+1)=1.394384e-004;
n=113; farx(n+1)=9.006433e-001; foe(n+1)=3.023444e+001; krok(n+1)=1.095376e-005; ng(n+1)=1.394369e-004;
n=114; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.015323e+000; ng(n+1)=1.394352e-004;
n=115; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=8.217907e-006; ng(n+1)=1.654238e-005;
n=116; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=3.433644e-006; ng(n+1)=1.654237e-005;
n=117; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.424230e-005; ng(n+1)=1.654230e-005;
n=118; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=3.296968e-005; ng(n+1)=1.654204e-005;
n=119; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=3.461382e-006; ng(n+1)=1.654143e-005;
n=120; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.259797e-005; ng(n+1)=1.654137e-005;
n=121; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.197415e-005; ng(n+1)=1.654113e-005;
n=122; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.225132e-007; ng(n+1)=1.654090e-005;
n=123; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.740770e-006; ng(n+1)=1.654090e-005;
n=124; farx(n+1)=9.006433e-001; foe(n+1)=3.023446e+001; krok(n+1)=1.197915e-008; ng(n+1)=1.654087e-005;
n=125; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=9.001093e-001; ng(n+1)=1.654086e-005;
%odnowa zmiennej metryki
n=126; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=1.205876e-005; ng(n+1)=2.504449e-005;
n=127; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=1.399818e-005; ng(n+1)=1.857069e-005;
n=128; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=1.790486e-005; ng(n+1)=1.857792e-005;
n=129; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=2.615184e-006; ng(n+1)=1.859382e-005;
n=130; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=2.208309e-006; ng(n+1)=1.859365e-005;
n=131; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=1.340616e-007; ng(n+1)=1.859340e-005;
n=132; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=4.934690e-012; ng(n+1)=1.859337e-005;
n=133; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=7.649542e-011; ng(n+1)=1.859337e-005;
n=134; farx(n+1)=9.006433e-001; foe(n+1)=3.023448e+001; krok(n+1)=2.691705e-012; ng(n+1)=1.859337e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
