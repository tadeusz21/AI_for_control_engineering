%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.831987e+003; foe(n+1)=2.838060e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.473559e+003; foe(n+1)=2.572268e+003; krok(n+1)=4.168272e-004; ng(n+1)=1.365752e+003;
n=2; farx(n+1)=1.271003e+003; foe(n+1)=5.999498e+003; krok(n+1)=8.931252e-004; ng(n+1)=2.057952e+003;
n=3; farx(n+1)=1.058239e+003; foe(n+1)=9.944390e+003; krok(n+1)=1.775639e-004; ng(n+1)=3.652769e+003;
n=4; farx(n+1)=1.040152e+003; foe(n+1)=1.010176e+004; krok(n+1)=9.053002e-004; ng(n+1)=2.675054e+003;
n=5; farx(n+1)=1.026678e+003; foe(n+1)=1.086985e+004; krok(n+1)=6.893113e-003; ng(n+1)=2.738712e+003;
n=6; farx(n+1)=8.908224e+001; foe(n+1)=6.924662e+002; krok(n+1)=9.001093e-001; ng(n+1)=2.698577e+003;
n=7; farx(n+1)=3.160177e+001; foe(n+1)=2.588440e+002; krok(n+1)=9.907791e-002; ng(n+1)=5.962236e+002;
n=8; farx(n+1)=1.528907e+001; foe(n+1)=7.926539e+003; krok(n+1)=5.168653e-001; ng(n+1)=3.132136e+002;
n=9; farx(n+1)=1.341416e+001; foe(n+1)=5.431011e+003; krok(n+1)=8.771846e-001; ng(n+1)=1.438143e+002;
n=10; farx(n+1)=1.263261e+001; foe(n+1)=2.728718e+002; krok(n+1)=9.595898e-001; ng(n+1)=7.444268e+001;
n=11; farx(n+1)=1.187650e+001; foe(n+1)=4.588696e+002; krok(n+1)=1.435731e+000; ng(n+1)=5.245086e+001;
n=12; farx(n+1)=7.980683e+000; foe(n+1)=3.573158e+002; krok(n+1)=7.324188e+000; ng(n+1)=6.086894e+001;
n=13; farx(n+1)=6.241983e+000; foe(n+1)=1.130220e+002; krok(n+1)=1.285650e+000; ng(n+1)=1.195187e+002;
n=14; farx(n+1)=5.021779e+000; foe(n+1)=1.693421e+002; krok(n+1)=1.065469e+000; ng(n+1)=5.491897e+001;
n=15; farx(n+1)=4.520509e+000; foe(n+1)=3.069602e+002; krok(n+1)=3.963116e-001; ng(n+1)=1.144509e+002;
n=16; farx(n+1)=3.864059e+000; foe(n+1)=2.875354e+002; krok(n+1)=8.536620e-001; ng(n+1)=1.752747e+001;
n=17; farx(n+1)=3.341420e+000; foe(n+1)=1.296418e+002; krok(n+1)=1.250551e+000; ng(n+1)=9.254126e+001;
n=18; farx(n+1)=3.077266e+000; foe(n+1)=1.452630e+002; krok(n+1)=8.670260e-001; ng(n+1)=9.846732e+001;
n=19; farx(n+1)=2.693647e+000; foe(n+1)=2.061321e+002; krok(n+1)=7.610808e-001; ng(n+1)=2.185581e+001;
n=20; farx(n+1)=2.533243e+000; foe(n+1)=2.038588e+002; krok(n+1)=8.620454e-001; ng(n+1)=5.244834e+001;
n=21; farx(n+1)=2.369051e+000; foe(n+1)=2.082418e+002; krok(n+1)=8.704303e-001; ng(n+1)=9.512298e+001;
n=22; farx(n+1)=2.190130e+000; foe(n+1)=1.645704e+002; krok(n+1)=6.477968e-001; ng(n+1)=3.322212e+001;
n=23; farx(n+1)=2.097219e+000; foe(n+1)=1.441943e+002; krok(n+1)=3.180725e-001; ng(n+1)=6.734264e+001;
n=24; farx(n+1)=1.993737e+000; foe(n+1)=1.911341e+002; krok(n+1)=8.576098e-001; ng(n+1)=8.281558e+001;
n=25; farx(n+1)=1.883402e+000; foe(n+1)=1.772354e+002; krok(n+1)=1.073054e+000; ng(n+1)=2.256362e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.854205e+000; foe(n+1)=1.917263e+002; krok(n+1)=7.999634e-005; ng(n+1)=4.965006e+001;
n=27; farx(n+1)=1.850020e+000; foe(n+1)=1.956854e+002; krok(n+1)=5.007398e-005; ng(n+1)=2.045612e+001;
n=28; farx(n+1)=1.817810e+000; foe(n+1)=1.400781e+002; krok(n+1)=4.664313e-003; ng(n+1)=5.444231e+000;
n=29; farx(n+1)=1.671780e+000; foe(n+1)=1.549370e+002; krok(n+1)=4.809146e-003; ng(n+1)=1.247860e+001;
n=30; farx(n+1)=1.647483e+000; foe(n+1)=1.463657e+002; krok(n+1)=8.035594e-002; ng(n+1)=1.496830e+001;
n=31; farx(n+1)=1.637350e+000; foe(n+1)=1.433268e+002; krok(n+1)=3.750153e-002; ng(n+1)=3.700027e+001;
n=32; farx(n+1)=1.583786e+000; foe(n+1)=1.278860e+002; krok(n+1)=9.576737e-001; ng(n+1)=4.822846e+001;
n=33; farx(n+1)=1.542704e+000; foe(n+1)=1.652598e+002; krok(n+1)=4.635137e-001; ng(n+1)=5.239244e+001;
n=34; farx(n+1)=1.484992e+000; foe(n+1)=1.507801e+002; krok(n+1)=1.110293e+000; ng(n+1)=4.974442e+001;
n=35; farx(n+1)=1.461755e+000; foe(n+1)=1.315878e+002; krok(n+1)=3.057702e-001; ng(n+1)=3.154245e+001;
n=36; farx(n+1)=1.439923e+000; foe(n+1)=1.145882e+002; krok(n+1)=5.421555e-001; ng(n+1)=2.332512e+001;
n=37; farx(n+1)=1.412827e+000; foe(n+1)=1.428009e+002; krok(n+1)=1.800219e+000; ng(n+1)=4.402695e+001;
n=38; farx(n+1)=1.390165e+000; foe(n+1)=1.321511e+002; krok(n+1)=6.639102e-001; ng(n+1)=3.022800e+001;
n=39; farx(n+1)=1.375798e+000; foe(n+1)=1.211497e+002; krok(n+1)=8.707243e-001; ng(n+1)=4.153213e+001;
n=40; farx(n+1)=1.356712e+000; foe(n+1)=1.020774e+002; krok(n+1)=1.598536e+000; ng(n+1)=2.261318e+001;
n=41; farx(n+1)=1.345288e+000; foe(n+1)=1.242467e+002; krok(n+1)=9.180501e-001; ng(n+1)=2.686079e+001;
n=42; farx(n+1)=1.331442e+000; foe(n+1)=1.281749e+002; krok(n+1)=3.167854e-001; ng(n+1)=1.415615e+001;
n=43; farx(n+1)=1.325423e+000; foe(n+1)=1.096739e+002; krok(n+1)=7.638023e-001; ng(n+1)=2.881020e+001;
n=44; farx(n+1)=1.319371e+000; foe(n+1)=1.038297e+002; krok(n+1)=9.205345e-001; ng(n+1)=3.264094e+001;
n=45; farx(n+1)=1.309602e+000; foe(n+1)=9.763186e+001; krok(n+1)=1.164353e+000; ng(n+1)=6.244368e+000;
n=46; farx(n+1)=1.302281e+000; foe(n+1)=1.153668e+002; krok(n+1)=1.561580e+000; ng(n+1)=2.336232e+001;
n=47; farx(n+1)=1.298497e+000; foe(n+1)=1.204915e+002; krok(n+1)=6.710813e-001; ng(n+1)=2.293951e+001;
n=48; farx(n+1)=1.294379e+000; foe(n+1)=1.059648e+002; krok(n+1)=5.738785e-001; ng(n+1)=9.772378e+000;
n=49; farx(n+1)=1.290905e+000; foe(n+1)=9.519533e+001; krok(n+1)=6.400584e-001; ng(n+1)=2.553869e+001;
n=50; farx(n+1)=1.286901e+000; foe(n+1)=9.869685e+001; krok(n+1)=2.144998e+000; ng(n+1)=1.492252e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.286597e+000; foe(n+1)=9.917975e+001; krok(n+1)=1.549259e-005; ng(n+1)=9.945222e+000;
n=52; farx(n+1)=1.286573e+000; foe(n+1)=1.004187e+002; krok(n+1)=3.831728e-004; ng(n+1)=4.915186e-001;
n=53; farx(n+1)=1.286563e+000; foe(n+1)=1.010860e+002; krok(n+1)=6.880069e-005; ng(n+1)=7.834146e-001;
n=54; farx(n+1)=1.286132e+000; foe(n+1)=1.012326e+002; krok(n+1)=1.025657e-002; ng(n+1)=4.423929e-001;
n=55; farx(n+1)=1.285273e+000; foe(n+1)=1.026782e+002; krok(n+1)=4.134280e-002; ng(n+1)=3.195694e-001;
n=56; farx(n+1)=1.284439e+000; foe(n+1)=1.007040e+002; krok(n+1)=6.340524e-001; ng(n+1)=7.420149e-002;
n=57; farx(n+1)=1.282736e+000; foe(n+1)=9.690620e+001; krok(n+1)=3.636509e-001; ng(n+1)=2.514481e+000;
n=58; farx(n+1)=1.281121e+000; foe(n+1)=9.862453e+001; krok(n+1)=1.242110e+000; ng(n+1)=1.503929e+001;
n=59; farx(n+1)=1.279058e+000; foe(n+1)=9.714938e+001; krok(n+1)=2.262924e+000; ng(n+1)=1.468642e+001;
n=60; farx(n+1)=1.278615e+000; foe(n+1)=9.509903e+001; krok(n+1)=3.075863e-001; ng(n+1)=8.360814e+000;
n=61; farx(n+1)=1.277859e+000; foe(n+1)=9.601505e+001; krok(n+1)=6.871474e-001; ng(n+1)=8.202878e+000;
n=62; farx(n+1)=1.277134e+000; foe(n+1)=9.752501e+001; krok(n+1)=2.315580e+000; ng(n+1)=9.062875e+000;
n=63; farx(n+1)=1.276529e+000; foe(n+1)=9.458619e+001; krok(n+1)=5.114232e-001; ng(n+1)=4.537278e+000;
n=64; farx(n+1)=1.276374e+000; foe(n+1)=9.377406e+001; krok(n+1)=1.033731e+000; ng(n+1)=4.508618e+000;
n=65; farx(n+1)=1.276189e+000; foe(n+1)=9.460810e+001; krok(n+1)=1.031099e+000; ng(n+1)=6.841613e+000;
n=66; farx(n+1)=1.275993e+000; foe(n+1)=9.342820e+001; krok(n+1)=1.080767e+000; ng(n+1)=2.006287e+000;
n=67; farx(n+1)=1.275920e+000; foe(n+1)=9.370118e+001; krok(n+1)=1.296088e+000; ng(n+1)=2.748477e+000;
n=68; farx(n+1)=1.275872e+000; foe(n+1)=9.380494e+001; krok(n+1)=1.485218e+000; ng(n+1)=3.141017e+000;
n=69; farx(n+1)=1.275848e+000; foe(n+1)=9.318251e+001; krok(n+1)=5.134806e-001; ng(n+1)=1.065332e+000;
n=70; farx(n+1)=1.275837e+000; foe(n+1)=9.334514e+001; krok(n+1)=1.527771e+000; ng(n+1)=6.430201e-001;
n=71; farx(n+1)=1.275828e+000; foe(n+1)=9.341117e+001; krok(n+1)=2.055430e+000; ng(n+1)=1.489604e+000;
n=72; farx(n+1)=1.275825e+000; foe(n+1)=9.322560e+001; krok(n+1)=1.263598e+000; ng(n+1)=5.147440e-001;
n=73; farx(n+1)=1.275823e+000; foe(n+1)=9.335683e+001; krok(n+1)=1.374295e+000; ng(n+1)=1.299114e-001;
n=74; farx(n+1)=1.275822e+000; foe(n+1)=9.341358e+001; krok(n+1)=1.691553e+000; ng(n+1)=3.250854e-001;
n=75; farx(n+1)=1.275822e+000; foe(n+1)=9.338615e+001; krok(n+1)=9.943696e-001; ng(n+1)=5.390617e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275822e+000; foe(n+1)=9.338638e+001; krok(n+1)=1.506473e-005; ng(n+1)=4.992556e-003;
n=77; farx(n+1)=1.275822e+000; foe(n+1)=9.339034e+001; krok(n+1)=1.445012e-004; ng(n+1)=2.320278e-003;
n=78; farx(n+1)=1.275822e+000; foe(n+1)=9.339132e+001; krok(n+1)=4.425468e-005; ng(n+1)=2.160215e-003;
n=79; farx(n+1)=1.275822e+000; foe(n+1)=9.339136e+001; krok(n+1)=1.050315e-002; ng(n+1)=1.698748e-004;
n=80; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=4.647370e-002; ng(n+1)=1.144424e-004;
n=81; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=1.395478e-005; ng(n+1)=2.015814e-005;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=7.204914e-006; ng(n+1)=2.015732e-005;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=1.822109e-006; ng(n+1)=2.015717e-005;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=3.219208e-007; ng(n+1)=2.015713e-005;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=6.082845e-009; ng(n+1)=2.015713e-005;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=3.246032e-010; ng(n+1)=2.015713e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=2.907187e-007; ng(n+1)=2.015713e-005;
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=1.158512e-004; ng(n+1)=2.001677e-005;
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339102e+001; krok(n+1)=3.604935e-004; ng(n+1)=8.124528e-005;
n=90; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=1.266750e-002; ng(n+1)=8.417784e-005;
n=91; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=3.575152e-006; ng(n+1)=4.114822e-005;
n=92; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=1.808260e-005; ng(n+1)=4.114497e-005;
n=93; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=3.009506e-005; ng(n+1)=4.114491e-005;
n=94; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=8.199957e-006; ng(n+1)=4.114363e-005;
n=95; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=1.679704e-008; ng(n+1)=4.114319e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
