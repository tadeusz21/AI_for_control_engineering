%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.828845e+003; foe(n+1)=2.837049e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.529680e+003; foe(n+1)=2.603028e+003; krok(n+1)=3.933588e-004; ng(n+1)=1.439871e+003;
n=2; farx(n+1)=1.072395e+003; foe(n+1)=6.734373e+003; krok(n+1)=1.621288e-003; ng(n+1)=1.388788e+003;
n=3; farx(n+1)=9.339209e+002; foe(n+1)=9.340637e+003; krok(n+1)=3.210907e-004; ng(n+1)=3.073584e+003;
n=4; farx(n+1)=9.238195e+002; foe(n+1)=8.778622e+003; krok(n+1)=3.128460e-003; ng(n+1)=2.275636e+003;
n=5; farx(n+1)=9.098817e+002; foe(n+1)=9.211043e+003; krok(n+1)=5.711090e-003; ng(n+1)=2.229549e+003;
n=6; farx(n+1)=1.305987e+002; foe(n+1)=7.331010e+002; krok(n+1)=1.075645e+000; ng(n+1)=2.235205e+003;
n=7; farx(n+1)=4.075534e+001; foe(n+1)=2.439665e+002; krok(n+1)=1.775417e-001; ng(n+1)=6.253145e+002;
n=8; farx(n+1)=2.333877e+001; foe(n+1)=2.362162e+002; krok(n+1)=9.760941e-002; ng(n+1)=3.952088e+002;
n=9; farx(n+1)=1.448817e+001; foe(n+1)=7.635876e+003; krok(n+1)=2.866206e-001; ng(n+1)=3.302266e+002;
n=10; farx(n+1)=1.150141e+001; foe(n+1)=1.815856e+002; krok(n+1)=8.728449e-001; ng(n+1)=1.938982e+002;
n=11; farx(n+1)=1.044526e+001; foe(n+1)=4.075508e+002; krok(n+1)=1.814761e+000; ng(n+1)=7.738877e+001;
n=12; farx(n+1)=8.248794e+000; foe(n+1)=2.390730e+002; krok(n+1)=7.774793e+000; ng(n+1)=6.388506e+001;
n=13; farx(n+1)=7.555253e+000; foe(n+1)=2.301416e+002; krok(n+1)=1.127230e+000; ng(n+1)=3.440407e+001;
n=14; farx(n+1)=7.192800e+000; foe(n+1)=2.237905e+002; krok(n+1)=9.180501e-001; ng(n+1)=9.165027e+001;
n=15; farx(n+1)=6.059360e+000; foe(n+1)=2.089333e+002; krok(n+1)=2.306654e+000; ng(n+1)=5.149591e+001;
n=16; farx(n+1)=4.751098e+000; foe(n+1)=2.129772e+002; krok(n+1)=1.285650e+000; ng(n+1)=1.064234e+002;
n=17; farx(n+1)=4.167000e+000; foe(n+1)=2.294220e+002; krok(n+1)=5.422916e-001; ng(n+1)=1.135535e+002;
n=18; farx(n+1)=3.150476e+000; foe(n+1)=1.625774e+002; krok(n+1)=7.271671e-001; ng(n+1)=7.297967e+001;
n=19; farx(n+1)=2.869680e+000; foe(n+1)=1.880935e+002; krok(n+1)=9.843026e-001; ng(n+1)=7.882003e+001;
n=20; farx(n+1)=2.474271e+000; foe(n+1)=2.335244e+002; krok(n+1)=8.551938e-001; ng(n+1)=7.338406e+001;
n=21; farx(n+1)=2.281554e+000; foe(n+1)=1.998940e+002; krok(n+1)=3.635836e-001; ng(n+1)=7.259731e+001;
n=22; farx(n+1)=2.203928e+000; foe(n+1)=1.448656e+002; krok(n+1)=4.020096e-001; ng(n+1)=3.726525e+001;
n=23; farx(n+1)=2.068875e+000; foe(n+1)=1.897460e+002; krok(n+1)=1.033731e+000; ng(n+1)=3.490609e+001;
n=24; farx(n+1)=2.008756e+000; foe(n+1)=1.877328e+002; krok(n+1)=9.429061e-001; ng(n+1)=6.550055e+001;
n=25; farx(n+1)=1.943446e+000; foe(n+1)=2.575718e+002; krok(n+1)=1.454334e+000; ng(n+1)=1.234891e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.936770e+000; foe(n+1)=2.658942e+002; krok(n+1)=5.575933e-005; ng(n+1)=2.514694e+001;
n=27; farx(n+1)=1.934836e+000; foe(n+1)=2.575891e+002; krok(n+1)=1.304191e-004; ng(n+1)=8.202778e+000;
n=28; farx(n+1)=1.922412e+000; foe(n+1)=2.036027e+002; krok(n+1)=1.810600e-003; ng(n+1)=5.746574e+000;
n=29; farx(n+1)=1.820327e+000; foe(n+1)=1.948055e+002; krok(n+1)=1.059400e-002; ng(n+1)=7.802837e+000;
n=30; farx(n+1)=1.740924e+000; foe(n+1)=1.618484e+002; krok(n+1)=8.373214e-002; ng(n+1)=2.158945e+001;
n=31; farx(n+1)=1.732268e+000; foe(n+1)=1.614256e+002; krok(n+1)=8.061847e-002; ng(n+1)=8.409697e+001;
n=32; farx(n+1)=1.687907e+000; foe(n+1)=1.330947e+002; krok(n+1)=1.845727e-001; ng(n+1)=8.725748e+001;
n=33; farx(n+1)=1.643016e+000; foe(n+1)=1.417185e+002; krok(n+1)=3.923690e-001; ng(n+1)=4.922506e+001;
n=34; farx(n+1)=1.563949e+000; foe(n+1)=1.756427e+002; krok(n+1)=1.168297e+000; ng(n+1)=5.612917e+001;
n=35; farx(n+1)=1.517472e+000; foe(n+1)=1.513487e+002; krok(n+1)=4.337210e-001; ng(n+1)=2.498018e+001;
n=36; farx(n+1)=1.489106e+000; foe(n+1)=1.247999e+002; krok(n+1)=8.707243e-001; ng(n+1)=4.130323e+001;
n=37; farx(n+1)=1.464480e+000; foe(n+1)=1.250127e+002; krok(n+1)=8.457767e-001; ng(n+1)=5.586624e+001;
n=38; farx(n+1)=1.425074e+000; foe(n+1)=1.225585e+002; krok(n+1)=1.618997e+000; ng(n+1)=1.374271e+001;
n=39; farx(n+1)=1.401813e+000; foe(n+1)=1.328000e+002; krok(n+1)=9.959478e-001; ng(n+1)=4.476178e+001;
n=40; farx(n+1)=1.382658e+000; foe(n+1)=1.346423e+002; krok(n+1)=9.145402e-001; ng(n+1)=2.309437e+001;
n=41; farx(n+1)=1.370932e+000; foe(n+1)=1.184039e+002; krok(n+1)=4.756263e-001; ng(n+1)=2.637674e+001;
n=42; farx(n+1)=1.353496e+000; foe(n+1)=1.127689e+002; krok(n+1)=5.341966e-001; ng(n+1)=4.636132e+001;
n=43; farx(n+1)=1.338903e+000; foe(n+1)=1.139754e+002; krok(n+1)=1.545005e+000; ng(n+1)=1.634580e+001;
n=44; farx(n+1)=1.327078e+000; foe(n+1)=1.248884e+002; krok(n+1)=7.748658e-001; ng(n+1)=3.702848e+001;
n=45; farx(n+1)=1.318768e+000; foe(n+1)=1.067231e+002; krok(n+1)=7.571876e-001; ng(n+1)=7.187421e+000;
n=46; farx(n+1)=1.310403e+000; foe(n+1)=1.045589e+002; krok(n+1)=1.177790e+000; ng(n+1)=2.372177e+001;
n=47; farx(n+1)=1.306495e+000; foe(n+1)=1.086421e+002; krok(n+1)=7.832156e-001; ng(n+1)=2.671752e+001;
n=48; farx(n+1)=1.299608e+000; foe(n+1)=1.066188e+002; krok(n+1)=9.603842e-001; ng(n+1)=6.235501e+000;
n=49; farx(n+1)=1.296316e+000; foe(n+1)=1.018547e+002; krok(n+1)=5.461800e-001; ng(n+1)=2.499208e+001;
n=50; farx(n+1)=1.293345e+000; foe(n+1)=1.077478e+002; krok(n+1)=8.847528e-001; ng(n+1)=2.458397e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.293121e+000; foe(n+1)=1.079574e+002; krok(n+1)=2.352777e-005; ng(n+1)=6.004420e+000;
n=52; farx(n+1)=1.293062e+000; foe(n+1)=1.085548e+002; krok(n+1)=3.079431e-005; ng(n+1)=3.439024e+000;
n=53; farx(n+1)=1.292938e+000; foe(n+1)=1.045990e+002; krok(n+1)=8.816889e-003; ng(n+1)=2.851082e-001;
n=54; farx(n+1)=1.292083e+000; foe(n+1)=1.062829e+002; krok(n+1)=2.813867e-003; ng(n+1)=1.261854e+000;
n=55; farx(n+1)=1.291721e+000; foe(n+1)=1.048601e+002; krok(n+1)=1.450364e-002; ng(n+1)=3.439162e-001;
n=56; farx(n+1)=1.289012e+000; foe(n+1)=1.013594e+002; krok(n+1)=8.892951e-001; ng(n+1)=2.878111e-001;
n=57; farx(n+1)=1.287623e+000; foe(n+1)=9.805981e+001; krok(n+1)=1.655202e-001; ng(n+1)=1.072741e+001;
n=58; farx(n+1)=1.285187e+000; foe(n+1)=1.023612e+002; krok(n+1)=1.324463e+000; ng(n+1)=2.051390e+001;
n=59; farx(n+1)=1.282371e+000; foe(n+1)=9.762098e+001; krok(n+1)=1.229131e+000; ng(n+1)=1.010524e+001;
n=60; farx(n+1)=1.281221e+000; foe(n+1)=9.840007e+001; krok(n+1)=8.224396e-001; ng(n+1)=1.499779e+001;
n=61; farx(n+1)=1.279527e+000; foe(n+1)=9.546733e+001; krok(n+1)=1.004829e+000; ng(n+1)=6.317725e+000;
n=62; farx(n+1)=1.278884e+000; foe(n+1)=9.781416e+001; krok(n+1)=5.166865e-001; ng(n+1)=1.274053e+001;
n=63; farx(n+1)=1.277764e+000; foe(n+1)=9.507995e+001; krok(n+1)=1.601772e+000; ng(n+1)=9.462101e+000;
n=64; farx(n+1)=1.277328e+000; foe(n+1)=9.579933e+001; krok(n+1)=5.446764e-001; ng(n+1)=1.065438e+001;
n=65; farx(n+1)=1.276700e+000; foe(n+1)=9.374896e+001; krok(n+1)=1.304490e+000; ng(n+1)=3.102963e+000;
n=66; farx(n+1)=1.276444e+000; foe(n+1)=9.518668e+001; krok(n+1)=8.535981e-001; ng(n+1)=7.203913e+000;
n=67; farx(n+1)=1.276182e+000; foe(n+1)=9.396207e+001; krok(n+1)=1.056270e+000; ng(n+1)=5.113544e+000;
n=68; farx(n+1)=1.276044e+000; foe(n+1)=9.404467e+001; krok(n+1)=7.228765e-001; ng(n+1)=6.346092e+000;
n=69; farx(n+1)=1.275931e+000; foe(n+1)=9.307271e+001; krok(n+1)=1.221873e+000; ng(n+1)=1.272182e+000;
n=70; farx(n+1)=1.275876e+000; foe(n+1)=9.373969e+001; krok(n+1)=8.838889e-001; ng(n+1)=3.234520e+000;
n=71; farx(n+1)=1.275842e+000; foe(n+1)=9.338487e+001; krok(n+1)=1.202875e+000; ng(n+1)=1.752116e+000;
n=72; farx(n+1)=1.275830e+000; foe(n+1)=9.340223e+001; krok(n+1)=9.727120e-001; ng(n+1)=2.083466e+000;
n=73; farx(n+1)=1.275825e+000; foe(n+1)=9.322811e+001; krok(n+1)=1.196104e+000; ng(n+1)=1.124256e-001;
n=74; farx(n+1)=1.275824e+000; foe(n+1)=9.336292e+001; krok(n+1)=1.222664e+000; ng(n+1)=3.475960e-001;
n=75; farx(n+1)=1.275824e+000; foe(n+1)=9.330368e+001; krok(n+1)=2.909207e+000; ng(n+1)=2.296273e-001;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275824e+000; foe(n+1)=9.329308e+001; krok(n+1)=2.860122e-005; ng(n+1)=7.469402e-002;
n=77; farx(n+1)=1.275824e+000; foe(n+1)=9.329234e+001; krok(n+1)=1.386876e-005; ng(n+1)=3.226644e-002;
n=78; farx(n+1)=1.275823e+000; foe(n+1)=9.323623e+001; krok(n+1)=4.862884e-003; ng(n+1)=5.277682e-003;
n=79; farx(n+1)=1.275823e+000; foe(n+1)=9.330286e+001; krok(n+1)=5.548179e-003; ng(n+1)=2.387624e-002;
n=80; farx(n+1)=1.275822e+000; foe(n+1)=9.333340e+001; krok(n+1)=1.290032e-002; ng(n+1)=1.079824e-002;
n=81; farx(n+1)=1.275822e+000; foe(n+1)=9.334688e+001; krok(n+1)=7.384818e-002; ng(n+1)=2.196080e-003;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.337748e+001; krok(n+1)=1.835677e+001; ng(n+1)=1.145614e-003;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339054e+001; krok(n+1)=1.056270e+000; ng(n+1)=5.218468e-003;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339054e+001; krok(n+1)=1.434805e-005; ng(n+1)=1.388879e-003;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339054e+001; krok(n+1)=1.185899e-005; ng(n+1)=1.388860e-003;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.339054e+001; krok(n+1)=8.718949e-006; ng(n+1)=1.388843e-003;
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.339054e+001; krok(n+1)=1.561375e-005; ng(n+1)=1.388831e-003;
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339054e+001; krok(n+1)=5.210339e-005; ng(n+1)=1.388809e-003;
 % z³y kierunek w metodzie zm - odnowa 
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339070e+001; krok(n+1)=2.221555e-005; ng(n+1)=1.388737e-003;
n=90; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=1.758215e-005; ng(n+1)=6.569923e-004;
n=91; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=2.521858e-004; ng(n+1)=5.470325e-005;
n=92; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=4.623340e-005; ng(n+1)=2.540632e-005;
n=93; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=1.558901e-005; ng(n+1)=2.534896e-005;
n=94; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=4.915977e-006; ng(n+1)=2.534859e-005;
n=95; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=9.460497e-007; ng(n+1)=2.534838e-005;
n=96; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=1.577103e-007; ng(n+1)=2.534834e-005;
n=97; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=2.068159e-006; ng(n+1)=2.534833e-005;
n=98; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=1.408178e-006; ng(n+1)=2.534827e-005;
n=99; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=1.086355e-006; ng(n+1)=2.534823e-005;
n=100; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=1.801229e-006; ng(n+1)=2.534821e-005;
%odnowa zmiennej metryki
n=101; farx(n+1)=1.275822e+000; foe(n+1)=9.339087e+001; krok(n+1)=8.235671e-006; ng(n+1)=2.534815e-005;
n=102; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=1.138851e-003; ng(n+1)=1.431645e-005;
n=103; farx(n+1)=1.275822e+000; foe(n+1)=9.339083e+001; krok(n+1)=1.158512e-004; ng(n+1)=7.895622e-005;
n=104; farx(n+1)=1.275822e+000; foe(n+1)=9.339086e+001; krok(n+1)=2.295689e-004; ng(n+1)=2.552672e-005;
n=105; farx(n+1)=1.275822e+000; foe(n+1)=9.339086e+001; krok(n+1)=3.270831e-006; ng(n+1)=1.669175e-005;
n=106; farx(n+1)=1.275822e+000; foe(n+1)=9.339086e+001; krok(n+1)=1.117235e-007; ng(n+1)=1.669169e-005;
n=107; farx(n+1)=1.275822e+000; foe(n+1)=9.339086e+001; krok(n+1)=8.690837e-006; ng(n+1)=1.669169e-005;
n=108; farx(n+1)=1.275822e+000; foe(n+1)=9.339086e+001; krok(n+1)=4.755015e-008; ng(n+1)=1.669140e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
