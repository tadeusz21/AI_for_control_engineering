%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.828809e+003; foe(n+1)=2.840914e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.478991e+003; foe(n+1)=2.599998e+003; krok(n+1)=4.220039e-004; ng(n+1)=1.384895e+003;
n=2; farx(n+1)=1.254123e+003; foe(n+1)=6.253606e+003; krok(n+1)=9.413494e-004; ng(n+1)=1.953515e+003;
n=3; farx(n+1)=1.050479e+003; foe(n+1)=1.017404e+004; krok(n+1)=2.178264e-004; ng(n+1)=3.604630e+003;
n=4; farx(n+1)=1.038958e+003; foe(n+1)=1.015760e+004; krok(n+1)=9.349870e-004; ng(n+1)=2.725063e+003;
n=5; farx(n+1)=1.026461e+003; foe(n+1)=1.080365e+004; krok(n+1)=7.632150e-003; ng(n+1)=2.748336e+003;
n=6; farx(n+1)=6.880638e+001; foe(n+1)=4.644851e+002; krok(n+1)=7.704536e-001; ng(n+1)=2.729975e+003;
n=7; farx(n+1)=3.385337e+001; foe(n+1)=2.457099e+002; krok(n+1)=6.900644e-002; ng(n+1)=4.761635e+002;
n=8; farx(n+1)=1.438061e+001; foe(n+1)=8.256025e+003; krok(n+1)=4.004429e-001; ng(n+1)=2.212663e+002;
n=9; farx(n+1)=1.230693e+001; foe(n+1)=8.119654e+003; krok(n+1)=4.915350e-001; ng(n+1)=2.104011e+002;
n=10; farx(n+1)=1.095412e+001; foe(n+1)=2.030183e+002; krok(n+1)=8.256204e-001; ng(n+1)=6.037546e+001;
n=11; farx(n+1)=1.011925e+001; foe(n+1)=3.927718e+002; krok(n+1)=1.829120e+000; ng(n+1)=5.974269e+001;
n=12; farx(n+1)=7.541554e+000; foe(n+1)=3.360223e+002; krok(n+1)=5.484439e+000; ng(n+1)=4.051724e+001;
n=13; farx(n+1)=6.284411e+000; foe(n+1)=1.519019e+002; krok(n+1)=1.856466e+000; ng(n+1)=7.802594e+001;
n=14; farx(n+1)=5.562479e+000; foe(n+1)=2.607525e+002; krok(n+1)=9.282331e-001; ng(n+1)=3.832584e+001;
n=15; farx(n+1)=4.964068e+000; foe(n+1)=5.819576e+002; krok(n+1)=7.426091e-001; ng(n+1)=7.840676e+001;
n=16; farx(n+1)=4.395746e+000; foe(n+1)=6.205404e+002; krok(n+1)=8.289013e-001; ng(n+1)=3.449762e+001;
n=17; farx(n+1)=3.808600e+000; foe(n+1)=1.980656e+002; krok(n+1)=9.576737e-001; ng(n+1)=7.187425e+001;
n=18; farx(n+1)=3.286438e+000; foe(n+1)=2.160483e+002; krok(n+1)=1.339714e+000; ng(n+1)=4.706996e+001;
n=19; farx(n+1)=2.966355e+000; foe(n+1)=3.271733e+002; krok(n+1)=4.228235e-001; ng(n+1)=9.308894e+001;
n=20; farx(n+1)=2.522140e+000; foe(n+1)=3.903654e+002; krok(n+1)=7.771907e-001; ng(n+1)=3.278485e+001;
n=21; farx(n+1)=2.294573e+000; foe(n+1)=1.970296e+002; krok(n+1)=1.003200e+000; ng(n+1)=6.969588e+001;
n=22; farx(n+1)=2.146797e+000; foe(n+1)=1.570582e+002; krok(n+1)=6.614848e-001; ng(n+1)=8.805738e+001;
n=23; farx(n+1)=1.895356e+000; foe(n+1)=1.581825e+002; krok(n+1)=1.047159e+000; ng(n+1)=2.950657e+001;
n=24; farx(n+1)=1.788534e+000; foe(n+1)=2.435663e+002; krok(n+1)=6.524460e-001; ng(n+1)=4.637861e+001;
n=25; farx(n+1)=1.742886e+000; foe(n+1)=2.049719e+002; krok(n+1)=3.057702e-001; ng(n+1)=2.909286e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=1.712233e+000; foe(n+1)=2.378048e+002; krok(n+1)=4.554170e-005; ng(n+1)=5.865770e+001;
n=27; farx(n+1)=1.707109e+000; foe(n+1)=2.298354e+002; krok(n+1)=7.879664e-005; ng(n+1)=1.717144e+001;
n=28; farx(n+1)=1.704151e+000; foe(n+1)=1.964269e+002; krok(n+1)=1.078226e-003; ng(n+1)=4.048413e+000;
n=29; farx(n+1)=1.658190e+000; foe(n+1)=1.893814e+002; krok(n+1)=3.252259e-002; ng(n+1)=2.715582e+000;
n=30; farx(n+1)=1.594432e+000; foe(n+1)=1.611391e+002; krok(n+1)=7.340057e-002; ng(n+1)=9.679788e+000;
n=31; farx(n+1)=1.576915e+000; foe(n+1)=1.398159e+002; krok(n+1)=3.094863e-002; ng(n+1)=6.454651e+001;
n=32; farx(n+1)=1.556925e+000; foe(n+1)=1.302208e+002; krok(n+1)=3.885953e-001; ng(n+1)=7.525188e+001;
n=33; farx(n+1)=1.515470e+000; foe(n+1)=1.338819e+002; krok(n+1)=5.312625e-001; ng(n+1)=3.981694e+001;
n=34; farx(n+1)=1.450113e+000; foe(n+1)=1.449086e+002; krok(n+1)=1.885812e+000; ng(n+1)=3.918396e+001;
n=35; farx(n+1)=1.413964e+000; foe(n+1)=1.332025e+002; krok(n+1)=1.514306e+000; ng(n+1)=4.304973e+001;
n=36; farx(n+1)=1.398608e+000; foe(n+1)=1.152398e+002; krok(n+1)=4.787134e-001; ng(n+1)=1.860973e+001;
n=37; farx(n+1)=1.379174e+000; foe(n+1)=1.166526e+002; krok(n+1)=2.921091e-001; ng(n+1)=4.112264e+001;
n=38; farx(n+1)=1.360557e+000; foe(n+1)=1.169517e+002; krok(n+1)=1.083912e+000; ng(n+1)=2.023362e+001;
n=39; farx(n+1)=1.347893e+000; foe(n+1)=1.258542e+002; krok(n+1)=6.564205e-001; ng(n+1)=3.909180e+001;
n=40; farx(n+1)=1.335017e+000; foe(n+1)=1.098016e+002; krok(n+1)=1.062525e+000; ng(n+1)=1.286157e+001;
n=41; farx(n+1)=1.325637e+000; foe(n+1)=1.143763e+002; krok(n+1)=9.145602e-001; ng(n+1)=3.016980e+001;
n=42; farx(n+1)=1.318468e+000; foe(n+1)=1.065530e+002; krok(n+1)=6.335709e-001; ng(n+1)=2.283981e+001;
n=43; farx(n+1)=1.311894e+000; foe(n+1)=1.089421e+002; krok(n+1)=8.131859e-001; ng(n+1)=2.666883e+001;
n=44; farx(n+1)=1.306436e+000; foe(n+1)=1.057075e+002; krok(n+1)=6.022096e-001; ng(n+1)=1.370321e+001;
n=45; farx(n+1)=1.300670e+000; foe(n+1)=1.121392e+002; krok(n+1)=1.147298e+000; ng(n+1)=2.314780e+001;
n=46; farx(n+1)=1.296537e+000; foe(n+1)=1.021924e+002; krok(n+1)=8.535981e-001; ng(n+1)=1.589491e+001;
n=47; farx(n+1)=1.292116e+000; foe(n+1)=1.012992e+002; krok(n+1)=8.612093e-001; ng(n+1)=2.546521e+001;
n=48; farx(n+1)=1.289257e+000; foe(n+1)=9.931846e+001; krok(n+1)=8.745977e-001; ng(n+1)=6.139723e+000;
n=49; farx(n+1)=1.285880e+000; foe(n+1)=1.036545e+002; krok(n+1)=1.219142e+000; ng(n+1)=1.827803e+001;
n=50; farx(n+1)=1.284206e+000; foe(n+1)=9.942138e+001; krok(n+1)=7.382907e-001; ng(n+1)=1.094559e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.283108e+000; foe(n+1)=1.005824e+002; krok(n+1)=1.572983e-005; ng(n+1)=1.690446e+001;
n=52; farx(n+1)=1.283006e+000; foe(n+1)=1.013173e+002; krok(n+1)=3.799128e-005; ng(n+1)=2.586033e+000;
n=53; farx(n+1)=1.282987e+000; foe(n+1)=1.027904e+002; krok(n+1)=4.988661e-004; ng(n+1)=3.223600e-001;
n=54; farx(n+1)=1.282835e+000; foe(n+1)=1.017114e+002; krok(n+1)=6.802533e-003; ng(n+1)=3.023142e-001;
n=55; farx(n+1)=1.282560e+000; foe(n+1)=1.004674e+002; krok(n+1)=8.222485e-002; ng(n+1)=1.429615e-001;
n=56; farx(n+1)=1.281111e+000; foe(n+1)=9.728294e+001; krok(n+1)=1.459230e+000; ng(n+1)=8.942595e-002;
n=57; farx(n+1)=1.280418e+000; foe(n+1)=9.550449e+001; krok(n+1)=1.794664e-001; ng(n+1)=7.689666e+000;
n=58; farx(n+1)=1.279336e+000; foe(n+1)=9.865440e+001; krok(n+1)=1.245764e+000; ng(n+1)=1.492849e+001;
n=59; farx(n+1)=1.278020e+000; foe(n+1)=9.530558e+001; krok(n+1)=1.280929e+000; ng(n+1)=6.427976e+000;
n=60; farx(n+1)=1.277459e+000; foe(n+1)=9.584707e+001; krok(n+1)=1.164915e+000; ng(n+1)=1.000157e+001;
n=61; farx(n+1)=1.276820e+000; foe(n+1)=9.404828e+001; krok(n+1)=7.679697e-001; ng(n+1)=5.193435e+000;
n=62; farx(n+1)=1.276589e+000; foe(n+1)=9.535276e+001; krok(n+1)=5.353665e-001; ng(n+1)=7.670452e+000;
n=63; farx(n+1)=1.276216e+000; foe(n+1)=9.372740e+001; krok(n+1)=1.902505e+000; ng(n+1)=5.770972e+000;
n=64; farx(n+1)=1.276079e+000; foe(n+1)=9.422452e+001; krok(n+1)=5.219391e-001; ng(n+1)=6.211086e+000;
n=65; farx(n+1)=1.275916e+000; foe(n+1)=9.336715e+001; krok(n+1)=1.462039e+000; ng(n+1)=1.452083e+000;
n=66; farx(n+1)=1.275866e+000; foe(n+1)=9.399634e+001; krok(n+1)=1.361453e+000; ng(n+1)=2.905619e+000;
n=67; farx(n+1)=1.275836e+000; foe(n+1)=9.340511e+001; krok(n+1)=7.679697e-001; ng(n+1)=1.451875e+000;
n=68; farx(n+1)=1.275828e+000; foe(n+1)=9.336570e+001; krok(n+1)=9.001093e-001; ng(n+1)=1.628142e+000;
n=69; farx(n+1)=1.275824e+000; foe(n+1)=9.328633e+001; krok(n+1)=1.252500e+000; ng(n+1)=1.814267e-001;
n=70; farx(n+1)=1.275823e+000; foe(n+1)=9.339836e+001; krok(n+1)=1.104103e+000; ng(n+1)=4.244869e-001;
n=71; farx(n+1)=1.275822e+000; foe(n+1)=9.334581e+001; krok(n+1)=1.915347e+000; ng(n+1)=1.718675e-001;
n=72; farx(n+1)=1.275822e+000; foe(n+1)=9.337888e+001; krok(n+1)=2.097493e+000; ng(n+1)=2.864470e-002;
n=73; farx(n+1)=1.275822e+000; foe(n+1)=9.339287e+001; krok(n+1)=1.249190e+000; ng(n+1)=8.063045e-002;
n=74; farx(n+1)=1.275822e+000; foe(n+1)=9.339074e+001; krok(n+1)=9.001093e-001; ng(n+1)=2.591897e-003;
n=75; farx(n+1)=1.275822e+000; foe(n+1)=9.339074e+001; krok(n+1)=1.344676e-005; ng(n+1)=1.165201e-004;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=5.698743e-005; ng(n+1)=1.165182e-004;
n=77; farx(n+1)=1.275822e+000; foe(n+1)=9.339085e+001; krok(n+1)=8.836179e-005; ng(n+1)=8.752243e-005;
n=78; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.738167e-005; ng(n+1)=1.037339e-004;
n=79; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=3.920421e-006; ng(n+1)=3.179517e-005;
n=80; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=2.319066e-005; ng(n+1)=3.179503e-005;
n=81; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=6.903265e-007; ng(n+1)=3.179269e-005;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.430061e-005; ng(n+1)=3.179266e-005;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.208433e-005; ng(n+1)=3.179207e-005;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=6.492350e-008; ng(n+1)=3.179169e-005;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=4.843102e-009; ng(n+1)=3.179169e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
