%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.847234e+003; foe(n+1)=2.842242e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.600480e+003; foe(n+1)=2.608012e+003; krok(n+1)=3.403614e-004; ng(n+1)=1.229165e+003;
n=2; farx(n+1)=5.720371e+002; foe(n+1)=6.518693e+003; krok(n+1)=6.072741e-003; ng(n+1)=4.273486e+002;
n=3; farx(n+1)=5.511451e+002; foe(n+1)=7.551748e+003; krok(n+1)=3.609728e-005; ng(n+1)=2.161303e+003;
n=4; farx(n+1)=5.022338e+002; foe(n+1)=6.106304e+003; krok(n+1)=3.789541e-002; ng(n+1)=1.878315e+003;
n=5; farx(n+1)=5.011732e+002; foe(n+1)=5.912315e+003; krok(n+1)=3.990929e-003; ng(n+1)=1.391225e+003;
n=6; farx(n+1)=4.157809e+002; foe(n+1)=2.452725e+003; krok(n+1)=2.942678e-001; ng(n+1)=1.362951e+003;
n=7; farx(n+1)=2.996617e+002; foe(n+1)=1.014778e+003; krok(n+1)=6.031845e-001; ng(n+1)=1.351278e+003;
n=8; farx(n+1)=2.473703e+002; foe(n+1)=3.937430e+003; krok(n+1)=1.865458e-001; ng(n+1)=1.284496e+003;
n=9; farx(n+1)=1.071499e+002; foe(n+1)=4.772657e+002; krok(n+1)=3.819429e-001; ng(n+1)=1.376635e+003;
n=10; farx(n+1)=8.699843e+001; foe(n+1)=4.421011e+003; krok(n+1)=6.659180e-002; ng(n+1)=9.712124e+002;
n=11; farx(n+1)=2.508899e+001; foe(n+1)=1.325351e+003; krok(n+1)=3.745525e-001; ng(n+1)=9.353135e+002;
n=12; farx(n+1)=1.793047e+001; foe(n+1)=1.509100e+003; krok(n+1)=7.382907e-001; ng(n+1)=3.102424e+002;
n=13; farx(n+1)=1.540634e+001; foe(n+1)=4.583675e+003; krok(n+1)=1.330664e+000; ng(n+1)=1.458838e+002;
n=14; farx(n+1)=1.021626e+001; foe(n+1)=1.824414e+003; krok(n+1)=1.707324e+000; ng(n+1)=1.062399e+002;
n=15; farx(n+1)=5.874373e+000; foe(n+1)=2.287721e+002; krok(n+1)=1.114151e+000; ng(n+1)=2.365445e+002;
n=16; farx(n+1)=5.755703e+000; foe(n+1)=2.265996e+002; krok(n+1)=1.044632e+000; ng(n+1)=5.863315e+001;
n=17; farx(n+1)=5.699434e+000; foe(n+1)=2.838166e+002; krok(n+1)=1.890784e+000; ng(n+1)=1.481064e+001;
n=18; farx(n+1)=5.042522e+000; foe(n+1)=4.761325e+002; krok(n+1)=2.243825e+001; ng(n+1)=2.785962e+001;
n=19; farx(n+1)=3.848738e+000; foe(n+1)=3.033986e+002; krok(n+1)=1.085880e+000; ng(n+1)=1.277359e+002;
n=20; farx(n+1)=3.516678e+000; foe(n+1)=1.685124e+002; krok(n+1)=6.258076e-001; ng(n+1)=8.895623e+001;
n=21; farx(n+1)=3.251655e+000; foe(n+1)=1.721020e+002; krok(n+1)=1.330664e+000; ng(n+1)=9.708405e+001;
n=22; farx(n+1)=2.749218e+000; foe(n+1)=1.506733e+002; krok(n+1)=9.372047e-001; ng(n+1)=1.505746e+001;
n=23; farx(n+1)=2.535146e+000; foe(n+1)=2.360176e+002; krok(n+1)=1.009068e+000; ng(n+1)=8.069697e+001;
n=24; farx(n+1)=2.247166e+000; foe(n+1)=2.516746e+002; krok(n+1)=1.494130e+000; ng(n+1)=8.243358e+001;
n=25; farx(n+1)=2.045495e+000; foe(n+1)=1.655816e+002; krok(n+1)=3.307424e-001; ng(n+1)=4.874784e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.008952e+000; foe(n+1)=1.699418e+002; krok(n+1)=1.116407e-004; ng(n+1)=3.961789e+001;
n=27; farx(n+1)=2.008473e+000; foe(n+1)=1.721691e+002; krok(n+1)=7.197830e-005; ng(n+1)=6.024551e+000;
n=28; farx(n+1)=1.997474e+000; foe(n+1)=2.071313e+002; krok(n+1)=3.779179e-003; ng(n+1)=4.069990e+000;
n=29; farx(n+1)=1.881266e+000; foe(n+1)=1.674730e+002; krok(n+1)=1.153579e-002; ng(n+1)=7.336625e+000;
n=30; farx(n+1)=1.831137e+000; foe(n+1)=1.483989e+002; krok(n+1)=2.835564e-002; ng(n+1)=4.364141e+001;
n=31; farx(n+1)=1.824132e+000; foe(n+1)=1.545905e+002; krok(n+1)=6.128758e-002; ng(n+1)=7.807496e+001;
n=32; farx(n+1)=1.752581e+000; foe(n+1)=1.717736e+002; krok(n+1)=3.635836e-001; ng(n+1)=8.500586e+001;
n=33; farx(n+1)=1.690505e+000; foe(n+1)=1.318411e+002; krok(n+1)=5.461275e-001; ng(n+1)=4.400909e+001;
n=34; farx(n+1)=1.594668e+000; foe(n+1)=1.256559e+002; krok(n+1)=1.090364e+000; ng(n+1)=2.326294e+001;
n=35; farx(n+1)=1.561176e+000; foe(n+1)=1.619578e+002; krok(n+1)=6.151726e-001; ng(n+1)=5.676697e+001;
n=36; farx(n+1)=1.511109e+000; foe(n+1)=1.677643e+002; krok(n+1)=5.344503e-001; ng(n+1)=1.968470e+001;
n=37; farx(n+1)=1.481810e+000; foe(n+1)=1.291877e+002; krok(n+1)=8.923142e-001; ng(n+1)=3.366357e+001;
n=38; farx(n+1)=1.454347e+000; foe(n+1)=1.157883e+002; krok(n+1)=6.954939e-001; ng(n+1)=5.829777e+001;
n=39; farx(n+1)=1.416170e+000; foe(n+1)=1.170649e+002; krok(n+1)=1.462039e+000; ng(n+1)=1.154670e+001;
n=40; farx(n+1)=1.393745e+000; foe(n+1)=1.323376e+002; krok(n+1)=1.112649e+000; ng(n+1)=4.305803e+001;
n=41; farx(n+1)=1.380574e+000; foe(n+1)=1.517796e+002; krok(n+1)=4.641165e-001; ng(n+1)=3.531074e+001;
n=42; farx(n+1)=1.365344e+000; foe(n+1)=1.311589e+002; krok(n+1)=5.885355e-001; ng(n+1)=7.551335e+000;
n=43; farx(n+1)=1.348951e+000; foe(n+1)=1.036061e+002; krok(n+1)=7.238598e-001; ng(n+1)=4.265126e+001;
n=44; farx(n+1)=1.338903e+000; foe(n+1)=1.141510e+002; krok(n+1)=1.333337e+000; ng(n+1)=3.112107e+001;
n=45; farx(n+1)=1.324184e+000; foe(n+1)=1.134584e+002; krok(n+1)=6.809733e-001; ng(n+1)=1.272003e+001;
n=46; farx(n+1)=1.318857e+000; foe(n+1)=1.089346e+002; krok(n+1)=9.282331e-001; ng(n+1)=2.334784e+001;
n=47; farx(n+1)=1.312552e+000; foe(n+1)=1.133951e+002; krok(n+1)=9.168184e-001; ng(n+1)=3.191590e+001;
n=48; farx(n+1)=1.302707e+000; foe(n+1)=1.029482e+002; krok(n+1)=9.205345e-001; ng(n+1)=1.831815e+000;
n=49; farx(n+1)=1.299249e+000; foe(n+1)=1.073909e+002; krok(n+1)=9.603842e-001; ng(n+1)=2.274842e+001;
n=50; farx(n+1)=1.293742e+000; foe(n+1)=1.070944e+002; krok(n+1)=1.585247e+000; ng(n+1)=2.086118e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.293297e+000; foe(n+1)=1.058625e+002; krok(n+1)=2.190752e-005; ng(n+1)=1.057835e+001;
n=52; farx(n+1)=1.293181e+000; foe(n+1)=1.051494e+002; krok(n+1)=3.440034e-005; ng(n+1)=3.465852e+000;
n=53; farx(n+1)=1.293089e+000; foe(n+1)=1.021472e+002; krok(n+1)=9.824964e-004; ng(n+1)=5.135600e-001;
n=54; farx(n+1)=1.292494e+000; foe(n+1)=1.048912e+002; krok(n+1)=3.683227e-003; ng(n+1)=8.236813e-001;
n=55; farx(n+1)=1.291535e+000; foe(n+1)=1.061144e+002; krok(n+1)=1.519256e-001; ng(n+1)=1.873912e-001;
n=56; farx(n+1)=1.290028e+000; foe(n+1)=1.022857e+002; krok(n+1)=4.268310e-001; ng(n+1)=5.278471e-001;
n=57; farx(n+1)=1.287970e+000; foe(n+1)=9.838600e+001; krok(n+1)=2.075249e-001; ng(n+1)=5.820857e+000;
n=58; farx(n+1)=1.285455e+000; foe(n+1)=1.012483e+002; krok(n+1)=1.193773e+000; ng(n+1)=1.944236e+001;
n=59; farx(n+1)=1.281838e+000; foe(n+1)=9.738968e+001; krok(n+1)=2.285898e+000; ng(n+1)=1.595577e+001;
n=60; farx(n+1)=1.279960e+000; foe(n+1)=9.749961e+001; krok(n+1)=1.462039e+000; ng(n+1)=7.441411e+000;
n=61; farx(n+1)=1.279481e+000; foe(n+1)=9.979617e+001; krok(n+1)=2.363480e-001; ng(n+1)=1.163394e+001;
n=62; farx(n+1)=1.278048e+000; foe(n+1)=9.563527e+001; krok(n+1)=9.859540e-001; ng(n+1)=3.970750e+000;
n=63; farx(n+1)=1.277281e+000; foe(n+1)=9.452326e+001; krok(n+1)=2.167825e+000; ng(n+1)=9.410432e+000;
n=64; farx(n+1)=1.276750e+000; foe(n+1)=9.406680e+001; krok(n+1)=7.970783e-001; ng(n+1)=5.284397e+000;
n=65; farx(n+1)=1.276559e+000; foe(n+1)=9.560430e+001; krok(n+1)=2.833785e-001; ng(n+1)=7.389419e+000;
n=66; farx(n+1)=1.276261e+000; foe(n+1)=9.472275e+001; krok(n+1)=1.034903e+000; ng(n+1)=3.466520e+000;
n=67; farx(n+1)=1.276031e+000; foe(n+1)=9.311875e+001; krok(n+1)=1.879567e+000; ng(n+1)=3.950230e+000;
n=68; farx(n+1)=1.275956e+000; foe(n+1)=9.386285e+001; krok(n+1)=6.653319e-001; ng(n+1)=4.330151e+000;
n=69; farx(n+1)=1.275882e+000; foe(n+1)=9.375059e+001; krok(n+1)=9.725754e-001; ng(n+1)=1.258959e+000;
n=70; farx(n+1)=1.275850e+000; foe(n+1)=9.330098e+001; krok(n+1)=1.139125e+000; ng(n+1)=2.630424e+000;
n=71; farx(n+1)=1.275837e+000; foe(n+1)=9.347871e+001; krok(n+1)=9.961132e-001; ng(n+1)=1.749009e+000;
n=72; farx(n+1)=1.275829e+000; foe(n+1)=9.326178e+001; krok(n+1)=1.236644e+000; ng(n+1)=1.480221e-001;
n=73; farx(n+1)=1.275827e+000; foe(n+1)=9.343943e+001; krok(n+1)=2.871495e+000; ng(n+1)=6.014804e-001;
n=74; farx(n+1)=1.275824e+000; foe(n+1)=9.308329e+001; krok(n+1)=3.302482e+000; ng(n+1)=2.687933e-001;
n=75; farx(n+1)=1.275822e+000; foe(n+1)=9.340770e+001; krok(n+1)=1.561580e+000; ng(n+1)=1.959148e-001;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275822e+000; foe(n+1)=9.340155e+001; krok(n+1)=1.481538e-005; ng(n+1)=7.881204e-002;
n=77; farx(n+1)=1.275822e+000; foe(n+1)=9.339548e+001; krok(n+1)=2.860122e-005; ng(n+1)=2.403366e-002;
n=78; farx(n+1)=1.275822e+000; foe(n+1)=9.337692e+001; krok(n+1)=2.456241e-004; ng(n+1)=7.453165e-003;
n=79; farx(n+1)=1.275822e+000; foe(n+1)=9.338202e+001; krok(n+1)=1.464382e-002; ng(n+1)=2.088049e-003;
n=80; farx(n+1)=1.275822e+000; foe(n+1)=9.338572e+001; krok(n+1)=3.006802e-002; ng(n+1)=1.984569e-003;
n=81; farx(n+1)=1.275822e+000; foe(n+1)=9.338475e+001; krok(n+1)=3.144226e-001; ng(n+1)=2.661771e-004;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.339125e+001; krok(n+1)=1.346870e+001; ng(n+1)=1.697543e-004;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.033731e+000; ng(n+1)=3.571905e-003;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.380384e-005; ng(n+1)=1.099262e-005;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=5.921437e-008; ng(n+1)=1.099247e-005;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=2.139406e-008; ng(n+1)=1.099247e-005;
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=4.980372e-006; ng(n+1)=1.099247e-005;
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.046074e-005; ng(n+1)=1.099235e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.069939e-005; ng(n+1)=1.099224e-005;
n=90; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.611240e-005; ng(n+1)=1.816050e-006;
n=91; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=8.058704e-006; ng(n+1)=1.364698e-006;
n=92; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.852967e-007; ng(n+1)=1.365527e-006;
n=93; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=2.194725e-007; ng(n+1)=1.365524e-006;
n=94; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=3.927752e-008; ng(n+1)=1.365522e-006;
 % z³y kierunek w metodzie zm - odnowa 
n=95; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=4.758053e-011; ng(n+1)=1.365524e-006;
n=96; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.476376e-009; ng(n+1)=1.365521e-006;
n=97; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=5.658616e-008; ng(n+1)=1.365512e-006;
n=98; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.859948e-010; ng(n+1)=1.365528e-006;
 % z³y kierunek w metodzie zm - odnowa 
n=99; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=5.814110e-011; ng(n+1)=1.365528e-006;
n=100; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.364118e-010; ng(n+1)=1.365524e-006;
%odnowa zmiennej metryki
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
