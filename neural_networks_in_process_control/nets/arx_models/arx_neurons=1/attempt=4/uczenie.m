%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.842647e+003; foe(n+1)=2.843596e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.595608e+003; foe(n+1)=2.610844e+003; krok(n+1)=3.428360e-004; ng(n+1)=1.025392e+003;
n=2; farx(n+1)=7.362769e+002; foe(n+1)=6.536964e+003; krok(n+1)=5.400718e-003; ng(n+1)=6.286497e+002;
n=3; farx(n+1)=6.962113e+002; foe(n+1)=7.708767e+003; krok(n+1)=1.123699e-004; ng(n+1)=1.951358e+003;
n=4; farx(n+1)=6.602175e+002; foe(n+1)=7.771243e+003; krok(n+1)=1.757317e-003; ng(n+1)=1.665116e+003;
n=5; farx(n+1)=6.426375e+002; foe(n+1)=7.975051e+003; krok(n+1)=4.641307e-002; ng(n+1)=1.746711e+003;
n=6; farx(n+1)=1.065323e+002; foe(n+1)=1.263471e+003; krok(n+1)=5.596492e-001; ng(n+1)=1.636147e+003;
n=7; farx(n+1)=8.259897e+001; foe(n+1)=5.045018e+002; krok(n+1)=6.137814e-001; ng(n+1)=3.935831e+002;
n=8; farx(n+1)=5.757426e+001; foe(n+1)=6.189626e+003; krok(n+1)=1.296088e+000; ng(n+1)=3.401575e+002;
n=9; farx(n+1)=3.978656e+001; foe(n+1)=6.141188e+003; krok(n+1)=1.311594e+000; ng(n+1)=2.435060e+002;
n=10; farx(n+1)=3.262298e+001; foe(n+1)=1.586656e+003; krok(n+1)=3.735325e-001; ng(n+1)=3.210741e+002;
n=11; farx(n+1)=2.620610e+001; foe(n+1)=1.128196e+003; krok(n+1)=9.270274e-001; ng(n+1)=1.556066e+002;
n=12; farx(n+1)=1.939449e+001; foe(n+1)=5.633119e+002; krok(n+1)=1.420334e+000; ng(n+1)=6.757867e+001;
n=13; farx(n+1)=1.422472e+001; foe(n+1)=2.499447e+002; krok(n+1)=8.256204e-001; ng(n+1)=1.288873e+002;
n=14; farx(n+1)=1.152956e+001; foe(n+1)=2.160747e+002; krok(n+1)=5.014424e-001; ng(n+1)=2.086208e+002;
n=15; farx(n+1)=8.628851e+000; foe(n+1)=1.988026e+002; krok(n+1)=9.205345e-001; ng(n+1)=1.123381e+002;
n=16; farx(n+1)=6.714806e+000; foe(n+1)=2.073993e+002; krok(n+1)=7.461552e-001; ng(n+1)=7.477212e+001;
n=17; farx(n+1)=5.286588e+000; foe(n+1)=3.378324e+002; krok(n+1)=1.814761e+000; ng(n+1)=1.342219e+002;
n=18; farx(n+1)=4.483833e+000; foe(n+1)=3.116818e+002; krok(n+1)=2.760258e-001; ng(n+1)=7.896509e+001;
n=19; farx(n+1)=4.141070e+000; foe(n+1)=2.094153e+002; krok(n+1)=2.353350e-001; ng(n+1)=7.403667e+001;
n=20; farx(n+1)=3.778941e+000; foe(n+1)=2.817858e+002; krok(n+1)=1.164915e+000; ng(n+1)=7.250662e+001;
n=21; farx(n+1)=3.408777e+000; foe(n+1)=2.007440e+002; krok(n+1)=9.453922e-001; ng(n+1)=9.788780e+001;
n=22; farx(n+1)=2.986435e+000; foe(n+1)=1.668962e+002; krok(n+1)=5.842182e-001; ng(n+1)=5.316626e+001;
n=23; farx(n+1)=2.718059e+000; foe(n+1)=2.784312e+002; krok(n+1)=5.786742e-001; ng(n+1)=7.220539e+001;
n=24; farx(n+1)=2.349110e+000; foe(n+1)=2.216222e+002; krok(n+1)=2.389982e+000; ng(n+1)=6.487174e+001;
n=25; farx(n+1)=2.185706e+000; foe(n+1)=1.681282e+002; krok(n+1)=2.866206e-001; ng(n+1)=4.638588e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.108236e+000; foe(n+1)=1.900796e+002; krok(n+1)=5.210339e-005; ng(n+1)=9.452005e+001;
n=27; farx(n+1)=2.106557e+000; foe(n+1)=1.887010e+002; krok(n+1)=2.385047e-004; ng(n+1)=6.136946e+000;
n=28; farx(n+1)=1.984101e+000; foe(n+1)=1.472183e+002; krok(n+1)=1.576669e-002; ng(n+1)=5.238197e+000;
n=29; farx(n+1)=1.971721e+000; foe(n+1)=1.779764e+002; krok(n+1)=1.178557e-003; ng(n+1)=1.787428e+001;
n=30; farx(n+1)=1.875760e+000; foe(n+1)=1.513305e+002; krok(n+1)=4.171530e-002; ng(n+1)=2.454782e+001;
n=31; farx(n+1)=1.866239e+000; foe(n+1)=1.552444e+002; krok(n+1)=4.346837e-002; ng(n+1)=8.120039e+001;
n=32; farx(n+1)=1.806496e+000; foe(n+1)=1.774648e+002; krok(n+1)=3.963765e-001; ng(n+1)=9.026615e+001;
n=33; farx(n+1)=1.717569e+000; foe(n+1)=1.452905e+002; krok(n+1)=7.808753e-001; ng(n+1)=6.046876e+001;
n=34; farx(n+1)=1.613118e+000; foe(n+1)=1.531821e+002; krok(n+1)=1.136651e+000; ng(n+1)=3.118609e+001;
n=35; farx(n+1)=1.586890e+000; foe(n+1)=1.428701e+002; krok(n+1)=2.320583e-001; ng(n+1)=2.505489e+001;
n=36; farx(n+1)=1.543351e+000; foe(n+1)=1.452826e+002; krok(n+1)=7.461552e-001; ng(n+1)=6.222127e+001;
n=37; farx(n+1)=1.474557e+000; foe(n+1)=1.539732e+002; krok(n+1)=2.984733e+000; ng(n+1)=5.077491e+001;
n=38; farx(n+1)=1.443969e+000; foe(n+1)=1.279248e+002; krok(n+1)=2.910883e-001; ng(n+1)=4.017764e+001;
n=39; farx(n+1)=1.419301e+000; foe(n+1)=1.207336e+002; krok(n+1)=7.479975e-001; ng(n+1)=3.190018e+001;
n=40; farx(n+1)=1.406660e+000; foe(n+1)=1.262782e+002; krok(n+1)=1.046368e+000; ng(n+1)=4.424677e+001;
n=41; farx(n+1)=1.383605e+000; foe(n+1)=1.288947e+002; krok(n+1)=1.492366e+000; ng(n+1)=1.081196e+001;
n=42; farx(n+1)=1.366372e+000; foe(n+1)=1.414205e+002; krok(n+1)=5.752763e-001; ng(n+1)=3.994619e+001;
n=43; farx(n+1)=1.351332e+000; foe(n+1)=1.045122e+002; krok(n+1)=8.728449e-001; ng(n+1)=3.660876e+001;
n=44; farx(n+1)=1.342202e+000; foe(n+1)=1.092531e+002; krok(n+1)=5.885355e-001; ng(n+1)=3.075614e+001;
n=45; farx(n+1)=1.330737e+000; foe(n+1)=1.111245e+002; krok(n+1)=6.328829e-001; ng(n+1)=1.890154e+001;
n=46; farx(n+1)=1.321744e+000; foe(n+1)=1.136580e+002; krok(n+1)=1.145447e+000; ng(n+1)=2.448658e+001;
n=47; farx(n+1)=1.309544e+000; foe(n+1)=1.204915e+002; krok(n+1)=2.358407e+000; ng(n+1)=3.105838e+001;
n=48; farx(n+1)=1.305593e+000; foe(n+1)=1.117043e+002; krok(n+1)=2.250273e-001; ng(n+1)=8.041620e+000;
n=49; farx(n+1)=1.299846e+000; foe(n+1)=9.894628e+001; krok(n+1)=8.922169e-001; ng(n+1)=1.428836e+001;
n=50; farx(n+1)=1.296916e+000; foe(n+1)=1.026620e+002; krok(n+1)=9.073805e-001; ng(n+1)=2.457870e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.296815e+000; foe(n+1)=1.036359e+002; krok(n+1)=2.780451e-005; ng(n+1)=3.773019e+000;
n=52; farx(n+1)=1.296692e+000; foe(n+1)=1.058849e+002; krok(n+1)=7.363092e-005; ng(n+1)=2.825009e+000;
n=53; farx(n+1)=1.296517e+000; foe(n+1)=1.094880e+002; krok(n+1)=1.354575e-004; ng(n+1)=2.490787e+000;
n=54; farx(n+1)=1.296092e+000; foe(n+1)=1.089517e+002; krok(n+1)=2.954351e-002; ng(n+1)=3.060176e-001;
n=55; farx(n+1)=1.295240e+000; foe(n+1)=1.060720e+002; krok(n+1)=4.077788e-002; ng(n+1)=3.288958e-001;
n=56; farx(n+1)=1.291480e+000; foe(n+1)=1.015422e+002; krok(n+1)=8.194182e-001; ng(n+1)=3.729450e-001;
n=57; farx(n+1)=1.290271e+000; foe(n+1)=9.896630e+001; krok(n+1)=1.540084e-001; ng(n+1)=1.442111e+001;
n=58; farx(n+1)=1.286761e+000; foe(n+1)=1.047815e+002; krok(n+1)=1.754369e+000; ng(n+1)=2.146634e+001;
n=59; farx(n+1)=1.284213e+000; foe(n+1)=9.929980e+001; krok(n+1)=6.954939e-001; ng(n+1)=9.084382e+000;
n=60; farx(n+1)=1.282851e+000; foe(n+1)=9.802674e+001; krok(n+1)=6.762233e-001; ng(n+1)=1.607387e+001;
n=61; farx(n+1)=1.280756e+000; foe(n+1)=9.685733e+001; krok(n+1)=1.784628e+000; ng(n+1)=9.177209e+000;
n=62; farx(n+1)=1.279876e+000; foe(n+1)=9.987219e+001; krok(n+1)=6.900158e-001; ng(n+1)=1.138044e+001;
n=63; farx(n+1)=1.278464e+000; foe(n+1)=9.683917e+001; krok(n+1)=5.535078e-001; ng(n+1)=2.892954e+000;
n=64; farx(n+1)=1.277879e+000; foe(n+1)=9.436013e+001; krok(n+1)=1.280929e+000; ng(n+1)=8.109350e+000;
n=65; farx(n+1)=1.277276e+000; foe(n+1)=9.577012e+001; krok(n+1)=9.806012e-001; ng(n+1)=1.036712e+001;
n=66; farx(n+1)=1.276789e+000; foe(n+1)=9.487526e+001; krok(n+1)=5.596492e-001; ng(n+1)=4.946918e+000;
n=67; farx(n+1)=1.276510e+000; foe(n+1)=9.408869e+001; krok(n+1)=8.935632e-001; ng(n+1)=5.718265e+000;
n=68; farx(n+1)=1.276297e+000; foe(n+1)=9.521583e+001; krok(n+1)=8.892951e-001; ng(n+1)=7.646034e+000;
n=69; farx(n+1)=1.276031e+000; foe(n+1)=9.335714e+001; krok(n+1)=1.569476e+000; ng(n+1)=1.162103e+000;
n=70; farx(n+1)=1.275925e+000; foe(n+1)=9.401086e+001; krok(n+1)=1.397233e+000; ng(n+1)=4.303871e+000;
n=71; farx(n+1)=1.275870e+000; foe(n+1)=9.335804e+001; krok(n+1)=8.343808e-001; ng(n+1)=6.209116e-001;
n=72; farx(n+1)=1.275839e+000; foe(n+1)=9.336227e+001; krok(n+1)=1.255467e+000; ng(n+1)=2.078268e+000;
n=73; farx(n+1)=1.275828e+000; foe(n+1)=9.333666e+001; krok(n+1)=1.613595e+000; ng(n+1)=5.487827e-001;
n=74; farx(n+1)=1.275825e+000; foe(n+1)=9.339083e+001; krok(n+1)=6.522451e-001; ng(n+1)=1.155520e+000;
n=75; farx(n+1)=1.275824e+000; foe(n+1)=9.324896e+001; krok(n+1)=1.601772e+000; ng(n+1)=1.759174e-001;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275824e+000; foe(n+1)=9.324991e+001; krok(n+1)=1.599777e-005; ng(n+1)=1.220723e-001;
n=77; farx(n+1)=1.275824e+000; foe(n+1)=9.324796e+001; krok(n+1)=2.768790e-005; ng(n+1)=6.587832e-002;
n=78; farx(n+1)=1.275824e+000; foe(n+1)=9.329985e+001; krok(n+1)=2.556059e-004; ng(n+1)=2.264639e-002;
n=79; farx(n+1)=1.275824e+000; foe(n+1)=9.329657e+001; krok(n+1)=3.340315e-002; ng(n+1)=6.920249e-003;
n=80; farx(n+1)=1.275822e+000; foe(n+1)=9.338456e+001; krok(n+1)=3.616714e-002; ng(n+1)=1.311752e-002;
n=81; farx(n+1)=1.275822e+000; foe(n+1)=9.337919e+001; krok(n+1)=7.190954e-002; ng(n+1)=2.315774e-003;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.339363e+001; krok(n+1)=1.890513e+001; ng(n+1)=1.013039e-003;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=1.053408e+000; ng(n+1)=1.630189e-002;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=8.847649e-006; ng(n+1)=3.580289e-005;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=5.929494e-006; ng(n+1)=3.580256e-005;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=2.139878e-005; ng(n+1)=3.580235e-005;
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=3.741922e-007; ng(n+1)=3.580159e-005;
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=1.069487e-009; ng(n+1)=3.580157e-005;
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339093e+001; krok(n+1)=3.481798e-008; ng(n+1)=3.580157e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
