%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.845691e+003; foe(n+1)=2.844768e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.599872e+003; foe(n+1)=2.610847e+003; krok(n+1)=3.403614e-004; ng(n+1)=1.243685e+003;
n=2; farx(n+1)=5.891330e+002; foe(n+1)=6.707387e+003; krok(n+1)=5.829338e-003; ng(n+1)=4.384255e+002;
n=3; farx(n+1)=5.670086e+002; foe(n+1)=7.735820e+003; krok(n+1)=3.400119e-005; ng(n+1)=2.261131e+003;
n=4; farx(n+1)=5.190337e+002; foe(n+1)=6.197734e+003; krok(n+1)=4.641307e-002; ng(n+1)=1.950708e+003;
n=5; farx(n+1)=5.163912e+002; foe(n+1)=5.852560e+003; krok(n+1)=1.353531e-003; ng(n+1)=1.466767e+003;
n=6; farx(n+1)=4.075806e+002; foe(n+1)=3.013073e+003; krok(n+1)=5.312625e-001; ng(n+1)=1.411288e+003;
n=7; farx(n+1)=3.256488e+002; foe(n+1)=9.718137e+002; krok(n+1)=5.386904e-001; ng(n+1)=1.307094e+003;
n=8; farx(n+1)=2.553168e+002; foe(n+1)=3.895446e+003; krok(n+1)=2.522670e-001; ng(n+1)=1.250870e+003;
n=9; farx(n+1)=1.393368e+002; foe(n+1)=8.576367e+002; krok(n+1)=5.600723e-001; ng(n+1)=1.316576e+003;
n=10; farx(n+1)=1.130957e+002; foe(n+1)=8.706343e+003; krok(n+1)=1.022485e-001; ng(n+1)=8.870638e+002;
n=11; farx(n+1)=3.437526e+001; foe(n+1)=8.675623e+003; krok(n+1)=4.268310e-001; ng(n+1)=8.064054e+002;
n=12; farx(n+1)=2.031484e+001; foe(n+1)=6.520578e+002; krok(n+1)=7.310195e-001; ng(n+1)=3.672241e+002;
n=13; farx(n+1)=1.679239e+001; foe(n+1)=3.988624e+003; krok(n+1)=1.110032e+000; ng(n+1)=1.421165e+002;
n=14; farx(n+1)=1.146596e+001; foe(n+1)=8.377334e+002; krok(n+1)=2.494425e+000; ng(n+1)=1.194601e+002;
n=15; farx(n+1)=7.499863e+000; foe(n+1)=2.319165e+002; krok(n+1)=1.142810e+000; ng(n+1)=2.321523e+002;
n=16; farx(n+1)=7.147156e+000; foe(n+1)=2.197425e+002; krok(n+1)=5.451818e-001; ng(n+1)=1.234827e+002;
n=17; farx(n+1)=6.986242e+000; foe(n+1)=2.950252e+002; krok(n+1)=2.192737e+000; ng(n+1)=2.448914e+001;
n=18; farx(n+1)=4.867799e+000; foe(n+1)=4.155470e+002; krok(n+1)=3.738552e+001; ng(n+1)=2.794232e+001;
n=19; farx(n+1)=3.915850e+000; foe(n+1)=1.688360e+002; krok(n+1)=1.075480e+000; ng(n+1)=5.571307e+001;
n=20; farx(n+1)=3.666227e+000; foe(n+1)=1.601380e+002; krok(n+1)=4.144507e-001; ng(n+1)=1.068717e+002;
n=21; farx(n+1)=3.210047e+000; foe(n+1)=2.313674e+002; krok(n+1)=1.258151e+000; ng(n+1)=2.233042e+001;
n=22; farx(n+1)=2.837166e+000; foe(n+1)=2.947003e+002; krok(n+1)=7.773108e-001; ng(n+1)=1.022528e+002;
n=23; farx(n+1)=2.557849e+000; foe(n+1)=1.683968e+002; krok(n+1)=7.011953e-001; ng(n+1)=8.614035e+001;
n=24; farx(n+1)=2.243652e+000; foe(n+1)=1.556262e+002; krok(n+1)=1.650428e+000; ng(n+1)=4.432672e+001;
n=25; farx(n+1)=2.148917e+000; foe(n+1)=1.369689e+002; krok(n+1)=2.134155e-001; ng(n+1)=4.184425e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=2.122672e+000; foe(n+1)=1.473466e+002; krok(n+1)=7.211737e-005; ng(n+1)=4.441904e+001;
n=27; farx(n+1)=2.112759e+000; foe(n+1)=1.564451e+002; krok(n+1)=1.151008e-004; ng(n+1)=2.129388e+001;
n=28; farx(n+1)=2.090258e+000; foe(n+1)=1.959549e+002; krok(n+1)=8.336543e-004; ng(n+1)=1.170530e+001;
n=29; farx(n+1)=1.953983e+000; foe(n+1)=1.675278e+002; krok(n+1)=2.733118e-002; ng(n+1)=5.327565e+000;
n=30; farx(n+1)=1.870878e+000; foe(n+1)=1.451734e+002; krok(n+1)=5.360061e-002; ng(n+1)=1.520699e+001;
n=31; farx(n+1)=1.864741e+000; foe(n+1)=1.447972e+002; krok(n+1)=4.568872e-002; ng(n+1)=6.376444e+001;
n=32; farx(n+1)=1.746141e+000; foe(n+1)=1.703396e+002; krok(n+1)=8.067975e-001; ng(n+1)=7.178040e+001;
n=33; farx(n+1)=1.659448e+000; foe(n+1)=1.275856e+002; krok(n+1)=1.174409e+000; ng(n+1)=5.829184e+001;
n=34; farx(n+1)=1.599018e+000; foe(n+1)=1.437565e+002; krok(n+1)=3.693268e-001; ng(n+1)=1.899653e+001;
n=35; farx(n+1)=1.574258e+000; foe(n+1)=1.306602e+002; krok(n+1)=3.762824e-001; ng(n+1)=3.336863e+001;
n=36; farx(n+1)=1.526887e+000; foe(n+1)=1.636836e+002; krok(n+1)=5.520515e-001; ng(n+1)=5.111701e+001;
n=37; farx(n+1)=1.477375e+000; foe(n+1)=1.343800e+002; krok(n+1)=1.443163e+000; ng(n+1)=4.140321e+001;
n=38; farx(n+1)=1.448022e+000; foe(n+1)=1.327927e+002; krok(n+1)=7.382907e-001; ng(n+1)=4.521916e+001;
n=39; farx(n+1)=1.417165e+000; foe(n+1)=1.109013e+002; krok(n+1)=5.939923e-001; ng(n+1)=2.439828e+001;
n=40; farx(n+1)=1.397414e+000; foe(n+1)=1.246519e+002; krok(n+1)=1.126364e+000; ng(n+1)=2.902722e+001;
n=41; farx(n+1)=1.383377e+000; foe(n+1)=1.450682e+002; krok(n+1)=7.178655e-001; ng(n+1)=4.752090e+001;
n=42; farx(n+1)=1.362523e+000; foe(n+1)=1.170121e+002; krok(n+1)=1.075645e+000; ng(n+1)=1.987396e+001;
n=43; farx(n+1)=1.353300e+000; foe(n+1)=1.055420e+002; krok(n+1)=5.490988e-001; ng(n+1)=2.186351e+001;
n=44; farx(n+1)=1.341578e+000; foe(n+1)=1.177551e+002; krok(n+1)=8.316025e-001; ng(n+1)=3.722828e+001;
n=45; farx(n+1)=1.329891e+000; foe(n+1)=1.093733e+002; krok(n+1)=9.769152e-001; ng(n+1)=5.979551e+000;
n=46; farx(n+1)=1.321275e+000; foe(n+1)=1.016700e+002; krok(n+1)=7.655551e-001; ng(n+1)=2.898041e+001;
n=47; farx(n+1)=1.313960e+000; foe(n+1)=1.124287e+002; krok(n+1)=1.073054e+000; ng(n+1)=2.568122e+001;
n=48; farx(n+1)=1.306387e+000; foe(n+1)=1.181824e+002; krok(n+1)=1.307567e+000; ng(n+1)=1.822054e+001;
n=49; farx(n+1)=1.300271e+000; foe(n+1)=1.072995e+002; krok(n+1)=2.405442e-001; ng(n+1)=1.599082e+001;
n=50; farx(n+1)=1.297346e+000; foe(n+1)=1.002411e+002; krok(n+1)=9.073805e-001; ng(n+1)=1.248236e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.294701e+000; foe(n+1)=1.030528e+002; krok(n+1)=1.839286e-005; ng(n+1)=2.500528e+001;
n=52; farx(n+1)=1.294358e+000; foe(n+1)=1.037344e+002; krok(n+1)=4.037383e-005; ng(n+1)=4.826141e+000;
n=53; farx(n+1)=1.294339e+000; foe(n+1)=1.051731e+002; krok(n+1)=4.880790e-004; ng(n+1)=4.728310e-001;
n=54; farx(n+1)=1.293631e+000; foe(n+1)=1.063060e+002; krok(n+1)=4.655230e-002; ng(n+1)=2.642696e-001;
n=55; farx(n+1)=1.293135e+000; foe(n+1)=1.068451e+002; krok(n+1)=1.861441e-002; ng(n+1)=3.943521e-001;
n=56; farx(n+1)=1.290473e+000; foe(n+1)=1.035465e+002; krok(n+1)=7.310195e-001; ng(n+1)=5.410794e-001;
n=57; farx(n+1)=1.288708e+000; foe(n+1)=1.000086e+002; krok(n+1)=1.505524e-001; ng(n+1)=1.222666e+001;
n=58; farx(n+1)=1.286026e+000; foe(n+1)=9.951316e+001; krok(n+1)=1.272290e+000; ng(n+1)=2.354843e+001;
n=59; farx(n+1)=1.282175e+000; foe(n+1)=1.005085e+002; krok(n+1)=2.262924e+000; ng(n+1)=1.110664e+001;
n=60; farx(n+1)=1.280594e+000; foe(n+1)=9.604171e+001; krok(n+1)=1.138091e+000; ng(n+1)=1.413574e+001;
n=61; farx(n+1)=1.279740e+000; foe(n+1)=9.752337e+001; krok(n+1)=2.689113e-001; ng(n+1)=1.390017e+001;
n=62; farx(n+1)=1.278324e+000; foe(n+1)=9.529300e+001; krok(n+1)=1.070120e+000; ng(n+1)=5.133451e+000;
n=63; farx(n+1)=1.277772e+000; foe(n+1)=9.726511e+001; krok(n+1)=1.017241e+000; ng(n+1)=1.053934e+001;
n=64; farx(n+1)=1.277028e+000; foe(n+1)=9.456545e+001; krok(n+1)=1.245764e+000; ng(n+1)=8.696925e+000;
n=65; farx(n+1)=1.276749e+000; foe(n+1)=9.512821e+001; krok(n+1)=4.318959e-001; ng(n+1)=8.876366e+000;
n=66; farx(n+1)=1.276347e+000; foe(n+1)=9.372252e+001; krok(n+1)=1.310660e+000; ng(n+1)=2.855903e+000;
n=67; farx(n+1)=1.276123e+000; foe(n+1)=9.497485e+001; krok(n+1)=1.264242e+000; ng(n+1)=5.552782e+000;
n=68; farx(n+1)=1.276004e+000; foe(n+1)=9.393514e+001; krok(n+1)=7.212814e-001; ng(n+1)=3.636024e+000;
n=69; farx(n+1)=1.275917e+000; foe(n+1)=9.377425e+001; krok(n+1)=7.773108e-001; ng(n+1)=4.700713e+000;
n=70; farx(n+1)=1.275864e+000; foe(n+1)=9.320665e+001; krok(n+1)=1.157348e+000; ng(n+1)=1.199631e+000;
n=71; farx(n+1)=1.275837e+000; foe(n+1)=9.370339e+001; krok(n+1)=1.021441e+000; ng(n+1)=2.192418e+000;
n=72; farx(n+1)=1.275825e+000; foe(n+1)=9.342668e+001; krok(n+1)=1.037862e+000; ng(n+1)=5.783619e-001;
n=73; farx(n+1)=1.275822e+000; foe(n+1)=9.338609e+001; krok(n+1)=1.114151e+000; ng(n+1)=8.594865e-001;
n=74; farx(n+1)=1.275822e+000; foe(n+1)=9.336649e+001; krok(n+1)=1.072007e+000; ng(n+1)=8.036166e-002;
n=75; farx(n+1)=1.275822e+000; foe(n+1)=9.338680e+001; krok(n+1)=1.154088e+000; ng(n+1)=6.557534e-002;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275822e+000; foe(n+1)=9.338444e+001; krok(n+1)=1.916970e-005; ng(n+1)=3.880442e-002;
n=77; farx(n+1)=1.275822e+000; foe(n+1)=9.338136e+001; krok(n+1)=2.006817e-005; ng(n+1)=2.582658e-002;
n=78; farx(n+1)=1.275822e+000; foe(n+1)=9.337515e+001; krok(n+1)=5.018139e-004; ng(n+1)=1.816722e-003;
n=79; farx(n+1)=1.275822e+000; foe(n+1)=9.338881e+001; krok(n+1)=4.346837e-002; ng(n+1)=1.992646e-003;
n=80; farx(n+1)=1.275822e+000; foe(n+1)=9.339572e+001; krok(n+1)=1.610734e-002; ng(n+1)=2.557261e-003;
n=81; farx(n+1)=1.275822e+000; foe(n+1)=9.339486e+001; krok(n+1)=7.363563e-002; ng(n+1)=4.003385e-004;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.339486e+001; krok(n+1)=1.795169e-005; ng(n+1)=6.653802e-005;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=1.015323e+000; ng(n+1)=6.653694e-005;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=7.150304e-006; ng(n+1)=6.235974e-005;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=9.096143e-006; ng(n+1)=6.235926e-005;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=1.712858e-008; ng(n+1)=6.235870e-005;
 % z³y kierunek w metodzie zm - odnowa 
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=1.069939e-005; ng(n+1)=6.235870e-005;
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=7.047240e-006; ng(n+1)=2.420520e-005;
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339074e+001; krok(n+1)=5.224781e-005; ng(n+1)=2.385177e-005;
n=90; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=2.176076e-003; ng(n+1)=4.375980e-005;
n=91; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=3.279983e-005; ng(n+1)=4.154022e-005;
n=92; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=3.555039e-005; ng(n+1)=4.153890e-005;
n=93; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=8.217907e-006; ng(n+1)=4.153719e-005;
n=94; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=1.749400e-007; ng(n+1)=4.153677e-005;
n=95; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=1.344712e-006; ng(n+1)=4.153676e-005;
n=96; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=7.420172e-008; ng(n+1)=4.153670e-005;
n=97; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=1.203096e-008; ng(n+1)=4.153670e-005;
n=98; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=5.776619e-006; ng(n+1)=4.153670e-005;
n=99; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=1.069939e-005; ng(n+1)=4.153647e-005;
n=100; farx(n+1)=1.275822e+000; foe(n+1)=9.339071e+001; krok(n+1)=1.635197e-005; ng(n+1)=4.153603e-005;
%odnowa zmiennej metryki
n=101; farx(n+1)=1.275822e+000; foe(n+1)=9.339073e+001; krok(n+1)=5.720244e-005; ng(n+1)=4.153534e-005;
n=102; farx(n+1)=1.275822e+000; foe(n+1)=9.339075e+001; krok(n+1)=3.886698e-005; ng(n+1)=3.653701e-005;
n=103; farx(n+1)=1.275822e+000; foe(n+1)=9.339078e+001; krok(n+1)=3.474008e-005; ng(n+1)=4.475180e-005;
n=104; farx(n+1)=1.275822e+000; foe(n+1)=9.339078e+001; krok(n+1)=2.141550e-006; ng(n+1)=1.169586e-005;
n=105; farx(n+1)=1.275822e+000; foe(n+1)=9.339078e+001; krok(n+1)=3.127084e-007; ng(n+1)=1.169583e-005;
n=106; farx(n+1)=1.275822e+000; foe(n+1)=9.339078e+001; krok(n+1)=5.397471e-011; ng(n+1)=1.169579e-005;
n=107; farx(n+1)=1.275822e+000; foe(n+1)=9.339078e+001; krok(n+1)=1.090340e-009; ng(n+1)=1.169579e-005;
n=108; farx(n+1)=1.275822e+000; foe(n+1)=9.339078e+001; krok(n+1)=1.071611e-010; ng(n+1)=1.169579e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
