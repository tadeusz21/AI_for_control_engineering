%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.858469e+003; foe(n+1)=2.858351e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.611108e+003; foe(n+1)=2.598742e+003; krok(n+1)=3.127269e-004; ng(n+1)=1.355835e+003;
n=2; farx(n+1)=2.461766e+003; foe(n+1)=2.664153e+003; krok(n+1)=2.569527e-003; ng(n+1)=4.506373e+002;
n=3; farx(n+1)=2.305433e+003; foe(n+1)=3.438004e+003; krok(n+1)=5.755042e-005; ng(n+1)=2.410787e+003;
n=4; farx(n+1)=2.276101e+003; foe(n+1)=3.487532e+003; krok(n+1)=4.234033e-003; ng(n+1)=3.270818e+003;
n=5; farx(n+1)=2.226268e+003; foe(n+1)=4.387332e+003; krok(n+1)=7.233428e-002; ng(n+1)=3.398611e+003;
n=6; farx(n+1)=6.194576e+002; foe(n+1)=7.958703e+003; krok(n+1)=3.430439e+000; ng(n+1)=3.530121e+003;
n=7; farx(n+1)=2.617979e+002; foe(n+1)=4.620569e+003; krok(n+1)=8.620454e-001; ng(n+1)=1.262579e+003;
n=8; farx(n+1)=2.445098e+002; foe(n+1)=4.369107e+003; krok(n+1)=4.623400e+000; ng(n+1)=9.581563e+001;
n=9; farx(n+1)=2.421685e+002; foe(n+1)=4.519221e+003; krok(n+1)=2.669779e+000; ng(n+1)=1.241577e+002;
n=10; farx(n+1)=1.698641e+002; foe(n+1)=5.311094e+003; krok(n+1)=1.805699e+001; ng(n+1)=8.479737e+001;
n=11; farx(n+1)=1.667182e+002; foe(n+1)=5.359724e+003; krok(n+1)=1.442609e-001; ng(n+1)=3.465484e+002;
n=12; farx(n+1)=1.528023e+002; foe(n+1)=5.548059e+003; krok(n+1)=2.617405e-001; ng(n+1)=4.099678e+002;
n=13; farx(n+1)=1.376010e+002; foe(n+1)=5.748415e+003; krok(n+1)=4.020096e-001; ng(n+1)=2.113174e+002;
n=14; farx(n+1)=1.086743e+002; foe(n+1)=6.551987e+003; krok(n+1)=4.416412e+000; ng(n+1)=2.103276e+002;
n=15; farx(n+1)=7.155253e+001; foe(n+1)=7.116757e+003; krok(n+1)=9.846165e-001; ng(n+1)=9.738530e+001;
n=16; farx(n+1)=3.723134e+001; foe(n+1)=9.331668e+003; krok(n+1)=3.100837e-001; ng(n+1)=1.736744e+002;
n=17; farx(n+1)=2.765550e+001; foe(n+1)=1.024778e+003; krok(n+1)=8.620454e-001; ng(n+1)=1.245733e+002;
n=18; farx(n+1)=2.417075e+001; foe(n+1)=9.912723e+002; krok(n+1)=8.512166e-002; ng(n+1)=3.366686e+002;
n=19; farx(n+1)=2.162082e+001; foe(n+1)=5.574304e+002; krok(n+1)=2.278082e-001; ng(n+1)=2.908803e+002;
n=20; farx(n+1)=1.760027e+001; foe(n+1)=1.911973e+002; krok(n+1)=1.528851e-001; ng(n+1)=2.589925e+002;
n=21; farx(n+1)=1.444881e+001; foe(n+1)=2.660072e+002; krok(n+1)=4.329486e-001; ng(n+1)=1.136118e+002;
n=22; farx(n+1)=1.177088e+001; foe(n+1)=9.381635e+002; krok(n+1)=1.934637e+000; ng(n+1)=7.808481e+001;
n=23; farx(n+1)=7.796549e+000; foe(n+1)=2.096291e+002; krok(n+1)=1.782670e+000; ng(n+1)=1.327075e+002;
n=24; farx(n+1)=6.835902e+000; foe(n+1)=1.955165e+002; krok(n+1)=9.622339e-001; ng(n+1)=1.311848e+002;
n=25; farx(n+1)=5.398328e+000; foe(n+1)=1.758969e+002; krok(n+1)=8.155462e-001; ng(n+1)=4.498249e+001;
%odnowa zmiennej metryki
n=26; farx(n+1)=5.120875e+000; foe(n+1)=1.842774e+002; krok(n+1)=1.418599e-004; ng(n+1)=1.033438e+002;
n=27; farx(n+1)=5.051947e+000; foe(n+1)=2.101094e+002; krok(n+1)=2.104603e-004; ng(n+1)=4.039759e+001;
n=28; farx(n+1)=4.521340e+000; foe(n+1)=3.215602e+002; krok(n+1)=5.608324e-003; ng(n+1)=1.849954e+001;
n=29; farx(n+1)=4.115587e+000; foe(n+1)=1.847672e+002; krok(n+1)=3.549942e-003; ng(n+1)=3.115333e+001;
n=30; farx(n+1)=3.937788e+000; foe(n+1)=1.554889e+002; krok(n+1)=1.175883e-002; ng(n+1)=6.261997e+001;
n=31; farx(n+1)=3.813209e+000; foe(n+1)=1.626199e+002; krok(n+1)=2.039901e-001; ng(n+1)=1.163716e+002;
n=32; farx(n+1)=3.292621e+000; foe(n+1)=1.945729e+002; krok(n+1)=3.768236e-001; ng(n+1)=1.087465e+002;
n=33; farx(n+1)=2.590450e+000; foe(n+1)=1.639414e+002; krok(n+1)=2.420415e+000; ng(n+1)=6.500134e+001;
n=34; farx(n+1)=2.414307e+000; foe(n+1)=1.515760e+002; krok(n+1)=6.537835e-001; ng(n+1)=5.056564e+001;
n=35; farx(n+1)=2.247133e+000; foe(n+1)=2.285688e+002; krok(n+1)=4.317671e-001; ng(n+1)=8.523942e+001;
n=36; farx(n+1)=2.146678e+000; foe(n+1)=2.593481e+002; krok(n+1)=3.691454e-001; ng(n+1)=6.286960e+001;
n=37; farx(n+1)=2.015456e+000; foe(n+1)=1.376715e+002; krok(n+1)=6.002260e-001; ng(n+1)=3.955504e+001;
n=38; farx(n+1)=1.904724e+000; foe(n+1)=1.422861e+002; krok(n+1)=8.417937e-001; ng(n+1)=7.100220e+001;
n=39; farx(n+1)=1.809264e+000; foe(n+1)=1.549552e+002; krok(n+1)=7.382907e-001; ng(n+1)=3.853485e+001;
n=40; farx(n+1)=1.726463e+000; foe(n+1)=1.618962e+002; krok(n+1)=8.674420e-001; ng(n+1)=5.748948e+001;
n=41; farx(n+1)=1.654489e+000; foe(n+1)=1.570911e+002; krok(n+1)=9.735875e-001; ng(n+1)=7.411772e+001;
n=42; farx(n+1)=1.611100e+000; foe(n+1)=1.779305e+002; krok(n+1)=5.861088e-001; ng(n+1)=5.231271e+001;
n=43; farx(n+1)=1.550188e+000; foe(n+1)=1.309836e+002; krok(n+1)=6.888628e-001; ng(n+1)=1.758310e+001;
n=44; farx(n+1)=1.517518e+000; foe(n+1)=1.231277e+002; krok(n+1)=6.455021e-001; ng(n+1)=3.897770e+001;
n=45; farx(n+1)=1.484222e+000; foe(n+1)=1.481489e+002; krok(n+1)=1.126364e+000; ng(n+1)=4.765329e+001;
n=46; farx(n+1)=1.453062e+000; foe(n+1)=1.413018e+002; krok(n+1)=7.101669e-001; ng(n+1)=3.348228e+001;
n=47; farx(n+1)=1.425700e+000; foe(n+1)=1.283348e+002; krok(n+1)=5.870903e-001; ng(n+1)=5.990161e+001;
n=48; farx(n+1)=1.389243e+000; foe(n+1)=1.041174e+002; krok(n+1)=2.410788e+000; ng(n+1)=2.945038e+001;
n=49; farx(n+1)=1.365873e+000; foe(n+1)=1.366866e+002; krok(n+1)=1.033373e+000; ng(n+1)=2.203355e+001;
n=50; farx(n+1)=1.359828e+000; foe(n+1)=1.508608e+002; krok(n+1)=2.385171e-001; ng(n+1)=3.567344e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.358892e+000; foe(n+1)=1.489518e+002; krok(n+1)=4.254517e-005; ng(n+1)=9.910339e+000;
n=52; farx(n+1)=1.357137e+000; foe(n+1)=1.349705e+002; krok(n+1)=1.176687e-004; ng(n+1)=6.795645e+000;
n=53; farx(n+1)=1.355523e+000; foe(n+1)=1.246125e+002; krok(n+1)=1.188992e-004; ng(n+1)=8.120356e+000;
n=54; farx(n+1)=1.353803e+000; foe(n+1)=1.233801e+002; krok(n+1)=3.203828e-002; ng(n+1)=4.871542e-001;
n=55; farx(n+1)=1.348011e+000; foe(n+1)=1.253495e+002; krok(n+1)=8.892157e-002; ng(n+1)=6.199119e-001;
n=56; farx(n+1)=1.337014e+000; foe(n+1)=1.126643e+002; krok(n+1)=1.668612e-001; ng(n+1)=8.117256e+000;
n=57; farx(n+1)=1.332987e+000; foe(n+1)=1.114674e+002; krok(n+1)=4.128102e-001; ng(n+1)=3.685755e+001;
n=58; farx(n+1)=1.325134e+000; foe(n+1)=1.078757e+002; krok(n+1)=4.188592e-001; ng(n+1)=3.397156e+001;
n=59; farx(n+1)=1.312152e+000; foe(n+1)=1.190379e+002; krok(n+1)=1.779286e+000; ng(n+1)=2.181375e+001;
n=60; farx(n+1)=1.307424e+000; foe(n+1)=1.128927e+002; krok(n+1)=2.613267e-001; ng(n+1)=1.182983e+001;
n=61; farx(n+1)=1.303375e+000; foe(n+1)=1.047417e+002; krok(n+1)=6.046342e-001; ng(n+1)=2.758732e+001;
n=62; farx(n+1)=1.299074e+000; foe(n+1)=1.045664e+002; krok(n+1)=1.380032e+000; ng(n+1)=2.564178e+001;
n=63; farx(n+1)=1.294519e+000; foe(n+1)=9.890311e+001; krok(n+1)=1.009068e+000; ng(n+1)=8.055553e+000;
n=64; farx(n+1)=1.290694e+000; foe(n+1)=1.057449e+002; krok(n+1)=1.172218e+000; ng(n+1)=1.987869e+001;
n=65; farx(n+1)=1.287477e+000; foe(n+1)=1.029422e+002; krok(n+1)=1.189063e+000; ng(n+1)=2.285771e+001;
n=66; farx(n+1)=1.285225e+000; foe(n+1)=1.027870e+002; krok(n+1)=1.027715e+000; ng(n+1)=1.252381e+001;
n=67; farx(n+1)=1.282921e+000; foe(n+1)=9.593874e+001; krok(n+1)=2.781623e-001; ng(n+1)=1.309851e+001;
n=68; farx(n+1)=1.281865e+000; foe(n+1)=9.672551e+001; krok(n+1)=9.001093e-001; ng(n+1)=8.297436e+000;
n=69; farx(n+1)=1.280713e+000; foe(n+1)=1.026954e+002; krok(n+1)=9.639418e-001; ng(n+1)=1.588639e+001;
n=70; farx(n+1)=1.279434e+000; foe(n+1)=9.745468e+001; krok(n+1)=1.227563e+000; ng(n+1)=7.579695e+000;
n=71; farx(n+1)=1.278093e+000; foe(n+1)=9.277770e+001; krok(n+1)=1.829080e+000; ng(n+1)=1.049612e+001;
n=72; farx(n+1)=1.277663e+000; foe(n+1)=9.581522e+001; krok(n+1)=7.808753e-001; ng(n+1)=7.655765e+000;
n=73; farx(n+1)=1.276911e+000; foe(n+1)=9.725319e+001; krok(n+1)=6.914797e-001; ng(n+1)=4.566620e+000;
n=74; farx(n+1)=1.276612e+000; foe(n+1)=9.397813e+001; krok(n+1)=1.219142e+000; ng(n+1)=5.861013e+000;
n=75; farx(n+1)=1.276263e+000; foe(n+1)=9.388487e+001; krok(n+1)=1.422745e+000; ng(n+1)=7.183011e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.276240e+000; foe(n+1)=9.382426e+001; krok(n+1)=1.416371e-005; ng(n+1)=2.622759e+000;
n=77; farx(n+1)=1.276232e+000; foe(n+1)=9.398750e+001; krok(n+1)=5.270595e-005; ng(n+1)=9.475745e-001;
n=78; farx(n+1)=1.276218e+000; foe(n+1)=9.520959e+001; krok(n+1)=1.509285e-004; ng(n+1)=6.679669e-001;
n=79; farx(n+1)=1.276210e+000; foe(n+1)=9.517445e+001; krok(n+1)=2.991958e-002; ng(n+1)=4.015778e-002;
n=80; farx(n+1)=1.276188e+000; foe(n+1)=9.482020e+001; krok(n+1)=3.586741e-002; ng(n+1)=5.838654e-002;
n=81; farx(n+1)=1.276175e+000; foe(n+1)=9.476892e+001; krok(n+1)=1.497077e-001; ng(n+1)=2.677893e-002;
n=82; farx(n+1)=1.275976e+000; foe(n+1)=9.352884e+001; krok(n+1)=5.068567e+000; ng(n+1)=3.663804e-002;
n=83; farx(n+1)=1.275859e+000; foe(n+1)=9.384770e+001; krok(n+1)=2.697833e+000; ng(n+1)=3.599812e+000;
n=84; farx(n+1)=1.275829e+000; foe(n+1)=9.342199e+001; krok(n+1)=9.372047e-001; ng(n+1)=1.979232e+000;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.345068e+001; krok(n+1)=2.257123e+000; ng(n+1)=4.857982e-001;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.337691e+001; krok(n+1)=8.256204e-001; ng(n+1)=1.160813e-001;
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.338986e+001; krok(n+1)=2.507999e-001; ng(n+1)=1.587579e-001;
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339070e+001; krok(n+1)=1.514375e+000; ng(n+1)=1.532825e-002;
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.435731e+000; ng(n+1)=4.685306e-003;
n=90; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.639991e-005; ng(n+1)=6.113727e-004;
n=91; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.437026e-005; ng(n+1)=6.113621e-004;
n=92; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=3.559017e-005; ng(n+1)=6.113534e-004;
n=93; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=8.354449e-006; ng(n+1)=6.113316e-004;
n=94; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=2.889466e-008; ng(n+1)=6.113265e-004;
n=95; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=3.540928e-006; ng(n+1)=6.113265e-004;
n=96; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.181375e-006; ng(n+1)=6.113243e-004;
n=97; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=5.599381e-008; ng(n+1)=6.113236e-004;
n=98; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.912404e-010; ng(n+1)=6.113236e-004;
n=99; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=8.690837e-006; ng(n+1)=6.113236e-004;
n=100; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.065195e-005; ng(n+1)=6.112451e-004;
%odnowa zmiennej metryki
n=101; farx(n+1)=1.275822e+000; foe(n+1)=9.339076e+001; krok(n+1)=1.265721e-005; ng(n+1)=6.112380e-004;
n=102; farx(n+1)=1.275822e+000; foe(n+1)=9.339080e+001; krok(n+1)=3.559017e-005; ng(n+1)=1.422600e-004;
n=103; farx(n+1)=1.275822e+000; foe(n+1)=9.339088e+001; krok(n+1)=3.346707e-004; ng(n+1)=4.390597e-005;
n=104; farx(n+1)=1.275822e+000; foe(n+1)=9.339088e+001; krok(n+1)=2.860122e-005; ng(n+1)=3.390784e-005;
n=105; farx(n+1)=1.275822e+000; foe(n+1)=9.339088e+001; krok(n+1)=8.267431e-011; ng(n+1)=3.390695e-005;
n=106; farx(n+1)=1.275822e+000; foe(n+1)=9.339088e+001; krok(n+1)=1.800158e-006; ng(n+1)=3.390695e-005;
n=107; farx(n+1)=1.275822e+000; foe(n+1)=9.339088e+001; krok(n+1)=2.006992e-007; ng(n+1)=3.391235e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
