%uczenie predyktora arx
clear all;
n=0; farx(n+1)=2.866457e+003; foe(n+1)=2.852513e+003; wspucz(n+1)=0.000000e+000; ng(n+1)=0.000000e+000;
%odnowa zmiennej metryki
n=1; farx(n+1)=2.598070e+003; foe(n+1)=2.602897e+003; krok(n+1)=3.229906e-004; ng(n+1)=1.492838e+003;
n=2; farx(n+1)=1.570843e+003; foe(n+1)=4.805939e+003; krok(n+1)=3.516052e-003; ng(n+1)=7.160956e+002;
n=3; farx(n+1)=1.480175e+003; foe(n+1)=6.767527e+003; krok(n+1)=3.646823e-005; ng(n+1)=3.265718e+003;
n=4; farx(n+1)=1.460589e+003; foe(n+1)=6.917392e+003; krok(n+1)=1.632192e-003; ng(n+1)=3.070103e+003;
n=5; farx(n+1)=1.439352e+003; foe(n+1)=7.394396e+003; krok(n+1)=2.262062e-002; ng(n+1)=2.989237e+003;
n=6; farx(n+1)=1.859490e+002; foe(n+1)=6.313542e+003; krok(n+1)=1.902505e+000; ng(n+1)=3.019068e+003;
n=7; farx(n+1)=1.312078e+002; foe(n+1)=3.714384e+003; krok(n+1)=7.101669e-001; ng(n+1)=3.426194e+002;
n=8; farx(n+1)=1.010773e+002; foe(n+1)=5.404645e+002; krok(n+1)=2.781976e+000; ng(n+1)=2.728322e+002;
n=9; farx(n+1)=7.889707e+001; foe(n+1)=6.044907e+003; krok(n+1)=1.707324e+000; ng(n+1)=3.089651e+002;
n=10; farx(n+1)=7.270486e+001; foe(n+1)=5.456546e+003; krok(n+1)=1.171229e+000; ng(n+1)=1.466382e+002;
n=11; farx(n+1)=6.488460e+001; foe(n+1)=6.382282e+003; krok(n+1)=1.147757e+000; ng(n+1)=1.275901e+002;
n=12; farx(n+1)=4.848899e+001; foe(n+1)=6.581096e+003; krok(n+1)=1.497514e+000; ng(n+1)=1.244106e+002;
n=13; farx(n+1)=3.986650e+001; foe(n+1)=6.660768e+003; krok(n+1)=4.044487e-001; ng(n+1)=1.201935e+002;
n=14; farx(n+1)=2.826622e+001; foe(n+1)=7.141710e+003; krok(n+1)=1.856466e+000; ng(n+1)=1.346395e+002;
n=15; farx(n+1)=1.767468e+001; foe(n+1)=3.781456e+002; krok(n+1)=6.639102e-001; ng(n+1)=9.504084e+001;
n=16; farx(n+1)=1.489934e+001; foe(n+1)=2.395737e+002; krok(n+1)=4.787134e-001; ng(n+1)=1.430947e+002;
n=17; farx(n+1)=1.143061e+001; foe(n+1)=2.806776e+002; krok(n+1)=1.120145e+000; ng(n+1)=6.829383e+001;
n=18; farx(n+1)=1.011736e+001; foe(n+1)=2.791178e+002; krok(n+1)=7.178655e-001; ng(n+1)=9.679721e+001;
n=19; farx(n+1)=8.510345e+000; foe(n+1)=3.824399e+002; krok(n+1)=4.909897e-001; ng(n+1)=1.380315e+002;
n=20; farx(n+1)=7.011939e+000; foe(n+1)=3.501591e+002; krok(n+1)=3.139002e-001; ng(n+1)=6.482814e+001;
n=21; farx(n+1)=5.886919e+000; foe(n+1)=1.385207e+002; krok(n+1)=7.536472e-001; ng(n+1)=8.328716e+001;
n=22; farx(n+1)=5.101721e+000; foe(n+1)=1.839474e+002; krok(n+1)=1.003200e+000; ng(n+1)=1.411788e+002;
n=23; farx(n+1)=4.250312e+000; foe(n+1)=2.626890e+002; krok(n+1)=1.006076e+000; ng(n+1)=3.592529e+001;
n=24; farx(n+1)=3.699980e+000; foe(n+1)=1.765235e+002; krok(n+1)=6.322648e-001; ng(n+1)=8.596898e+001;
n=25; farx(n+1)=3.367173e+000; foe(n+1)=1.792254e+002; krok(n+1)=8.858725e-001; ng(n+1)=1.021159e+002;
%odnowa zmiennej metryki
n=26; farx(n+1)=3.296419e+000; foe(n+1)=1.748366e+002; krok(n+1)=8.312662e-005; ng(n+1)=6.559679e+001;
n=27; farx(n+1)=3.285699e+000; foe(n+1)=1.800357e+002; krok(n+1)=2.238326e-004; ng(n+1)=1.589030e+001;
n=28; farx(n+1)=3.199642e+000; foe(n+1)=1.279699e+002; krok(n+1)=4.266621e-003; ng(n+1)=8.871520e+000;
n=29; farx(n+1)=2.936179e+000; foe(n+1)=1.374575e+002; krok(n+1)=6.192369e-003; ng(n+1)=1.434377e+001;
n=30; farx(n+1)=2.824756e+000; foe(n+1)=1.119710e+002; krok(n+1)=1.618413e-002; ng(n+1)=4.879148e+001;
n=31; farx(n+1)=2.627516e+000; foe(n+1)=1.731568e+002; krok(n+1)=4.021517e-001; ng(n+1)=9.794389e+001;
n=32; farx(n+1)=2.578189e+000; foe(n+1)=1.890892e+002; krok(n+1)=5.873647e-002; ng(n+1)=9.396848e+001;
n=33; farx(n+1)=2.367797e+000; foe(n+1)=2.287366e+002; krok(n+1)=8.426513e-001; ng(n+1)=8.346829e+001;
n=34; farx(n+1)=2.093393e+000; foe(n+1)=1.701051e+002; krok(n+1)=1.187985e+000; ng(n+1)=5.084400e+001;
n=35; farx(n+1)=1.991186e+000; foe(n+1)=1.642007e+002; krok(n+1)=8.252141e-001; ng(n+1)=7.368726e+001;
n=36; farx(n+1)=1.857275e+000; foe(n+1)=1.164144e+002; krok(n+1)=7.676757e-001; ng(n+1)=5.115846e+001;
n=37; farx(n+1)=1.777306e+000; foe(n+1)=1.590482e+002; krok(n+1)=6.335709e-001; ng(n+1)=6.415525e+001;
n=38; farx(n+1)=1.708365e+000; foe(n+1)=1.960941e+002; krok(n+1)=7.310195e-001; ng(n+1)=6.344756e+001;
n=39; farx(n+1)=1.639602e+000; foe(n+1)=1.948838e+002; krok(n+1)=9.372047e-001; ng(n+1)=5.921591e+001;
n=40; farx(n+1)=1.591023e+000; foe(n+1)=1.343637e+002; krok(n+1)=4.714530e-001; ng(n+1)=3.656043e+001;
n=41; farx(n+1)=1.543094e+000; foe(n+1)=1.146189e+002; krok(n+1)=8.644849e-001; ng(n+1)=4.425292e+001;
n=42; farx(n+1)=1.477128e+000; foe(n+1)=1.743060e+002; krok(n+1)=2.416435e+000; ng(n+1)=4.748460e+001;
n=43; farx(n+1)=1.453961e+000; foe(n+1)=1.747230e+002; krok(n+1)=6.041087e-001; ng(n+1)=3.705359e+001;
n=44; farx(n+1)=1.419676e+000; foe(n+1)=1.225537e+002; krok(n+1)=4.419445e-001; ng(n+1)=1.386617e+001;
n=45; farx(n+1)=1.405365e+000; foe(n+1)=1.071445e+002; krok(n+1)=6.986165e-001; ng(n+1)=2.478771e+001;
n=46; farx(n+1)=1.389031e+000; foe(n+1)=1.225742e+002; krok(n+1)=1.146483e+000; ng(n+1)=4.175544e+001;
n=47; farx(n+1)=1.364903e+000; foe(n+1)=1.258050e+002; krok(n+1)=9.362720e-001; ng(n+1)=1.706605e+001;
n=48; farx(n+1)=1.350117e+000; foe(n+1)=1.191060e+002; krok(n+1)=1.552709e+000; ng(n+1)=3.324595e+001;
n=49; farx(n+1)=1.339201e+000; foe(n+1)=1.084905e+002; krok(n+1)=8.252141e-001; ng(n+1)=1.822277e+001;
n=50; farx(n+1)=1.328469e+000; foe(n+1)=1.170119e+002; krok(n+1)=8.575247e-001; ng(n+1)=2.383288e+001;
%odnowa zmiennej metryki
n=51; farx(n+1)=1.326077e+000; foe(n+1)=1.158741e+002; krok(n+1)=4.254517e-005; ng(n+1)=1.337303e+001;
n=52; farx(n+1)=1.325795e+000; foe(n+1)=1.146333e+002; krok(n+1)=2.458493e-005; ng(n+1)=6.989775e+000;
n=53; farx(n+1)=1.325723e+000; foe(n+1)=1.176576e+002; krok(n+1)=1.745241e-003; ng(n+1)=4.658647e-001;
n=54; farx(n+1)=1.323974e+000; foe(n+1)=1.170121e+002; krok(n+1)=1.321526e-002; ng(n+1)=8.725457e-001;
n=55; farx(n+1)=1.322064e+000; foe(n+1)=1.176792e+002; krok(n+1)=2.928765e-002; ng(n+1)=8.078022e-001;
n=56; farx(n+1)=1.313322e+000; foe(n+1)=1.081468e+002; krok(n+1)=4.372988e-001; ng(n+1)=2.563824e+000;
n=57; farx(n+1)=1.311682e+000; foe(n+1)=1.067754e+002; krok(n+1)=1.752988e-001; ng(n+1)=2.895082e+001;
n=58; farx(n+1)=1.304254e+000; foe(n+1)=1.041293e+002; krok(n+1)=1.210579e+000; ng(n+1)=3.096249e+001;
n=59; farx(n+1)=1.295634e+000; foe(n+1)=1.082414e+002; krok(n+1)=1.484568e+000; ng(n+1)=1.488461e+001;
n=60; farx(n+1)=1.293741e+000; foe(n+1)=1.034752e+002; krok(n+1)=5.362494e-001; ng(n+1)=1.475751e+001;
n=61; farx(n+1)=1.290379e+000; foe(n+1)=1.014934e+002; krok(n+1)=4.448216e-001; ng(n+1)=2.543365e+001;
n=62; farx(n+1)=1.285248e+000; foe(n+1)=1.001278e+002; krok(n+1)=2.052572e+000; ng(n+1)=1.636904e+001;
n=63; farx(n+1)=1.283837e+000; foe(n+1)=9.764908e+001; krok(n+1)=6.212565e-001; ng(n+1)=6.294257e+000;
n=64; farx(n+1)=1.281759e+000; foe(n+1)=9.961086e+001; krok(n+1)=5.076342e-001; ng(n+1)=1.687760e+001;
n=65; farx(n+1)=1.280091e+000; foe(n+1)=9.691925e+001; krok(n+1)=1.767778e+000; ng(n+1)=7.287298e+000;
n=66; farx(n+1)=1.279145e+000; foe(n+1)=9.845167e+001; krok(n+1)=6.282866e-001; ng(n+1)=1.366518e+001;
n=67; farx(n+1)=1.278290e+000; foe(n+1)=9.516127e+001; krok(n+1)=7.560816e-001; ng(n+1)=3.303117e+000;
n=68; farx(n+1)=1.277751e+000; foe(n+1)=9.495809e+001; krok(n+1)=8.159604e-001; ng(n+1)=6.810845e+000;
n=69; farx(n+1)=1.277250e+000; foe(n+1)=9.693023e+001; krok(n+1)=7.178655e-001; ng(n+1)=1.125940e+001;
n=70; farx(n+1)=1.276693e+000; foe(n+1)=9.434389e+001; krok(n+1)=1.492310e+000; ng(n+1)=1.921768e+000;
n=71; farx(n+1)=1.276380e+000; foe(n+1)=9.488075e+001; krok(n+1)=1.062525e+000; ng(n+1)=6.974522e+000;
n=72; farx(n+1)=1.276123e+000; foe(n+1)=9.378628e+001; krok(n+1)=1.315187e+000; ng(n+1)=4.764919e+000;
n=73; farx(n+1)=1.276021e+000; foe(n+1)=9.447520e+001; krok(n+1)=7.310195e-001; ng(n+1)=3.929471e+000;
n=74; farx(n+1)=1.275919e+000; foe(n+1)=9.384452e+001; krok(n+1)=5.636152e-001; ng(n+1)=3.271390e+000;
n=75; farx(n+1)=1.275855e+000; foe(n+1)=9.356946e+001; krok(n+1)=1.856466e+000; ng(n+1)=2.018462e+000;
%odnowa zmiennej metryki
n=76; farx(n+1)=1.275843e+000; foe(n+1)=9.364748e+001; krok(n+1)=1.225273e-005; ng(n+1)=2.061140e+000;
n=77; farx(n+1)=1.275842e+000; foe(n+1)=9.370393e+001; krok(n+1)=3.268967e-005; ng(n+1)=2.085006e-001;
n=78; farx(n+1)=1.275842e+000; foe(n+1)=9.387519e+001; krok(n+1)=5.053235e-004; ng(n+1)=4.285432e-002;
n=79; farx(n+1)=1.275840e+000; foe(n+1)=9.374595e+001; krok(n+1)=4.258262e-003; ng(n+1)=4.523196e-002;
n=80; farx(n+1)=1.275829e+000; foe(n+1)=9.361407e+001; krok(n+1)=1.630613e-001; ng(n+1)=1.783747e-002;
n=81; farx(n+1)=1.275828e+000; foe(n+1)=9.357095e+001; krok(n+1)=7.596282e-002; ng(n+1)=8.249254e-003;
n=82; farx(n+1)=1.275822e+000; foe(n+1)=9.337663e+001; krok(n+1)=1.737409e+001; ng(n+1)=5.802766e-003;
n=83; farx(n+1)=1.275822e+000; foe(n+1)=9.339817e+001; krok(n+1)=1.145447e+000; ng(n+1)=2.159737e-001;
n=84; farx(n+1)=1.275822e+000; foe(n+1)=9.339038e+001; krok(n+1)=9.429061e-001; ng(n+1)=1.162593e-002;
n=85; farx(n+1)=1.275822e+000; foe(n+1)=9.339092e+001; krok(n+1)=1.032953e+000; ng(n+1)=3.663976e-003;
n=86; farx(n+1)=1.275822e+000; foe(n+1)=9.339092e+001; krok(n+1)=1.470858e-005; ng(n+1)=2.850285e-004;
n=87; farx(n+1)=1.275822e+000; foe(n+1)=9.339092e+001; krok(n+1)=3.474686e-010; ng(n+1)=2.850242e-004;
 % z³y kierunek w metodzie zm - odnowa 
n=88; farx(n+1)=1.275822e+000; foe(n+1)=9.339091e+001; krok(n+1)=1.504753e-005; ng(n+1)=2.850242e-004;
n=89; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=2.431710e-005; ng(n+1)=1.229260e-004;
n=90; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=7.304702e-006; ng(n+1)=1.201445e-005;
n=91; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=2.699994e-006; ng(n+1)=1.202962e-005;
n=92; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=3.575152e-006; ng(n+1)=1.202918e-005;
n=93; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=2.829063e-005; ng(n+1)=1.202904e-005;
n=94; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.909461e-007; ng(n+1)=1.202869e-005;
n=95; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.675470e-006; ng(n+1)=1.202869e-005;
n=96; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.373064e-008; ng(n+1)=1.202867e-005;
n=97; farx(n+1)=1.275822e+000; foe(n+1)=9.339090e+001; krok(n+1)=1.943842e-008; ng(n+1)=1.202866e-005;
 % z³y kierunek w metodzie zm - odnowa 
 % z³y kierunek w metodzie zm po wykonaniu odnowy

figure; semilogy(farx,'b'); hold on; semilogy(foe,'r'); xlabel('Iteracje'); ylabel('Earx, Eoe'); legend('Earx','Eoe'); title('Uczenie predyktora ARX');
figure; subplot(2,1,1); semilogy(krok); xlabel('Iteracje'); ylabel('Krok');
subplot(2,1,2); semilogy(ng); xlabel('Iteracje'); ylabel('Norma gradientu');
Earx=farx(n+1)
Eoe=foe(n+1)
